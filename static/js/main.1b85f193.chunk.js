(this["webpackJsonptoastie-desktop"]=this["webpackJsonptoastie-desktop"]||[]).push([[0],{12:function(e,t,n){e.exports={stage:"input_stage__2pwOH",headerSection:"input_headerSection__2Ig4V",errors:"input_errors__2Tcf9",list:"input_list__3gHf3",error:"input_error__35vPN",pasteContainer:"input_pasteContainer__GiXDL",paste:"input_paste__2hyfv",subheader:"input_subheader__cNlLV",pasteArea:"input_pasteArea__1SDj2",form:"input_form__2v-ub",textarea:"input_textarea__1FWhO",output:"input_output__VuryB",submit:"input_submit__12haZ",reset:"input_reset__3CJ7t",clear:"input_clear__dg7Lv",playerTable:"input_playerTable__1E0SY",parsedHeader:"input_parsedHeader__3UNYl",tableHeader:"input_tableHeader__2R4Rf",dragEnter:"input_dragEnter__197KT",target:"input_target__GK4nW",placeholder:"input_placeholder__vx5TQ",errorCell:"input_errorCell__3yQ4_",highlighted:"input_highlighted__2WnFW",description:"input_description__1s735"}},14:function(e,t,n){e.exports={background:"tournament_background__3Lj72",tournament:"tournament_tournament__1ikhA",titleBar:"tournament_titleBar__1Kvez","slide-in-from-top":"tournament_slide-in-from-top__22vmU",stage:"tournament_stage__3sbve",row:"tournament_row__3K-Kn",header:"tournament_header__hB1Cf",editableField:"tournament_editableField__1rO3U",fixed:"tournament_fixed__3grCR",previous:"tournament_previous__BLUHu",next:"tournament_next__ty8U0",statusBar:"tournament_statusBar__1P6z0",form:"tournament_form__1Pn88",input:"tournament_input__xb1Th",button:"tournament_button__3FfYw",inactive:"tournament_inactive__1IuMF",profile:"tournament_profile__1l3mu","slide-in-from-right":"tournament_slide-in-from-right__rOjOO",profileStage:"tournament_profileStage__3TswH"}},17:function(e,t,n){e.exports={column:"menu_column__4oCn8",leftColumn:"menu_leftColumn__13Ey0",rightColumn:"menu_rightColumn__2D55A",container:"menu_container__4epvu","slide-in-from-right":"menu_slide-in-from-right__2syBl",line:"menu_line__2oByf",row:"menu_row__q-PZk",listWrapper:"menu_listWrapper__1_77c",clickButton:"menu_clickButton__1F_HI",dotContainer:"menu_dotContainer__ze3l6",dotDescription:"menu_dotDescription__19QYi",dot:"menu_dot__3Dq9b",dotContainerLoaded:"menu_dotContainerLoaded__3YmWC",descriptionSelected:"menu_descriptionSelected__2aKX-",close:"menu_close__3eKoV",sidebar:"menu_sidebar__l1_lg",profile:"menu_profile__3-O4-",bottomBanner:"menu_bottomBanner__3Od_g",logo:"menu_logo__3MwZ9","float-down":"menu_float-down__1GhiB",dotUnloaded:"menu_dotUnloaded__2DT-h",expand:"menu_expand__1E6M-",license1:"menu_license1__1o4qd",license2:"menu_license2__1N8w4",license3:"menu_license3__2EL0m",scrollable:"menu_scrollable__39r7X","briefly-expand":"menu_briefly-expand__ex-pm"}},201:function(e,t,n){e.exports=n.p+"static/media/chessCom.228db28e.svg"},202:function(e,t,n){e.exports=n.p+"static/media/lichess.9ff6e305.svg"},203:function(e,t,n){e.exports=n.p+"static/media/ecf.68e0df94.svg"},204:function(e,t,n){e.exports=n.p+"static/media/fide.03cb669d.svg"},21:function(e,t,n){e.exports={column:"login_column__14Kgt",container:"login_container__1w_9V",initialiseButton:"login_initialiseButton__3CXrs",forgottenContainer:"login_forgottenContainer__2yR4y",forgotten:"login_forgotten__3VFQz",form:"login_form__1ieaR",input:"login_input__3ze1R",submit:"login_submit__2qxJT",loginSection:"login_loginSection__1BBMn",loginBackground:"login_loginBackground__y9UZ2",foreground:"login_foreground__2Cqo8",loginForeground:"login_loginForeground__lnGgY",registerForeground:"login_registerForeground__3D6jX",flip:"login_flip__2KG2q",messageBar:"login_messageBar__6TM4O"}},3:function(e,t,n){e.exports={container:"components_container__1CCB7",editableField:"components_editableField__2fs18",form:"components_form__1RjIP",input:"components_input__I_Vv7",submitHidden:"components_submitHidden__PvrYt",any:"components_any__3pCEP",button:"components_button__1Gg6-",submit:"components_submit__1SFYQ",increment:"components_increment__19rbD",cancel:"components_cancel__1_2ia",infinity:"components_infinity__1rF3u",resultsBridge:"components_resultsBridge__9qnay",details:"components_details__1FuFV",undoPairing:"components_undoPairing__1aS_v",resolve:"components_resolve__1X_KN",reject:"components_reject__3ymMO",neutral:"components_neutral__392Xn","flash-green":"components_flash-green__2Wczz",linked:"components_linked__3nC4k",setResult:"components_setResult__ToBDd",inputURL:"components_inputURL__3WU4U",centre:"components_centre__2BcEl",detailsContent:"components_detailsContent__2yLbz",row:"components_row__1jpeO",linkSubmit:"components_linkSubmit__TNip6",sectionContainer:"components_sectionContainer__1tg1I",sectionHeader:"components_sectionHeader__-UWwY",sectionHeaderText:"components_sectionHeaderText__1OTig",sectionListWrapper:"components_sectionListWrapper__a03uW",sectionList:"components_sectionList__117sb",expanded:"components_expanded__3qOxR",sectionToggle:"components_sectionToggle__2z6Il",tabSection:"components_tabSection__2c2yE",tab:"components_tab__3HWgq",active:"components_active__1mG2n",alwaysVisible:"components_alwaysVisible__fSqQA",hasLink:"components_hasLink__19HOG",spacer:"components_spacer__Eomnl",listElement:"components_listElement__3XDv4",buttonContainer:"components_buttonContainer__3GcKy",number:"components_number__1KTE_",tbReset:"components_tbReset__1M6ME",tbSubmit:"components_tbSubmit__1ln_p",infoBox:"components_infoBox__31Uwk",searchBar:"components_searchBar__34BNl",searchResults:"components_searchResults__tX7x8"}},35:function(e,t,n){e.exports={canvas:"app_canvas__1MLEL",column:"app_column__2WVoo",logo:"app_logo__b6W_t",loadingLine:"app_loadingLine__1xeSs",staticLogo:"app_staticLogo__1-Wsi",loadingGif:"app_loadingGif__2PnUi",crownOutline:"app_crownOutline__2IPSS","fade-in":"app_fade-in__3kaKs","grow-right":"app_grow-right__1NUcX"}},357:function(e,t,n){e.exports=n(812)},36:function(e,t,n){e.exports={gridPage:"crosstable_gridPage__2Kpuz",titles:"crosstable_titles__2lOQ_",table:"crosstable_table__FafeF",td:"crosstable_td__1hxGz",th:"crosstable_th__Gp7TR",cell:"crosstable_cell__1NDzK",blank:"crosstable_blank__xJoJC",player:"crosstable_player__TFp_x",edit:"crosstable_edit__2V8kj",headerCell:"crosstable_headerCell__2zS_u",firstColumn:"crosstable_firstColumn__2m7R_",closeButton:"crosstable_closeButton__2pu_0",container:"crosstable_container__3ZuI8",submit:"crosstable_submit__3U_pw",scrollbar:"crosstable_scrollbar__3sUIs",track:"crosstable_track__35bvy"}},362:function(e,t,n){},364:function(e,t,n){},4:function(e,t,n){e.exports={profileContainer:"profile_profileContainer__V5hnJ",bottomBanner:"profile_bottomBanner__b2MfX","slide-in-from-right":"profile_slide-in-from-right__2jdIT",roundRow:"profile_roundRow__3OA2r",row:"profile_row__aUfgI",resultsRow:"profile_resultsRow__4zleX",bonusRow:"profile_bonusRow__1sVIm",matchOnly:"profile_matchOnly__q_hNo",editable:"profile_editable__24Eas",editableField:"profile_editableField__2onPe",input:"profile_input__2tu2X",sectionListWrapper:"profile_sectionListWrapper__1K1-l",sectionList:"profile_sectionList__3bJ8Z",expanded:"profile_expanded__3QtaO",sectionToggle:"profile_sectionToggle__2qBPk",semiPresent:"profile_semiPresent__1APEU",playerLine:"profile_playerLine__IVVus",cancel:"profile_cancel__AKFEe",profilePicture:"profile_profilePicture__d0y9A",infoSection:"profile_infoSection__1V7wB",closeButton:"profile_closeButton__3lSRr",name:"profile_name__bRkcf",scoreSection:"profile_scoreSection__3GgY5",tieBreaks:"profile_tieBreaks__101TV",tb:"profile_tb__2hp89"}},405:function(e,t){},407:function(e,t){},437:function(e,t){},438:function(e,t){},482:function(e,t){},484:function(e,t){},507:function(e,t){},51:function(e,t,n){e.exports={shade:"alert_shade__1O-5R",container:"alert_container__2heSX",alertBox:"alert_alertBox__-kpK4",title:"alert_title__W4aFN",error:"alert_error__wKYnQ",textBox:"alert_textBox__ATagI",response:"alert_response__1RX0q",NO:"alert_NO__2Bl9f",OK:"alert_OK__1hQGN",ERROR:"alert_ERROR___uQVx",YES:"alert_YES__pKi26"}},624:function(e,t){},66:function(e){e.exports=JSON.parse('{"server":"http://localhost:8080/","prodServer":"https://api.scorchapp.co.uk/","resultsServer":"http://localhost:3001/","prodResultsServer":"https://results.scorchapp.co.uk/","useProd":true}')},67:function(e,t,n){e.exports={statusBar:"statusbar_statusBar__3f7HO",favicon:"statusbar_favicon__1Unmh",menu:"statusbar_menu__3nFvT",title:"statusbar_title__3ClL5",exec:"statusbar_exec__2fXB2",close:"statusbar_close__3ssky"}},7:function(e,t,n){e.exports={pairings:"pairings_pairings__2Z6gd","fade-in":"pairings_fade-in__3Iydy",stage:"pairings_stage__2dyTl",pairingContainer:"pairings_pairingContainer__2snrJ",pairing:"pairings_pairing__jh3eo",playerInfo:"pairings_playerInfo__2BGOf",inputResult:"pairings_inputResult__8kpK5",titleContainer:"pairings_titleContainer__3xYF4",topBanner:"pairings_topBanner__duKX4",statusBarBackground:"pairings_statusBarBackground__3c8y3",statusBar:"pairings_statusBar__Y2g9v","slide-in-from-bottom":"pairings_slide-in-from-bottom__1tu-V",switchStatusBar:"pairings_switchStatusBar__1L_Ga",waitButton:"pairings_waitButton__3CIsd",finishButton:"pairings_finishButton__elOep",nextButton:"pairings_nextButton__1fjha",undoButton:"pairings_undoButton__1u_Y2",rotate:"pairings_rotate__rWtYA",submit:"pairings_submit__258vX",pairingAddButton:"pairings_pairingAddButton__1UJs-",manualPairing:"pairings_manualPairing__aqFws",manualResultsBridge:"pairings_manualResultsBridge__2HXJc",scoreSpacer:"pairings_scoreSpacer__1wULz",centre:"pairings_centre__2s7rb"}},78:function(e){e.exports=JSON.parse('{"AFG":"Afghanistan","ALA":"Aland Islands","ALB":"Albania","DZA":"Algeria","ASM":"American Samoa","AND":"Andorra","AGO":"Angola","AIA":"Anguilla","ATA":"Antarctica","ATG":"Antigua and Barbuda","ARG":"Argentina","ARM":"Armenia","ABW":"Aruba","AUS":"Australia","AUT":"Austria","AZE":"Azerbaijan","BHS":"Bahamas","BHR":"Bahrain","BGD":"Bangladesh","BRB":"Barbados","BLR":"Belarus","BEL":"Belgium","BLZ":"Belize","BEN":"Benin","BMU":"Bermuda","BTN":"Bhutan","BOL":"Bolivia","BIH":"Bosnia and Herzegovina","BWA":"Botswana","BVT":"Bouvet Island","BRA":"Brazil","VGB":"British Virgin Islands","IOT":"British Indian Ocean Territory","BRN":"Brunei Darussalam","BUL":"Bulgaria","BFA":"Burkina Faso","BDI":"Burundi","KHM":"Cambodia","CMR":"Cameroon","CAN":"Canada","CPV":"Cape Verde","CYM":"Cayman Islands","CAF":"Central African Republic","TCD":"Chad","CHI":"Chile","CHN":"China","HKG":"Hong Kong, SAR China","MAC":"Macao, SAR China","CXR":"Christmas Island","CCK":"Cocos (Keeling) Islands","COL":"Colombia","COM":"Comoros","COG":"Congo (Brazzaville)","COD":"Congo, (Kinshasa)","COK":"Cook Islands","CRI":"Costa Rica","CIV":"C\xf4te d\'Ivoire","HRV":"Croatia","CUB":"Cuba","CYP":"Cyprus","CZE":"Czech Republic","DNK":"Denmark","DJI":"Djibouti","DMA":"Dominica","DOM":"Dominican Republic","ECU":"Ecuador","EGY":"Egypt","SLV":"El Salvador","GNQ":"Equatorial Guinea","ERI":"Eritrea","EST":"Estonia","ETH":"Ethiopia","FLK":"Falkland Islands (Malvinas)","FAI":"Faroe Islands","FJI":"Fiji","FIN":"Finland","FRA":"France","GUF":"French Guiana","PYF":"French Polynesia","ATF":"French Southern Territories","GAB":"Gabon","GMB":"Gambia","GEO":"Georgia","GER":"Germany","GHA":"Ghana","GIB":"Gibraltar","GRE":"Greece","GRL":"Greenland","GRD":"Grenada","GLP":"Guadeloupe","GUM":"Guam","GTM":"Guatemala","GGY":"Guernsey","GIN":"Guinea","GNB":"Guinea-Bissau","GUY":"Guyana","HTI":"Haiti","HMD":"Heard and Mcdonald Islands","VAT":"Holy See (Vatican City State)","HND":"Honduras","HUN":"Hungary","ISL":"Iceland","IND":"India","IDN":"Indonesia","IRN":"Iran, Islamic Republic of","IRQ":"Iraq","IRL":"Ireland","IMN":"Isle of Man","ISR":"Israel","ITA":"Italy","JAM":"Jamaica","JPN":"Japan","JEY":"Jersey","JOR":"Jordan","KAZ":"Kazakhstan","KEN":"Kenya","KIR":"Kiribati","PRK":"Korea (North)","KOR":"Korea (South)","KWT":"Kuwait","KGZ":"Kyrgyzstan","LAO":"Lao PDR","LVA":"Latvia","LBN":"Lebanon","LSO":"Lesotho","LBR":"Liberia","LBY":"Libya","LIE":"Liechtenstein","LTU":"Lithuania","LUX":"Luxembourg","MKD":"Macedonia, Republic of","MDG":"Madagascar","MWI":"Malawi","MAS":"Malaysia","MDV":"Maldives","MLI":"Mali","MLT":"Malta","MHL":"Marshall Islands","MTQ":"Martinique","MRT":"Mauritania","MUS":"Mauritius","MYT":"Mayotte","MEX":"Mexico","FSM":"Micronesia, Federated States of","MDA":"Moldova","MCO":"Monaco","MNG":"Mongolia","MNE":"Montenegro","MSR":"Montserrat","MAR":"Morocco","MOZ":"Mozambique","MMR":"Myanmar","NAM":"Namibia","NRU":"Nauru","NPL":"Nepal","NLD":"Netherlands","ANT":"Netherlands Antilles","NCL":"New Caledonia","NZL":"New Zealand","NIC":"Nicaragua","NER":"Niger","NGA":"Nigeria","NIU":"Niue","NFK":"Norfolk Island","MNP":"Northern Mariana Islands","NOR":"Norway","OMN":"Oman","PAK":"Pakistan","PLW":"Palau","PSE":"Palestinian Territory","PAN":"Panama","PNG":"Papua New Guinea","PRY":"Paraguay","PER":"Peru","PHI":"Philippines","PCN":"Pitcairn","POL":"Poland","POR":"Portugal","PRI":"Puerto Rico","QAT":"Qatar","REU":"R\xe9union","ROU":"Romania","RUS":"Russian Federation","RWA":"Rwanda","BLM":"Saint-Barth\xe9lemy","SHN":"Saint Helena","KNA":"Saint Kitts and Nevis","LCA":"Saint Lucia","MAF":"Saint-Martin (French part)","SPM":"Saint Pierre and Miquelon","VCT":"Saint Vincent and Grenadines","WSM":"Samoa","SMR":"San Marino","STP":"Sao Tome and Principe","SAU":"Saudi Arabia","SEN":"Senegal","SRB":"Serbia","SYC":"Seychelles","SLE":"Sierra Leone","SGP":"Singapore","SVK":"Slovakia","SLO":"Slovenia","SLB":"Solomon Islands","SOM":"Somalia","RSA":"South Africa","SGS":"South Georgia and the South Sandwich Islands","SSD":"South Sudan","ESP":"Spain","LKA":"Sri Lanka","SDN":"Sudan","SUR":"Suriname","SJM":"Svalbard and Jan Mayen Islands","SWZ":"Swaziland","SWE":"Sweden","CHE":"Switzerland","SYR":"Syrian Arab Republic (Syria)","TWN":"Taiwan, Republic of China","TJK":"Tajikistan","TZA":"Tanzania, United Republic of","THA":"Thailand","TLS":"Timor-Leste","TGO":"Togo","TKL":"Tokelau","TON":"Tonga","TTO":"Trinidad and Tobago","TUN":"Tunisia","TUR":"Turkey","TKM":"Turkmenistan","TCA":"Turks and Caicos Islands","TUV":"Tuvalu","UGA":"Uganda","UKR":"Ukraine","ARE":"United Arab Emirates","ENG":"England","SCO":"Scotland","WLS":"Wales","USA":"United States of America","UMI":"US Minor Outlying Islands","URY":"Uruguay","UZB":"Uzbekistan","VUT":"Vanuatu","VEN":"Venezuela (Bolivarian Republic)","VNM":"Viet Nam","VIR":"Virgin Islands, US","WLF":"Wallis and Futuna Islands","ESH":"Western Sahara","YEM":"Yemen","ZMB":"Zambia","ZWE":"Zimbabwe"}')},812:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(350),o=(n(362),n(5)),l=n.n(o),s=n(13),c=n(2),u=(n(364),n(11)),m=n.n(u),d=n(34),f=n(106),p=n.n(f),b=n(66),g="function"===typeof window.require,v="function"===typeof window.require&&!window.require("electron-is-dev"),y=g?window.require("electron").remote:null,h=(g&&y.session,g?y.getCurrentWindow():{minimize:function(){},maximize:function(){},restore:function(){},close:function(){},isMaximized:function(){return!0}}),E=g?h.webContents.session.cookies:null;console.log("isDev",!1),console.log("isElectron",g),console.log("isProd",v);var j=n(351),_=n(352),O=new(n(356).a),N=function(){},S=new(function(){function e(){Object(j.a)(this,e)}return Object(_.a)(e,[{key:"getAll",value:function(){return g||v?E.get({}).then((function(e){return e.reduce((function(e,t){return e[t.name]=t.value,e}),{})})).catch((function(e){return console.log(e),{}})):Promise.resolve(O.getAll()||{})}},{key:"get",value:function(e){return g||v?E.get({name:e}).then((function(e){return e.map((function(e){return e.value}))})).then((function(e){return e[0]||""})).catch((function(e){return console.log(e),""})):Promise.resolve(O.get(e)||"")}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object.assign({},n);if(g||v){var r=new Date(Date.now());return a=Object.assign(a,{name:e,value:t,url:k,expirationDate:r.setFullYear(r.getFullYear()+1)}),E.set(a).then((function(){return E.get({})})).then((function(e){return e.map((function(e){return{name:e.name,value:e.value}}))})).catch(console.error)}return Promise.resolve(O.set(e,t,n))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g||v?E.remove(k,e):O.get(e)?Promise.resolve(O.remove(e,t)):Promise.reject("Couldn't remove cookie")}}]),e}()),k=b.prodServer,w=b.prodResultsServer;function C(e){return e=Object.assign(e,{method:"GET"}),p()(e).then((function(e){return e.data})).catch((function(e){throw console.error(e),e.response&&N("".concat(e.response.status," ").concat(e.response.statusText,": /").concat(e.response.config.url.split("/").pop()),e.response.data),e}))}function x(e){return e=Object.assign(e,{method:"POST",headers:{"Content-Type":"application/json"}}),p()(e).then((function(e){return e.data})).catch((function(e){throw e.response&&N("".concat(e.response.status," ").concat(e.response.statusText,": /").concat(e.response.config.url.split("/").pop()),e.response.data),e}))}function P(e){e.preventDefault&&e.preventDefault(),e.persist&&e.persist();for(var t=e.target;"HTMLFormElement"!==t.constructor.name&&t.parentElement;)t=t.parentElement;if("HTMLFormElement"!==t.constructor.name)throw new Error("Couldn't find valid form");return x({data:Array.from(t).reduce((function(e,t){return t.name?("submit"===t.name||("number"===t.type?e[t.name]=Number(t.value):e[t.name]=t.value),e):e}),{}),url:t.action})}function R(e){N=e}p.a.defaults.baseURL=k,p.a.interceptors.request.use(function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d.a,e.t1={},e.t2=t,e.t3=d.a,e.t4={},e.t5=t.headers,e.t6=JSON,e.next=9,S.getAll();case 9:return e.t7=e.sent,e.t8=e.t6.stringify.call(e.t6,e.t7),e.t9={Authorization:e.t8},e.t10=(0,e.t3)(e.t4,e.t5,e.t9),e.t11={headers:e.t10},e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t11));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var D=/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i,B=/chess\.com\/(?:live(?:\?\w+)?#tm=|club\/matches\/live\/(?:[a-z-]+\/)?)([0-9]+)/,I=/^(y(es)?|true|on)?$/i,T=/^(n(?:o)?|false|off)?$/i,L=/^[a-z][\w-]{0,28}[a-z0-9]$/i,M=n(35),A=n.n(M),F=n(21),U=n.n(F),G=n(32);function H(e){var t;return r.a.createElement("div",{className:[A.a.logo,null===(t=e.classNames)||void 0===t?void 0:t.logo].join(" ")},r.a.createElement("img",{style:{visibility:e.loading?"hidden":"visible"},className:A.a.staticLogo,src:"./images/favicon.png",alt:"swiss-logo.png"}),r.a.createElement("img",{style:{visibility:e.loading?"visible":"hidden"},className:A.a.staticLogo,src:"./images/loading_queen.png",alt:"swiss-logo.png"}),r.a.createElement("img",{style:{visibility:e.loading?"visible":"hidden"},className:A.a.crownOutline,src:"./images/crown-outline.png",alt:"outline-gif"}),r.a.createElement("img",{style:{visibility:e.loading?"visible":"hidden"},className:A.a.loadingGif,src:"./images/loading-crown.gif",alt:"loading-gif"}))}function V(e){var t=Object(a.useState)(!1),n=Object(c.a)(t,2),i=n[0],o=n[1],l=Object(a.useState)(!1),s=Object(c.a)(l,2),u=s[0],d=s[1],f=Object(a.useState)(""),p=Object(c.a)(f,2),b=p[0],g=p[1],v=Object(a.useCallback)((function(t){o(!1),P(t).then((function(t){return e.login(t)})).catch((function(e){e&&e.response&&e.response.data&&g(e.response.data),console.error(e)})).finally((function(){o(!1)}))}),[o,g,e.login]),y=Object(a.useMemo)((function(){return r.a.createElement("form",{className:U.a.form,method:"POST",onSubmit:v,action:m.a.resolve(k,"login")},r.a.createElement("input",{type:"text",name:"username",required:!0,placeholder:"username",className:["input",U.a.input].join(" ")}),r.a.createElement("input",{type:"password",name:"password",required:!0,placeholder:"password",className:["input",U.a.input].join(" ")}),r.a.createElement("div",{className:U.a.forgottenContainer},r.a.createElement("div",{className:["input",U.a.forgotten].join(" ")},"username reminder"),r.a.createElement("div",{className:["input",U.a.forgotten].join(" ")},"password reset")),r.a.createElement("input",{type:"submit",value:"LOGIN",className:["input",U.a.submit].join(" ")}))}),[v]),h=Object(a.useMemo)((function(){return r.a.createElement("form",{className:U.a.form,method:"POST",onSubmit:v,action:m.a.resolve(k,"register")},r.a.createElement("input",{type:"text",name:"username",required:!0,placeholder:"username",className:["input",U.a.input].join(" ")}),r.a.createElement("input",{type:"password",name:"password",required:!0,placeholder:"password",minLength:8,className:["input",U.a.input].join(" ")}),r.a.createElement("input",{type:"email",name:"email",required:!0,placeholder:"email",className:["input",U.a.input].join(" "),pattern:D.source}),r.a.createElement("input",{type:"submit",value:"REGISTER",className:["input",U.a.submit].join(" ")}))}),[v]),E=Object(a.useMemo)((function(){return r.a.createElement("div",{className:[U.a.loginSection,U.a.initialiseButton].join(" ")},r.a.createElement("div",{className:U.a.loginBackground},r.a.createElement("div",{className:[U.a.flip,"button"].join(" "),onClick:function(){o(!0),d(!1),g(""),setTimeout((function(){return o(!1)}),500)}},r.a.createElement("div",null,"LOGIN"),r.a.createElement("div",null,r.a.createElement(G.a,null))),r.a.createElement("div",null),r.a.createElement("div",{className:[U.a.flip,"button"].join(" "),onClick:function(){o(!0),d(!0),g(""),setTimeout((function(){return o(!1)}),500)}},r.a.createElement("div",null,"REGISTER"),r.a.createElement("div",null,r.a.createElement(G.b,null))),"Background"),r.a.createElement("div",{className:[U.a.foreground,u?U.a.registerForeground:U.a.loginForeground].join(" ")},u?h:y))}),[o,d,g,u]),j=Object(a.useMemo)((function(){return r.a.createElement(H,{setLoading:function(e){return o(e)},loading:i})}),[o,i]);return r.a.createElement("div",{className:A.a.canvas},r.a.createElement("div",{className:A.a.column}),r.a.createElement("div",{className:[A.a.column,U.a.column].join(" ")},j,r.a.createElement("div",{className:["container",U.a.container].join(" ")},E),r.a.createElement("div",{className:U.a.messageBar},b||"\u200b")),r.a.createElement("div",{className:A.a.column}))}var K=n(6),W=n(67),z=n.n(W);function q(){h.isMaximized()?h.restore():h.maximize()}function Y(){return r.a.createElement("div",{className:z.a.statusBar},r.a.createElement("div",{className:z.a.title},"ScorchApp"),r.a.createElement("div",{className:z.a.menu},r.a.createElement("div",{className:z.a.favicon},r.a.createElement("img",{alt:"favicon",draggable:!1,src:"./logo192.png"}))),r.a.createElement("div",{className:z.a.exec},r.a.createElement("div",{onClick:function(){return h.minimize()}},r.a.createElement(K.D,null)),r.a.createElement("div",{onClick:q},h.isMaximized()?r.a.createElement(K.E,null):r.a.createElement(K.C,null)),r.a.createElement("div",{onClick:function(){return h.close()},className:z.a.close},r.a.createElement(K.B,null))))}var J=n(29),X=n(43),Z=n(14),Q=n.n(Z),$=n(3),ee=n.n($);function te(e){var t,n=Object(a.useState)(!1),i=Object(c.a)(n,2),o=i[0],u=i[1],m=Object(a.useState)(null),d=Object(c.a)(m,2),f=d[0],p=d[1],b=Object(a.useState)([]),g=Object(c.a)(b,2),v=g[0],y=g[1],h=Object(a.useState)([null,"",""]),E=Object(c.a)(h,2),j=E[0],_=E[1],O=Object(a.useRef)(null),N=e.limit||5,S=e.timeout||500,k=Object(a.useCallback)((function(t,n){if(n){var a=t.slice(0),r=a.findIndex((function(e){return e.id===n.id}));return r>=0&&a.splice(r,1),a.unshift(n),e.onSubmit(n.id),p(null),y([]),O.current.value="",_([null,"",""]),a}}),[e.onSubmit,p,y,O]),w=Object(a.useReducer)(k,[]),C=Object(c.a)(w,2),x=C[0],P=C[1],R=Object(a.useCallback)((function(e){e.nativeEvent.data||p(null),_([e.target,e.target.value,e.nativeEvent.data])}),[_,p]),D=Object(a.useCallback)(function(){var t=Object(s.a)(l.a.mark((function t(n){var a,r,i,o,s,m,d,f;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Object(c.a)(n,3),r=a[0],a[1],i=a[2],o=r.value,s=o.length,!e.onInput){t.next=10;break}return u(!0),t.next=7,e.onInput(o).finally((function(){return u(!1)}));case 7:m=t.sent,t.next=11;break;case 10:m=(e.options||[]).filter((function(t){return e.getName(t).toLowerCase().startsWith(o.toLowerCase())}));case 11:if(y(m),(d=m[0])&&i){t.next=15;break}return t.abrupt("return");case 15:f=e.getName(d),r.value+=f.slice(s),r.select(),r.setSelectionRange(s,f.length,"forward"),p(d);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.options,e.getName,e.onInput,u,y,p]);Object(a.useEffect)((function(){if(j[0]){if(e.onInput){var t=setTimeout((function(){return D(j)}),S);return function(){return clearTimeout(t)}}D(j)}}),[j,e.onInput,D]);var B=Object(a.useCallback)((function(e){switch(e.keyCode){case 27:e.target.value="",p(null),y([]);break;case 13:f&&(e.target.value="",P(f))}}),[p,f]),I=Object(a.useMemo)((function(){for(var t=e.styles,n=0,a=Object.entries(Object.assign({},ee.a));n<a.length;n++){var r=Object(c.a)(a[n],2),i=r[0],o=r[1];t[i]?t[i]+=" "+o:t[i]=o}return t}),[e.styles]);return r.a.createElement("div",{className:I.infoBox},r.a.createElement("div",{className:["button",I.searchBar].join(" "),tabIndex:1},!1!==e.showIcon?r.a.createElement(K.v,null):null,r.a.createElement("input",{onKeyDown:B,onInput:R,placeholder:null!==(t=e.placeholder)&&void 0!==t?t:"Search",ref:O})),!1!==e.showChoices?r.a.createElement("div",{className:[I.searchResults,"scrollable"].join(" ")},o?r.a.createElement("div",{className:"loading"},r.a.createElement(K.w,null)):v.length||!j[1]?v.slice(0,N).concat(!1!==e.showHistory?x:[]).map((function(t,n){return r.a.createElement("div",{tabIndex:0,onKeyDown:B,onFocus:function(){return p(t)},onClick:function(){return P(t)},key:["history",n].join(".")},e.getName(t))})):r.a.createElement("div",null,"No players found.")):null)}function ne(e){var t,n=Object(a.useState)(e.content),i=Object(c.a)(n,2),o=i[0],l=i[1],s=Object(a.useState)(e.alwaysEnabled||!1),u=Object(c.a)(s,2),m=u[0],f=u[1],p=Object(a.useState)(!1),b=Object(c.a)(p,2),g=b[0],v=b[1],y=Object(a.useRef)(null),h=Object(a.useRef)(null);Object(a.useEffect)((function(){e.content||l(""),l(e.content)}),[e,e.content,l]);var E=Object(a.useCallback)((function(t){t.preventDefault();var n=t.target;"HTMLButtonElement"===n.constructor.name&&n.parentNode[e.name||"name"].stepDown()}),[e.name]),j=Object(a.useCallback)((function(t){t.preventDefault();var n=t.target;"HTMLButtonElement"===n.constructor.name&&n.parentNode[e.name||"name"].stepUp()}),[e.name]),_=Object(a.useCallback)((function(t){if(t.preventDefault(),e.handleClear)e.handleClear().then((function(){f(e.alwaysEnabled||!1),l("")}));else{var n=t.target.parentElement;if("HTMLFormElement"!==n.constructor.name)return Promise.resolve(f(e.alwaysEnabled||!1));var a=n[e.name||"name"];if("HTMLInputElement"!==a.constructor.name)return Promise.resolve(f(e.alwaysEnabled||!1));l(null),a.value=null,n[e.name||"name"]=null,t.target=n,S({target:n})}}),[e.handleClear,f,l,e.alwaysEnabled]),O=Object(a.useCallback)((function(t){return t.preventDefault(),e.handleSubmit(e.name||"name",0).then((function(){f(e.alwaysEnabled||!1),l("0")}))}),[e.handleSubmit,f,l,e.name]),N=Object(a.useCallback)((function(t){return t.preventDefault(),e.handleSubmit(e.name||"name","Infinity").then((function(){f(e.alwaysEnabled||!1),l("\u221e")}))}),[e.handleSubmit,f,l,e.alwaysEnabled,e.name]),S=Object(a.useCallback)((function(t){if(t.preventDefault&&t.preventDefault(),e.useHandleSubmit){var n,a=t.target;if("HTMLFormElement"===a.constructor.name)n=a[e.name||"name"];else{if("HTMLInputElement"!==a.constructor.name)return Promise.resolve(f(e.alwaysEnabled||!1));n=a}return e.handleSubmit(e.name||"name",n.value).then((function(){return f(e.alwaysEnabled||!1),t})).then(e.onSubmitSuccess).then((function(){return l(n.value)})).catch((function(e){e&&console.error(e)}))}return P(t).then((function(){return f(e.alwaysEnabled||!1),t})).then(e.onSubmitSuccess).then((function(e){for(var t=e.target;"HTMLFormElement"!==t.constructor.name&&t.parentElement;)t=t.parentElement;if("HTMLFormElement"!==t.constructor.name)throw new Error("Couldn't find valid form");var n=t.firstChild.value;l(n)})).catch((function(e){e&&console.error(e)}))}),[e.useHandleSubmit,e.handleSubmit,e.name,f,e.onSubmitSuccess,e.alwaysEnabled,f,l]),k=Object(a.useCallback)((function(t){switch(t.keyCode){case 27:return f(e.alwaysEnabled||!1),t;case 13:return S(t),t;default:return t}}),[f,S,e.alwaysEnabled]);function w(t){var n,a,i,o,s,c,u,m,p,b,g,v,h=t.name;v="datetime-local"===e.inputType?h?function(e){if(isNaN(e.valueOf()))return"";var t=6e4*e.getTimezoneOffset();return new Date(e.valueOf()-t).toISOString().slice(0,16)}(new Date(h)):function(e){var t=new Date(e.setUTCHours(e.getUTCHours()+1));return t.getUTCMinutes()<30?new Date(t.setUTCMinutes(30)):new Date(new Date(t.setUTCMinutes(0)).setUTCHours(t.getUTCHours()+1))}(new Date(e.defaultEditContent)).toString():h,(null===(n=e.show)||void 0===n?void 0:n.any)&&"0"===v&&(v="");var w=e.name||"name";return e.search?r.a.createElement(te,{onSubmit:function(t){return x({url:e.url,data:Object(d.a)(Object(J.a)({},w,t),e.additionalInputProps)}).then((function(){f(e.alwaysEnabled||!1),l(t)}))},options:e.search.options,getName:e.search.getName,placeholder:v||"",showChoices:!1,showIcon:!1,styles:ee.a}):r.a.createElement("form",{ref:e.formRef,className:ee.a.form,target:"_self",onKeyDown:k,onSubmit:S,method:"POST",action:e.url},r.a.createElement("input",Object.assign({type:e.inputType,className:[ee.a.input,e.additionalStyles.input].join(" "),name:e.name||"name",defaultValue:v,placeholder:" ",required:!0,ref:y},e.additionalInputProps)),r.a.createElement("button",{className:[!(null===(a=e.show)||void 0===a?void 0:a.submit)||(null===(i=e.show)||void 0===i?void 0:i.infinity)||(null===(o=e.show)||void 0===o?void 0:o.any)||(null===(s=e.show)||void 0===s?void 0:s.clear)?ee.a.submitHidden:"",ee.a.cancel].join(" "),onClick:function(){return f(e.alwaysEnabled||!1)}},r.a.createElement(K.y,null)),r.a.createElement("button",{className:[(null===(c=e.show)||void 0===c?void 0:c.clear)?"":ee.a.submitHidden,ee.a.cancel].join(" "),onClick:_},r.a.createElement(K.y,null)),r.a.createElement("button",{className:[(null===(u=e.show)||void 0===u?void 0:u.any)?"":ee.a.submitHidden,ee.a.any].join(" "),onClick:O},"Any"),r.a.createElement("button",{className:[(null===(m=e.show)||void 0===m?void 0:m.infinity)?"":ee.a.submitHidden,ee.a.infinity].join(" "),onClick:N},"\u221e"),r.a.createElement("button",{type:"button",value:"\u25bc",className:[(null===(p=e.show)||void 0===p?void 0:p.increment)?"":ee.a.submitHidden,ee.a.increment].join(" "),onClick:E},r.a.createElement(K.d,null)),r.a.createElement("button",{className:[(null===(b=e.show)||void 0===b?void 0:b.increment)?"":ee.a.submitHidden,ee.a.increment].join(" "),onClick:j},r.a.createElement(K.e,null)),r.a.createElement("button",{type:"submit",className:[(null===(g=e.show)||void 0===g?void 0:g.submit)?"":ee.a.submitHidden,ee.a.submit].join(" ")},r.a.createElement(K.f,null)),e.children)}Object(a.useEffect)((function(){l(e.content)}),[e.content]),Object(a.useEffect)((function(){if(g){var e=y.current;e&&(e.select?e.select():e.focus&&e.focus())}}),[y,g]),ve((function(t){h.current&&h.current.contains(t.target)||f(e.alwaysEnabled||!1)}));var C,R=Math.random().toString(16).slice(2,9),D=o;return D&&"datetime-local"===e.inputType?(C=new Date(o),D=isNaN(C.valueOf())?"":C.toLocaleString("en-GB").slice(0,-3)):(null===(t=e.show)||void 0===t?void 0:t.any)&&"0"===D&&(D="Any"),r.a.createElement("div",{ref:h,className:[ee.a.container,e.additionalStyles.container].join(" "),id:R},m?r.a.createElement(w,{name:o}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:[ee.a.editableField,e.additionalStyles.editableField||""].join(" "),onClick:function(){f(!0),v(!0)}},D||e.defaultContent||"\u200b"),e.children))}var ae=n(31),re=n(7),ie=n.n(re),oe=n(201),le=n.n(oe),se=n(202),ce=n.n(se),ue=n(203),me=n.n(ue),de=n(204),fe=n.n(de);function pe(e){var t,n,i=Object(a.useState)(void 0),o=Object(c.a)(i,2),l=o[0],s=o[1],u=Object(a.useState)(""),d=Object(c.a)(u,2),f=d[0],p=d[1],b=Object(a.useState)(!1),g=Object(c.a)(b,2),v=g[0],y=g[1],h=function(t){var n=t.target.parentElement,a=e.validate(n);p("string"===typeof a?a:""),s("boolean"===typeof a?a:"string"!==typeof a&&void 0);for(var r=0,i=Array.from(n.children);r<i.length;r++){var o=i[r];if("HTMLInputElement"===o.constructor.name&&("hidden"!==o.getAttribute("type")&&o.value.toString()))return void y(!0)}y(!1)},E=Object(a.useMemo)((function(){return Object.values(e.gameLinks).some((function(e){return e}))}),[e.gameLinks]);return null!==e.result[0]||null!==e.result[1]?r.a.createElement("div",{className:ee.a.resultsBridge},r.a.createElement("div",{className:[ee.a.setResult,E?ee.a.linked:""].join(" ")},null!==(t=e.result[0])&&void 0!==t?t:"\u200b"),r.a.createElement("div",{className:ee.a.neutral,onClick:function(){return e.expand(!e.expanded)},style:{transform:e.expanded?"rotate(540deg)":"rotate(0deg)"}},r.a.createElement(K.g,null)),r.a.createElement("div",{className:[ee.a.setResult,E?ee.a.linked:""].join(" ")},null!==(n=e.result[1])&&void 0!==n?n:"\u200b")):r.a.createElement("form",{className:ee.a.resultsBridge,target:"_self",onSubmit:function(t){if(t.persist(),!e.validate(t.target))return t.preventDefault();P(t).then((function(){return e.handleSubmit(t)}))},method:"POST",action:m.a.resolve(k,["tournament",e.tournamentID,"addResult"].join("/"))},r.a.createElement("input",{type:"number",min:0,step:.5,name:"resultWhite",required:!0,className:[e.inputClassName,E?ee.a.linked:"",v||E?ee.a.alwaysVisible:"",E?ee.a.hasLink:""].join(" "),onChange:h}),r.a.createElement("div",{className:ee.a.centre},f?r.a.createElement("span",{className:"tooltip"},f):null,l?r.a.createElement("button",{tabIndex:-1,className:ee.a.resolve},r.a.createElement(K.f,null)):!1===l?r.a.createElement("button",{tabIndex:-1,className:ee.a.reject,onClick:function(e){e.preventDefault(),e.target.parentElement.parentElement.reset(),p(""),s(void 0)}},r.a.createElement(K.y,null)):r.a.createElement("div",{className:ee.a.neutral,onClick:function(){return e.expand(!e.expanded)},style:{transform:e.expanded?"rotate(540deg)":"rotate(0deg)"}},r.a.createElement(K.g,null))),r.a.createElement("input",{type:"number",min:0,step:.5,name:"resultBlack",required:!0,className:[e.inputClassName,E?ee.a.linked:"",v||E?ee.a.alwaysVisible:"",E?ee.a.hasLink:""].join(" "),onChange:h}),Object.entries(e.hidden).map((function(e,t){var n=Object(c.a)(e,2),a=n[0],i=n[1];return r.a.createElement("input",{key:["hiddenInput",t].join("."),type:"hidden",name:a,value:i,required:!0})})))}function be(e){var t=Object(a.useState)("0px"),n=Object(c.a)(t,2),i=n[0],o=n[1],l=Object(a.useRef)(null),s=Object(a.useRef)(null);Object(a.useEffect)((function(){if(l.current&&e.expanded)return o(l.current.getBoundingClientRect().height+"px"),function(){return o("0px")}}),[l,o,e.expanded]);var u=e.individual?e.gameLinks.lichessLink:e.gameLinks.lichessTeamLink,d=e.individual?e.gameLinks.chessComLink:e.gameLinks.chessComTeamLink,f=Object(a.useCallback)((function(t,n){var a,r=n;if(!e.individual){var i=n.match(B);if(!i)return console.error("Invalid syntax on tournament: "+n),Promise.resolve();r="https://chess.com/club/matches/live/"+i[1]}return x({url:m.a.resolve(k,["tournament",e.tournamentID,"updateResultLink"].join("/")),data:(a={id:e.id},Object(J.a)(a,t,r),Object(J.a)(a,"type",e.individual?"individual":"team"),Object(J.a)(a,"round",e.round),a)})}),[e.id,e.individual,e.tournamentID]),p=Object(a.useCallback)((function(t){var n=e.id.split("."),a=Object(c.a)(n,2),r=a[0],i=a[1];return x({url:m.a.resolve(k,["tournament",e.tournamentID,"clearResultLink"].join("/")),data:{idW:r,idB:i,site:t,type:e.individual?"individual":"team",round:e.round}})}),[e.id,e.individual,e.tournamentID]),b=Object(a.useCallback)((function(){var t=e.id.split("."),n=Object(c.a)(t,2),a=n[0],r=n[1];return x({url:m.a.resolve(k,["tournament",e.tournamentID,"undoResult"].join("/")),data:{idW:a,idB:r,round:e.round}}).then(e.updatePlayerDict)}),[e.id,e.individual,e.tournamentID]);return r.a.createElement("div",{className:[e.className,ee.a.details].join(" "),style:{height:i}},r.a.createElement("div",{ref:l,className:[ee.a.detailsContent].join(" ")},r.a.createElement("div",{className:ee.a.row},"Board: ",e.board,"\n"),r.a.createElement("button",{className:[ee.a.button,ee.a.infinity,ee.a.undoPairing].join(" "),onClick:function(){return e.triggerConfirm("Really undo result? This action cannot be undone",b,(function(){}))}},r.a.createElement(K.z,null),"Undo result"),r.a.createElement("div",null,r.a.createElement("div",{className:ee.a.row},"For online games, enter ",e.individual?"":"team match ","game links below:"),r.a.createElement("div",{className:ee.a.row},r.a.createElement(ne,{content:d,url:m.a.resolve(k,["tournament",e.tournamentID,"updateResultLink"].join("/")),onSubmitSuccess:function(t){return e.update(),t},handleSubmit:function(e,t){return f("chessCom",t)},name:"link",additionalInputProps:{},additionalStyles:{input:ee.a.inputURL,editableField:ee.a.editableField},formRef:s,useHandleSubmit:!0,handleClear:function(){return p("chessCom")},show:{clear:!0}},r.a.createElement("button",{className:[ee.a.submit,ee.a.linkSubmit].join(" ")},r.a.createElement("img",{src:le.a,alt:"chess.com"})))),r.a.createElement("div",{className:ee.a.row},r.a.createElement(ne,{content:u,url:m.a.resolve(k,["tournament",e.tournamentID,"updateResultLink"].join("/")),onSubmitSuccess:function(t){return e.update(),t},handleSubmit:function(e,t){return f("lichess",t)},name:"link",additionalInputProps:{},additionalStyles:{input:ee.a.inputURL,editableField:ee.a.editableField},formRef:s,useHandleSubmit:!0,handleClear:function(){return p("lichess")},show:{clear:!0}},r.a.createElement("button",{className:[ee.a.increment,ee.a.linkSubmit].join(" ")},r.a.createElement("img",{src:ce.a,alt:"lichess"})))))))}function ge(e){var t=Object(a.useState)(null),n=Object(c.a)(t,2),i=n[0],o=n[1],l=Object(a.useState)(null),s=Object(c.a)(l,2),u=s[0],d=s[1],f=Object(a.useState)(!1),p=Object(c.a)(f,2),b=p[0],g=p[1],v=Object(a.useState)(""),y=Object(c.a)(v,2),h=y[0],E=y[1],j=Object(a.useRef)(null),_=Object(a.useCallback)((function(t){if(!t)return"\u200b";if("bye"===t)return"BYE";var n=e.playerDict.get(t);return n?"individual"===e.settings.competitors?[n.firstName,n.lastName].join(" "):n.firstName:t}),[e.playerDict,"individual"===e.settings.competitors]);Object(a.useEffect)((function(){if(g(!1),i&&u){if("bye"===i.id&&"bye"===u.id)return E("Cannot pair BYE with BYE");if(i.histories&&i.histories[e.round]&&!i.histories[e.round].match)return E(_(i.id)+" is already paired");if(u.histories&&u.histories[e.round]&&!u.histories[e.round].match)return E(_(u.id)+" is already paired");E(""),g(!0)}}),[i,u]);var O=Object(a.useCallback)((function(t){var n=t.target;if(t.nativeEvent.data){var a=n.value;if(a.trim()){var r=a.length,i=[{id:"bye"}].concat(Object(ae.a)(Array.from(e.playerDict.values()))).filter((function(e){return _(e.id).toLowerCase().startsWith(a.toLowerCase())}))[0];if(i){var l=_(i.id);n.value=l,n.select(),n.setSelectionRange(r,l.length,"forward"),"idW"===n.name?o(i):d(i)}}}else"idW"===n.name?o(null):d(null)}),[e.playerDict]),N=Object(a.useCallback)((function(t){switch(t.keyCode){case 27:return e.close();case 13:var n=j.current;if(!n)return;n.requestSubmit(),t.preventDefault()}}),[e.close]);return r.a.createElement("form",{ref:j,target:"_self",onKeyDown:N,onSubmit:function(t){t.preventDefault(),x({url:m.a.resolve(k,["tournament",e.tournamentID,"manualPairing"].join("/")),data:{idW:i.id,idB:u.id,round:e.round}}).then((function(){return e.handleSubmit(t)}))},method:"POST",action:m.a.resolve(k,["tournament",e.tournamentID,"manualPairing"].join("/"))},r.a.createElement("div",{className:ie.a.manualResultsBridge},r.a.createElement("input",{onInput:O,autoComplete:"off",placeholder:"White",className:["playerInfo",ie.a.playerInfo].join(" "),name:"idW",style:{gridArea:"white"}}),r.a.createElement("div",{className:ie.a.scoreSpacer,style:{gridArea:"wR"}}),r.a.createElement("div",{className:ie.a.centre,style:{gridArea:"dash"}},h?r.a.createElement("span",{className:"tooltip"},h):null,b?r.a.createElement("button",{tabIndex:-1,className:ee.a.resolve},r.a.createElement(K.f,null)):r.a.createElement("button",{tabIndex:-1,className:ee.a.reject,onClick:e.close},r.a.createElement(K.y,null))),r.a.createElement("div",{className:ie.a.scoreSpacer,style:{gridArea:"bR"}}),r.a.createElement("input",{onInput:O,autoComplete:"off",placeholder:"Black",className:["playerInfo",ie.a.playerInfo].join(" "),name:"idB",style:{gridArea:"black"}})))}var ve=function(e){Object(a.useEffect)((function(){return window.addEventListener("mousedown",e),function(){return window.removeEventListener("mousedown",e)}}),[e])},ye=n(50),he=n(105);function Ee(e){return e?e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase():e}function je(e,t){var n=Object(a.useState)(e),r=Object(c.a)(n,2),i=r[0],o=r[1];return Object(a.useDebugValue)("".concat(t,": ").concat(i)),[i,o]}function _e(e){var t=!1;t="undefined"!==typeof e.lastRoundOverride?e.lastRoundOverride:!e.status.active;var n=m.a.resolve(k,["tournament",e.status.id,"setName"].join("/")),i=Object(a.useMemo)((function(){return e.userRound||e.status.round}),[e.userRound,e.status.round]),o=Object(a.useCallback)((function(){i>1&&(e.setRound(i-1),e.switchPairings(!1))}),[i,e.setRound,e.switchPairings]),l=Object(a.useCallback)((function(){i<e.status.round&&(e.setRound(i+1),e.switchPairings(!1))}),[i,e.setRound,e.switchPairings]);return r.a.createElement("div",{className:Q.a.titleBar},r.a.createElement("div",{className:Q.a.stage},r.a.createElement("div",{className:Q.a.row},r.a.createElement("div",{className:["topBanner",Q.a.header].join(" ")},r.a.createElement(ne,{content:e.status.name,url:n,inputType:"text",handleSubmit:function(e,t){return x({url:n,data:Object(J.a)({},e,t)})},additionalStyles:Q.a,additionalInputProps:{},onSubmitSuccess:function(t){return e.updateTournamentStatus(),t},defaultContent:"Unnamed ".concat(Ee(e.settings.pairingSystem)," Tournament"),show:{submit:!0}}))),r.a.createElement("div",{className:[Q.a.row,Q.a.statusBar].join(" ")},r.a.createElement("div",{id:Q.a.previous,className:[i>1?"button":Q.a.fixed].join(" "),onClick:o},r.a.createElement(K.a,null)),r.a.createElement("div",{className:Q.a.fixed},"Round: ",i?i+" / "+("Infinity"===e.totalRounds?"\u221e":e.totalRounds):"Not yet initialised"),r.a.createElement("div",{id:Q.a.next,className:[i<e.status.round?"button":Q.a.fixed].join(" "),onClick:l},r.a.createElement(K.b,null))),r.a.createElement("div",{className:Q.a.row},r.a.createElement("div",{className:["button",Q.a.button].join(" "),onClick:e.closeTournament},r.a.createElement(ye.b,{style:{color:"indianred",strokeWidth:1.5}})," Exit to menu"),r.a.createElement("div",{className:["button",Q.a.button].join(" "),onClick:function(){t&&e.status.round>=e.settings.totalRounds?e.triggerError("Increase the number of rounds in Settings to continue!"):e.setLastRound(!t)}},t?r.a.createElement(r.a.Fragment,null,r.a.createElement(K.s,{style:{color:"yellow"}})," ","Resume tournament"):r.a.createElement(r.a.Fragment,null,r.a.createElement(K.q,{style:{color:"yellow"}})," ","Pause tournament"))),r.a.createElement("div",{className:Q.a.row},r.a.createElement("div",{className:["button",Q.a.button].join(" "),onClick:e.toggleCrossTable},r.a.createElement(r.a.Fragment,null,r.a.createElement(K.x,{style:{color:"green"}})," ","Crosstable")),r.a.createElement("div",{className:[i===e.status.round?Q.a.active:Q.a.inactive,"button",Q.a.button].join(" "),onClick:i===e.status.round?function(){return e.switchPairings()}:function(){}},i===e.status.round&&e.status.round?e.status.active&&!e.switchMode?r.a.createElement(r.a.Fragment,null,r.a.createElement(he.a,{style:{color:"#385898",strokeWidth:1.5}}),"Switch or undo pairings"):r.a.createElement(r.a.Fragment,null,r.a.createElement(ye.b,{style:{color:"#385898",strokeWidth:1.5}}),"Back"):"\u200b"))))}var Oe=n(30);function Ne(e){var t=Object(a.useMemo)((function(){return e.userRound||e.status.round}),[e.userRound,e.status.round]),n=Object(a.useReducer)((function(e,t){return Math.random().toString(16).slice(2,9)}),""),i=Object(c.a)(n,2),o=i[0],u=i[1],m=Object(a.useCallback)((function(n,a){var r=a.id,i=a.W,o=a.B;return n.set(r,[i?i.histories?i.histories[t][e.settings.displayPoints]:null:0,o?o.histories?o.histories[t][e.settings.displayPoints]:null:0]),u({}),n}),[t,e.settings.displayPoints]),d=Object(a.useState)([]),f=Object(c.a)(d,2),p=f[0],b=f[1],g=Object(a.useReducer)(m,new Map),v=Object(c.a)(g,2),y=v[0],h=v[1],E=Object(a.useState)(!1),j=Object(c.a)(E,2),_=j[0],O=j[1],N=Object(a.useCallback)((function(){if(t&&e.playerDict.size)return C({url:"/tournament/"+e.id+"/getPairings",params:{round:t}}).then((function(t){var n,a=Object(X.a)(t);try{for(a.s();!(n=a.n()).done;){var r=Object(c.a)(n.value,2),i=r[0],o=r[1];h({id:i+"."+o,W:e.playerDict.get(i),B:e.playerDict.get(o)})}}catch(l){a.e(l)}finally{a.f()}b(t)})).catch(console.error)}),[e.id,b,h,t,e.playerDict,e.playerDictKey]);function S(t,n){return"bye"===t?"BYE":n?(a="individual"===e.settings.competitors?[n.firstName,n.lastName].join(" "):n.firstName,"".concat(a," [").concat(n.score,"]")):t;var a}var k=Array.from(y.values()).filter((function(e){return e.every((function(e){return null===e}))})),w=Object(a.useCallback)((function(){return x({url:"/tournament/"+e.id+"/getRestPairings"}).then(e.updatePlayerDict).catch(console.error)}),[N,e.id]),P=Object(a.useCallback)((function(){return O(!0),x({url:"/tournament/"+e.id+"/getNextPairings"}).then(e.updatePlayerDict).then(e.updateRound).catch(console.error).finally((function(){return O(!1)}))}),[O,b,e.id,N,e.updateRound,O]),R=Object(a.useMemo)((function(){return!!Array.from(e.playerDict.values()).filter((function(e){return!1!==e.active&&e.histories&&!e.histories[t]})).length}),[e.playerDict,e.playerDictKey,t]);var D=Object(a.useMemo)((function(){var n;return n=t>=e.settings.totalRounds||"undefined"!==typeof e.lastRoundOverride&&e.lastRoundOverride,_?"loading":t<e.status.round?"none":e.canTriggerNextRound?k.length>0?"wait":n?e.status.active?"publish":"last":"next":"inactive"}),[t,e.status.active,e.settings.totalRounds,e.lastRoundOverride,_,e.status.round,e.canTriggerNextRound,k.length]),B=Object(a.useCallback)((function(t){x({url:["tournament",e.id,t?"unpublish":"publish"].join("/")}).then(e.updateStatus),!t&&e.settings.allowNewPlayers&&e.updateSetting("allowNewPlayers",!1)}),[e.id,e.settings.allowNewPlayers,e.updateSetting]);function I(t){if(""!==t.resultWhite.value||""!==t.resultBlack.value)return!!Array.from(t).every((function(e){return e.validity.valid}))&&(!e.settings.gamePointTotal||(Number(t.resultWhite.value)+Number(t.resultBlack.value)===("game"===e.settings.displayPoints?e.settings.gamePointTotal:1)||"Setting: sum results to "+e.settings.gamePointTotal))}var T=Object(a.useState)(""),L=Object(c.a)(T,2),M=L[0],A=L[1],F=Object(a.useCallback)((function(){var n=Object(a.useState)(!1),i=Object(c.a)(n,2),o=i[0],m=i[1];return o?r.a.createElement("div",{className:ie.a.manualPairing},r.a.createElement(ge,{tournamentID:e.id,playerDict:e.playerDict,settings:e.settings,close:function(){return m(!1)},round:t,handleSubmit:function(){var t=Object(s.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u({}),e.updatePlayerDict(),t.abrupt("return",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})):r.a.createElement("div",{className:ie.a.pairingAddButton,onClick:function(){return m(!0)}},"New manual pairing")}),[e.id,e.playerDict,e.settings,u,e.updatePlayerDict]);Object(a.useEffect)((function(){N()}),[N]);var U=Object(a.useMemo)((function(){var n,a=[],i=e.playerDict,o=1,m=Object(X.a)(p);try{var d=function(){var m=Object(c.a)(n.value,3),d=m[0],f=m[1],p=m[2],b=[i.get(d),i.get(f)],g=b[1],v=[S(d,b[0]),S(f,g)],h=v[0],E=v[1],j=d+"."+f,_=y.get(j);if(!_)return"continue";a.push(r.a.createElement("div",{id:j,className:ie.a.pairing,key:["pairings",d,f].join(".")},r.a.createElement("div",{className:["playerInfo",ie.a.playerInfo,"bye"===d?ie.a.bye:""].join(" "),id:d,onClick:function(t){return"bye"===d?null:e.setDisplayPlayer(t.target.id)}},h),r.a.createElement(pe,{expand:function(e){return A(e?j:"")},expanded:M===j,result:_,gameLinks:p,tournamentID:e.id,inputClassName:ie.a.inputResult,hidden:{W:d,B:f,round:t},validate:I,handleSubmit:function(){var t=Object(s.a)(l.a.mark((function t(n){var a,r,i,o,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.target,y.set(j,[Number(a.resultWhite.value),Number(a.resultBlack.value)]),a&&(r=a.parentElement)){i=r;do{i=i.nextSibling}while(i&&!i.getElementsByTagName("form")[0]);i&&(o=i.getElementsByTagName("form")[0],(s=o.getElementsByTagName("input")[0])&&s.focus())}return u({}),e.updatePlayerDict(),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),r.a.createElement("div",{className:["playerInfo",ie.a.playerInfo,ie.a.playerInfo,"bye"===f?ie.a.bye:""].join(" "),id:f,onClick:function(t){return"bye"===f?null:e.setDisplayPlayer(t.target.id)}},E)),r.a.createElement(be,{key:["pairingDetails",d,f].join("."),tournamentID:e.status.id,id:j,board:o,round:t,className:["dropdown",ie.a.pairing].join(" "),expanded:M===j,gameLinks:p,individual:"individual"===e.settings.competitors,update:N,updatePlayerDict:e.updatePlayerDict,triggerConfirm:e.triggerConfirm})),o++};for(m.s();!(n=m.n()).done;)d()}catch(f){m.e(f)}finally{m.f()}return a}),[e.playerDict,p,S,y,o,e.updatePlayerDict,N,e.setDisplayPlayer,h,e.playerDictKey]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:ie.a.pairings},r.a.createElement("div",{className:ie.a.stage},r.a.createElement("div",{className:ie.a.titleContainer},r.a.createElement("div",{className:["topBanner",ie.a.topBanner].join(" ")},"Pairings")),r.a.createElement("div",{className:[ie.a.pairingContainer,"scrollable"].join(" ")},r.a.createElement("div",{className:[ie.a.pairingWrapper].join(" ")},U,t?r.a.createElement(F,null):null)))),r.a.createElement("div",{className:["bottomBannerBackground",ie.a.statusBarBackground].join(" ")},r.a.createElement("div",{className:["bottomBanner",ie.a.statusBar].join(" ")},r.a.createElement("div",{className:["button"].join(" "),onClick:e.toggleSidebar},r.a.createElement(K.c,null)),r.a.createElement("div",{style:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",width:"100%",columnGap:"5px"}},R&&e.status.round?r.a.createElement("div",{className:[ie.a.nextButton,"button"].join(" "),onClick:function(){return e.triggerConfirm("Pair remaining players for this round?",w,(function(){}))}},"Pair Remaining"):null,function(){switch(D){case"loading":return r.a.createElement("div",{className:[ie.a.nextButton,"button"].join(" ")},r.a.createElement(Oe.d,null));case"none":return r.a.createElement("div",{className:[ie.a.waitButton].join(" ")});case"inactive":return r.a.createElement("div",{className:[ie.a.waitButton].join(" ")},"Must have at least 2 active players");case"wait":return r.a.createElement("div",{className:[ie.a.waitButton].join(" ")},"Awaiting ".concat(k.length," result").concat(k.length>1?"s":""));case"publish":return r.a.createElement("div",{className:[ie.a.finishButton,"button"].join(" "),onClick:function(){B(!1),e.settings.public||e.toggleCrossTable()}},e.settings.public?"Publish results":"Final Standings");case"last":return r.a.createElement("div",{className:[ie.a.finishButton,"button"].join(" "),onClick:function(){B(!0)}},e.settings.public?"Unpublish results":"Resume tournament");case"next":return r.a.createElement("div",{className:[ie.a.nextButton,"button"].join(" "),onClick:P},"Next Round")}}()),r.a.createElement("div",{className:["button"].join(" "),onClick:e.toggleRightTab},r.a.createElement(K.c,null)))))}function Se(e){var t=Object(a.useMemo)((function(){return e.status.round}),[e.status.round]),n=Object(a.useState)([]),i=Object(c.a)(n,2),o=i[0],l=i[1],s=Object(a.useState)([]),u=Object(c.a)(s,2),d=u[0],f=u[1],p=[Object(a.useCallback)((function(e){return d.length<2&&!d.includes(e)?f([].concat(Object(ae.a)(d),[e])):null}),[d,f]),Object(a.useCallback)((function(e){if(d.includes(e)){var t=d.slice(0);return t.splice(d.indexOf(e),1),f(t)}}),[d,f])],b=p[0],g=p[1],v=Object(a.useCallback)((function(){if(t&&e.playerDict.size)return C({url:"/tournament/"+e.id+"/getPairings"}).then((function(e){l(e)})).catch(console.error)}),[e.id,l,t,e.playerDict,e.playerDictKey]),y=Object(a.useCallback)((function(t){if("bye"===t)return"BYE";var n,a=e.playerDict.get(t);return a?(n="individual"===e.settings.competitors?[a.firstName,a.lastName].join(" "):a.firstName,"".concat(n," [").concat(a.score,"]")):t}),[e.playerDict]),h=Object(a.useCallback)((function(){e.triggerConfirm("Really undo all pairings for this round?",(function(){return x({url:m.a.resolve(k,["tournament",e.status.id,"undoRoundPairings"].join("/")),data:{round:e.status.round}}).then((function(){f([]),e.switchPairings(),e.updateTournamentStatus(),e.updatePlayerDict()}))}),(function(){return f([])}))}),[f,e.status.id,e.status.round]),E=Object(a.useCallback)((function(){e.triggerConfirm("Really swap pairings ".concat(y(d[0])," and ").concat(y(d[1]),"?"),(function(){return x({url:m.a.resolve(k,["tournament",e.status.id,"switchPairings"].join("/")),data:{swapX:d[0],swapY:d[1],round:e.status.round}}).then((function(){f([]),e.updatePlayerDict()}))}),(function(){return f([])}))}),[d,f,e.status.id,e.status.round]),j=Object(a.useCallback)((function(n){var a=n.split("."),r=Object(c.a)(a,2),i=r[0],o=r[1];e.triggerConfirm("Really remove pairing ".concat(y(i)," vs. ").concat(y(o),"?"),(function(){return x({url:m.a.resolve(k,["tournament",e.status.id,"destroyPairing"].join("/")),data:{idW:i,idB:o,round:t}}).then((function(){f([]),e.updatePlayerDict()}))}),(function(){}))}),[y,t,f,e.updatePlayerDict]);function _(){return r.a.createElement("div",{className:[ie.a.undoButton].join(" "),onClick:h},"Undo all pairings")}function O(){var e=2-d.length;return e?r.a.createElement("div",{className:[ie.a.waitButton].join(" ")},"Select ".concat(e," more pairing").concat(e>1?"s":"")):r.a.createElement("div",{className:[ie.a.nextButton].join(" "),onClick:E},"Swap pairings")}Object(a.useEffect)((function(){v()}),[v]);var N=Object(a.useMemo)((function(){var e,t=[],n=Object(X.a)(o);try{var a=function(){var n=Object(c.a)(e.value,2),a=n[0],i=n[1],o=[y(a),y(i)],l=o[0],s=o[1],u=a+"."+i;t.push(r.a.createElement("div",{id:u,className:ie.a.pairing,key:["pairings",a,i].join(".")},r.a.createElement("div",{className:["playerInfo",ie.a.playerInfo,"bye"===a?ie.a.bye:""].join(" "),id:a,onClick:function(){return d.includes(a)?g(a):b(a)},style:{backgroundColor:d.includes(a)?"darkblue":""}},l),r.a.createElement("div",{className:ee.a.resultsBridge},r.a.createElement("div",{className:ee.a.setResult},"\u200b"),r.a.createElement("button",{tabIndex:-1,className:ee.a.reject,onClick:function(){return j(u)}},r.a.createElement(Oe.c,null)),r.a.createElement("div",{className:ee.a.setResult},"\u200b")),r.a.createElement("div",{className:["playerInfo",ie.a.playerInfo,ie.a.playerInfo,"bye"===i?ie.a.bye:""].join(" "),id:i,onClick:function(){return d.includes(i)?g(i):b(i)},style:{backgroundColor:d.includes(i)?"darkblue":""}},s)))};for(n.s();!(e=n.n()).done;)a()}catch(i){n.e(i)}finally{n.f()}return t}),[d,o,y,e.updatePlayerDict,v,e.playerDictKey]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:ie.a.pairings},r.a.createElement("div",{className:ie.a.titleContainer},r.a.createElement("div",{className:["topBanner",ie.a.topBanner].join(" ")},"Switch Pairing Mode")),r.a.createElement("div",{className:[ie.a.pairingContainer,"scrollable"].join(" ")},r.a.createElement("div",{className:[ie.a.pairingWrapper].join(" ")},N))),r.a.createElement("div",{className:["bottomBannerBackground",ie.a.statusBarBackground].join(" ")},r.a.createElement("div",{className:["bottomBanner",ie.a.switchStatusBar].join(" ")},t?r.a.createElement(_,null):null,r.a.createElement(O,null))))}var ke=n(9),we=n.n(ke),Ce=(Object(a.createContext)(new Map),Object(a.createContext)((function(){return""}))),xe=Object(a.createContext)((function(e){}));function Pe(){return r.a.createElement("div",{className:ee.a.sectionContainer},r.a.createElement("div",{className:[ee.a.sectionHeader,"topBanner"].join(" ")},r.a.createElement("div",{className:ee.a.sectionHeaderText,style:{cursor:"default"}})))}function Re(e){var t=Object(a.useState)(void 0===e.expanded||e.expanded),n=Object(c.a)(t,2),i=n[0],o=n[1],l=Object(a.useState)(0),s=Object(c.a)(l,2),u=s[0],m=s[1],d=Object(a.useRef)(),f=e.useInternalState?i:e.expanded,p=Object(a.useCallback)((function(){d.current&&m(f?d.current.getBoundingClientRect().height:0)}),[m,f,d.current]);return Object(a.useEffect)((function(){p()}),[p,e.children]),Object(a.useEffect)((function(){return window.addEventListener("resize",p),function(){return window.removeEventListener("resize",p)}}),[p]),Object(a.useEffect)((function(){for(var e=0,t=Array.from(d.current.children);e<t.length;e++){var n=t[e];"onload"in n&&(n.onload=p);for(var a=0,r=Array.from(n.children);a<r.length;a++){var i=r[a];"onload"in i&&(i.onload=p)}}}),[d.current,p]),r.a.createElement("div",{className:ee.a.sectionContainer,style:e.style},r.a.createElement("div",{className:[ee.a.sectionHeader,"topBanner"].join(" ")},r.a.createElement("div",{className:ee.a.sectionHeaderText,onClick:function(){return e.useInternalState?o(!f):e.setExpanded(!f,e.value)}},e.header),e.children?r.a.createElement("div",{className:ee.a.sectionToggle,onClick:function(){return e.useInternalState?o(!f):e.setExpanded(!f,e.value)}},r.a.createElement(K.a,{style:{transform:f?"rotate(-90deg)":"rotate(0deg)"}})):null),r.a.createElement("div",{className:[ee.a.sectionListWrapper,f?ee.a.expanded:""].join(" "),style:{height:u}},r.a.createElement("div",{ref:d,className:[ee.a.sectionList].join(" "),id:e.id},e.children)))}function De(e){return r.a.createElement("div",{className:[ee.a.tabSection].join(" "),style:{gridAutoColumns:e.static?"1fr":void 0}},Object.entries(e.nameDict).map((function(t,n){var a=Object(c.a)(t,2),i=a[0],o=a[1];return o?r.a.createElement("div",{key:[i,n].join("."),onClick:function(){return e.setName(i)},className:[ee.a.tab,i===e.name?ee.a.active:""].join(" ")},o):null})))}function Be(e){var t=Object(a.useMemo)((function(){return e}),[e]),n=t.round,i=t.setPlayers,o=t.players,u=Object(a.useCallback)((function(t){return C({url:"/tournament/"+e.id+"/fetchPlayer",params:{id:t}}).then((function(t){return e.setPlayerDict({player:t}),t}))}),[e.id,e.setPlayerDict]),d=Object(a.useCallback)((function(t){var n=t.target;if("HTMLButtonElement"===n.constructor.name){var a=n.parentNode.id;x({url:"/tournament/"+e.id+"/activatePlayer",data:{id:a}}).then((function(){return u(a)})).catch(console.error)}}),[e.id,u]),f=Object(a.useCallback)((function(t){var n=t.target;if("HTMLButtonElement"===n.constructor.name){var a=n.parentNode.id;x({url:"/tournament/"+e.id+"/clearPlayer",data:{id:a}}).then((function(t){"inactive"===t?u(a):e.setPlayerDict({id:a})})).catch(console.error)}}),[u,e.id]),p=Object(a.useMemo)((function(){return"individual"===e.settings.competitors}),[e.settings.competitors]);function b(t){var i=Object(a.useState)(!1),o=Object(c.a)(i,2),b=o[0],g=o[1],v=Object(a.useState)(t.player),y=Object(c.a)(v,2),h=y[0],E=y[1];return b?r.a.createElement(We,{id:e.id,settings:e.settings,player:h,close:function(){return g(!1)},onSubmit:function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",P(t).then(Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(h.id);case 2:t=e.sent,E(t),g(!1);case 5:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),action:m.a.resolve(k,["tournament",e.id,"editPlayer"].join("/"))}):r.a.createElement(Ke,{player:h,round:n,requireLastName:p,editPlayer:function(){return g(!0)},activatePlayer:d,clearPlayer:f,allowNewPlayers:e.settings.allowNewPlayers,setDisplayPlayer:e.setDisplayPlayer})}var g=Object(a.useMemo)((function(){for(var e=[],t=Object.values(o).reduce((function(e,t){return Math.max(e,Math.max.apply(Math,Object(ae.a)(t.map((function(e){return e.score})))))}),0);t>=0;t-=.5){var n=t.toString();if(o[n]&&o[n].length){var a=r.a.createElement(Re,{key:["sidebar","round",n].join("."),header:n+" points",useInternalState:!0,expanded:!0,id:["container",n].join(".")},o[n].map((function(e){return r.a.createElement(b,{key:e.id,player:e})})));e.push(a)}}return e}),[n,o,e.settings.allowNewPlayers,e.settings]);return Object(a.useEffect)((function(){e.playerDict.size&&i(!1)}),[e.playerDict,i]),Object(a.useEffect)((function(){e.playerDict.size&&i()}),[e.playerDict,e.playerDictKey,e.stateKey]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:[we.a.sidebar,we.a.players].join(" ")},r.a.createElement("div",{className:we.a.stage},r.a.createElement(De,{name:"tournamentPlayers",setName:function(){},nameDict:{tournamentPlayers:"Tournament Players"}}),r.a.createElement("div",{className:["scrollable",we.a.playersSection].join(" ")},g.length?null:r.a.createElement("div",{className:we.a.scoreSection},r.a.createElement("div",{className:we.a.playerLine},r.a.createElement("div",{className:we.a.sectionHeader,style:{gridArea:"firstName / firstName / submit / submit"}},g.length?"Player List":"No players added yet"))),g))))}var Ie=n(135),Te=n.n(Ie),Le=n(353),Me=n.n(Le),Ae=n(354),Fe=n.n(Ae);function Ue(e){return 8*e+650}function Ge(e){var t=Object(a.useMemo)((function(){return"individual"===e.settings.competitors}),[e.settings.competitors]),n=Object(a.useCallback)((function(n){var a=n.clipboardData.getData("text").toString();if(a.trim()&&(a.split("\n").length||!a.split(",").length||!a.split("\t").length)){n.preventDefault();var r=Te.a.parse(a,{delimitersToGuess:[",","\t"],dynamicTyping:!0,fastMode:!0});if(r.data.length>100)return console.error("Can't paste more than 100 players at once!");var i=r.data.map((function(e){var n=Object(c.a)(e,3),r=n[0],i=n[1],o=n[2];if(!t){var l=[].concat(Object(ae.a)(e),[""]);r=l[0],o=l[1],i=l[2]}if(!r||!i&&t||null===o||void 0===o)return null;try{if("string"!==typeof r)throw[r,"string"].join(",");if("string"!==typeof i&&t)throw[i,"string"].join(",");if("number"!==typeof o)throw[o,"number"].join(",");return{firstName:r,lastName:i,rating:o}}catch(u){if(!a.split("\n").length)return null;var s=u.split(",");return console.error(new TypeError("Bad input on row "+e.join(",")+"\n"+s[0]+" is not type "+s[1])),null}})).filter((function(e){return e}));x({url:"tournament/"+e.id+"/appendPlayers",data:i}).then((function(){return Promise.all([e.updatePlayerDict(),e.setPlayers()])}))}}),[e.id,t,e.updatePlayerDict,e.setPlayers]),i=Object(a.useMemo)((function(){for(var t=[],a=0;a<5;a++)t.push(r.a.createElement(We,{key:["newPlayerForm",a].join("."),id:e.id,player:null,settings:e.settings,close:function(){},onSubmit:function(t){return P(t).then((function(){t.target.reset()})).then((function(){return e.updatePlayerDict()}))},handlePaste:a?void 0:n,action:m.a.resolve(k,["tournament",e.id,"appendPlayer"].join("/"))}));return t}),[e.updatePlayerDict,e.id,t,n,e.settings.checkForDuplicatePlayers]);Object(a.useEffect)((function(){e.playerDict.size&&e.setPlayers(!1)}),[e.playerDict,e.setPlayers]),Object(a.useEffect)((function(){e.playerDict.size&&e.setPlayers()}),[e.playerDict,e.playerDictKey,e.stateKey]);var o=Object(a.useContext)(xe),u=Object(a.useState)([]),d=Object(c.a)(u,2),f=d[0],p=d[1],b=Object(a.useCallback)(function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return p([]),e.abrupt("return",[]);case 3:if(!g){e.next=9;break}return e.next=6,Me.a.searchUsers(t,5,!0).catch((function(e){return console.error(e),[]}));case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,C({url:["fetch","ecf","searchUsers"].join("/"),params:{argument:t,nb:5,parse:!0}});case 11:e.t0=e.sent;case 12:return n=e.t0,p(n),e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[p]),v=Object(a.useCallback)((function(e){var t=e;return t?"".concat(t.name," (S:").concat(t.standard.rating,"/R:").concat(t.rapidplay.rating,")\n").concat(t.club):""}),[]),y=Object(a.useCallback)((function(t){var n=f.find((function(e){return e.id===t}));if(!n)return console.error(t,n,f),o({message:r.a.createElement(r.a.Fragment,null,"Couldn't add new player: ",t,r.a.createElement("br",null),"Contact a developer if this problem persists"),type:"error"});var a=n.standard.rating||n.rapidplay.rating,i=[n.firstName,n.middleName].join(" ");x({url:["tournament",e.id,"appendPlayer"].join("/"),data:{firstName:i,lastName:n.lastName,rating:"FIDE"===e.settings.ratingSystem?Ue(a):a,ecf:{id:n.id,firstName:i,lastName:n.lastName,club:n.club,standard:n.standard,rapidplay:n.rapidplay}}}).then(e.updatePlayerDict)}),[f,o,e.id]),h=Object(a.useState)([]),E=Object(c.a)(h,2),j=E[0],_=E[1],O=Object(a.useCallback)(function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return _([]),e.abrupt("return",[]);case 3:if(!g){e.next=9;break}return e.next=6,Fe.a.search(t,{nb:5}).catch((function(e){return console.error(e),[]}));case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,C({url:["fetch","fide","search"].join("/"),params:{argument:t,nb:5}});case 11:e.t0=e.sent;case 12:return n=e.t0,_(n),e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[_]),N=Object(a.useCallback)((function(e){var t=e;return t?"".concat(t.Name," (S:").concat(t["Std."],"/R:").concat(t["Rpd."],"/B:").concat(t["Blz."],") [").concat(t["B-Year"],"]"):""}),[]),S=Object(a.useCallback)((function(t){var n=j.find((function(e){return e.id===t}));if(!n)return console.error(t,n,j),o({message:r.a.createElement(r.a.Fragment,null,"Couldn't add new player: ",t,r.a.createElement("br",null),"Contact a developer if this problem persists"),type:"error"});var a,i=n["Std."]||n["Rpd."]||n["Blz."],l=n.Name.split(", "),s=Object(c.a)(l,2),u=s[0],m=s[1];x({url:["tournament",e.id,"appendPlayer"].join("/"),data:{firstName:m,lastName:u,rating:"ECF"===e.settings.ratingSystem?(a=i,Math.round((a-650)/8)):i,fide:{id:n.id,firstName:m,lastName:u,bYear:n["B-Year"],federation:n.Fed}}}).then(e.updatePlayerDict)}),[j,o,e.id]),w=Object(a.useState)("ECF"),R=Object(c.a)(w,2),D=R[0],B=R[1],I=Object(a.useMemo)((function(){switch(D){case"new":return r.a.createElement("div",{className:["scrollable",we.a.playersSection].join(" ")},r.a.createElement("div",{className:we.a.scoreSection},i));case"ECF":return r.a.createElement(te,{onInput:b,onSubmit:y,getName:v,showHistory:!1,styles:we.a,placeholder:"Last name, First name",limit:5});case"FIDE":return r.a.createElement(te,{onInput:O,onSubmit:S,getName:N,showHistory:!1,styles:we.a,placeholder:"Name or FIDE ID",limit:5});default:return null}}),[D,b,y,v,O,S,N]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:[we.a.sidebar,we.a.newPlayers].join(" ")},r.a.createElement("div",{className:we.a.stage},r.a.createElement(De,{name:D,setName:B,nameDict:{new:r.a.createElement(r.a.Fragment,null,r.a.createElement(K.t,null),r.a.createElement("div",null,"New")),ECF:r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:me.a,alt:"",style:{height:"1em",filter:"invert(0.5)"}}),r.a.createElement("div",null,"ECF")),FIDE:r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:fe.a,alt:"",style:{height:"1em"}}),r.a.createElement("div",null,"FIDE"))},static:!0}),I)))}function He(e){Object(a.useCallback)(Object(s.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x({url:["tournament",e.id,"syncScoresFromResults"].join("/")});case 2:return t.next=4,e.updatePlayerDict;case 4:case"end":return t.stop()}}),t)}))),[e.id,e.updatePlayerDict]);var t=Object(a.useCallback)(Object(s.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x({url:"/tournament/"+e.id+"/clearPlayers"}).catch(console.error);case 2:e.checkIfEnoughPlayers();case 3:case"end":return t.stop()}}),t)}))),[e.id,e.checkIfEnoughPlayers]),n=Object(a.useCallback)(Object(s.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0===e.round){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t();case 4:e.updatePlayerDict();case 5:case"end":return n.stop()}}),n)}))),[t,e.updatePlayerDict,e.round]);return r.a.createElement("div",{className:["bottomBannerBackground",we.a.bottomBanner].join(" ")},r.a.createElement("div",{className:"bottomBanner"},function(){for(var e=[],t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];for(var i=0,o=n;i<o.length;i++){var l=o[i];if(l){var s=Object(c.a)(l,3),u=s[0],m=s[1],d=s[2];e.push(r.a.createElement("div",{key:["button",d.toLowerCase()].join("."),onClick:u,className:"button"},m," ",d))}}return e}([function(){return e.updateSetting("allowNewPlayers",!e.settings.allowNewPlayers)},r.a.createElement(K.j,{key:"edit"}),e.round?"Edit":"New"],[e.togglePasteInput,r.a.createElement(K.m,{key:"import"}),"Smart Import"],e.round||!Array.from(e.playerDict.keys()).length?null:[n,r.a.createElement(K.y,{key:"close"}),"Clear all"])))}function Ve(e){var t=Object(a.useState)(0),n=Object(c.a)(t,2),i=n[0],o=n[1],u=Object(a.useState)({}),m=Object(c.a)(u,2),d=m[0],f=m[1],p=Object(a.useState)({}),b=Object(c.a)(p,2),g=b[0],v=b[1],y=Object(a.useMemo)((function(){return!i||!!e.settings.allowNewPlayers}),[i,e.settings.allowNewPlayers]),h=Object(a.useCallback)((function(){return e.id?C({url:"/tournament/"+e.id+"/getState",params:{key:e.stateKey}}).then((function(e){var t=e.round,n=e.players;return v(n),o(t),n})):Promise.resolve({})}),[e.id,v,o]),E=Object(a.useCallback)(function(){var t=Object(s.a)(l.a.mark((function t(n){var a,r,i,o,s,u,m;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===n){t.next=6;break}return t.next=3,h();case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=g;case 7:if(a=t.t0){t.next=10;break}return t.abrupt("return",Promise.resolve());case 10:for(r={},i=0,o=Object.entries(a);i<o.length;i++)s=Object(c.a)(o[i],2),u=s[0],m=s[1],r[u]=m.map((function(t){return e.playerDict.get(t)})).filter((function(e){return e}));f(r),e.checkIfEnoughPlayers(!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[h,e.playerDict,e.checkIfEnoughPlayers,g,e.stateKey]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Be,Object.assign({},e,{round:i,setPlayers:E,players:d})),y?r.a.createElement(Ge,Object.assign({},e,{setPlayers:E})):null,r.a.createElement(He,Object.assign({},e,{round:i})))}function Ke(e){var t=e.requireLastName?[e.player.firstName,e.player.lastName].join(" "):e.player.firstName;return"number"!==typeof e.player.rating?null:r.a.createElement("div",{id:e.player.id,className:we.a.playerLine},r.a.createElement("div",{className:["playerInfo",we.a.playerInfo,e.player.active?"":we.a.playerInactive,e.player.isPlaying?"bold":""].join(" "),style:{gridColumn:e.round&&!e.allowNewPlayers?"1 / span 3":void 0},onClick:function(t){return e.setDisplayPlayer(t.target.parentElement.id)}},t," (",e.player.rating.toString(),") ",e.player.histories[e.round]?"":"*"),e.round&&!e.allowNewPlayers?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{name:"edit",className:we.a.edit,onClick:e.editPlayer},r.a.createElement(K.r,null)),e.player.active?r.a.createElement("button",{name:"cancel",className:we.a.cancel,onClick:e.clearPlayer},r.a.createElement(K.y,null)):r.a.createElement("button",{name:"active",className:we.a.activate,onClick:e.activatePlayer},r.a.createElement(K.f,null))))}function We(e){var t,n,i,o,l=Object(a.createRef)(),s=Object(a.useRef)(),u=Object(a.useState)(!1),m=Object(c.a)(u,2),d=m[0],f=m[1],p=Object(a.useState)(void 0),b=Object(c.a)(p,2),g=b[0],v=b[1];Object(a.useEffect)((function(){(d||e.player)&&l.current&&l.current.focus()}),[l,e.player]);var y=Object(a.useCallback)((function(e){h(e);var t=s.current;if(t){var n=Array.from(t.querySelectorAll("input")).filter((function(e){return e.required}));n.every((function(e){return""===e.value}))?v(void 0):n.every((function(e){return e.checkValidity()}))?v(!0):v(!1)}}),[]),h=Object(a.useCallback)((function(t){switch(t.keyCode){case 27:return e.close();case 13:if(!s.current)return;s.current.requestSubmit()}}),[e.close]),E=Object(a.useContext)(xe);return r.a.createElement("form",{ref:s,target:"_self",onKeyDown:y,onSubmit:function(t){return e.onSubmit(t).then((function(){return f(!0)}))},method:"POST",action:e.action,onInput:y},r.a.createElement("div",{className:we.a.playerLine},r.a.createElement("input",{type:"text",className:[we.a.input,e.settings.checkForDuplicatePlayers?"":we.a.striped].join(" "),name:"firstName",required:!0,ref:l,placeholder:e.player?void 0:"individual"===e.settings.competitors?"First name":"Team name",defaultValue:null===(t=e.player)||void 0===t?void 0:t.firstName,onPaste:e.handlePaste,style:{gridArea:"individual"===e.settings.competitors?"firstName":"firstName / firstName / lastName / lastName"}}),r.a.createElement("input",{type:"text",className:we.a.input,name:"lastName",required:"individual"===e.settings.competitors,placeholder:e.player?void 0:"Last name",defaultValue:null===(n=e.player)||void 0===n?void 0:n.lastName,style:{gridArea:"lastName",display:"individual"===e.settings.competitors?"block":"none"}}),r.a.createElement("input",{type:"number",className:we.a.input,min:0,max:3200,name:"rating",required:!0,placeholder:e.player?void 0:"individual"===e.settings.competitors?"Rating":"Av. Rating",defaultValue:null===(i=e.player)||void 0===i?void 0:i.rating,style:{gridArea:"edit"}}),r.a.createElement("input",{type:"hidden",name:"id",value:null===(o=e.player)||void 0===o?void 0:o.id}),void 0===g?r.a.createElement("button",{tabIndex:-1,className:[we.a.info].join(" "),onClick:function(e){E({title:"How do I add new players?",message:r.a.createElement(r.a.Fragment,null,"Type in your players to get started.",r.a.createElement("ul",null,r.a.createElement("li",null,"If entering individuals, just write name and rating in the boxes!"),r.a.createElement("li",null,"If entering teams, select Tournament type 'Team' in settings."),r.a.createElement("li",null,"If entering usernames, currently select Tournament type 'Team' in settings. Support for usernames will be added later."),r.a.createElement("li",null,"You can also add players via the 'ECF' tab"),r.a.createElement("li",null,"You can also paste names in by copying your data from an Excel spreadsheet (or any CSV location) and pasting it in the ",r.a.createElement("span",{className:"bold"},"top left")," box of this section. It ",r.a.createElement("span",{className:"bold"},"MUST")," be in the format ",r.a.createElement("span",{className:"code"},"firstName, lastName, rating")," for each entry (or 3 Excel columns, where the first is firstName, second is lastName, and third is Rating). If in team mode, then the format takes only 2 columns. Format for a more user-friendly paste feature is coming soon.")),"Once you have enough players begin your tournament!"),type:"info"}),e.preventDefault()}},r.a.createElement(K.p,null)):!0===g?r.a.createElement("button",{tabIndex:-1,className:[we.a.submit].join(" ")},r.a.createElement(K.f,null)):r.a.createElement("button",{tabIndex:-1,className:[we.a.cancel].join(" "),onClick:function(e){s.current.reset(),e.preventDefault()}},r.a.createElement(K.y,null))))}var ze=n(4),qe=n.n(ze);function Ye(e){var t=Object(a.createRef)(),n=Object(a.useState)(!1),i=Object(c.a)(n,2),o=i[0],l=i[1];Object(a.useEffect)((function(){o&&t.current&&t.current.focus()}),[t,o]);var s=Object(a.useCallback)((function(t){var n=t.target,a=n.value;if(a.trim()){var r=a.length,i=e.players.filter((function(t){return t.id!==e.player.id&&e.getDisplayName(t.id).toLowerCase().startsWith(a.toLowerCase())}))[0];if(i){var o=e.getDisplayName(i.id);n.value=o,n.select(),n.setSelectionRange(r,o.length,"forward")}}}),[e.players]);return r.a.createElement("form",{target:"_self",onSubmit:function(t){return e.onSubmit(t).then((function(){return l(!0)}))},method:"POST",action:e.action},r.a.createElement("div",{className:qe.a.scoreSection},r.a.createElement("input",{type:"text",className:[we.a.input,qe.a.input].join(" "),name:"oppName",required:!0,placeholder:"Opponent name",onInput:s,autoComplete:"off",style:{gridArea:"round / round / GP / GP"}}),r.a.createElement("button",{tabIndex:-1,className:we.a.submit,style:{gridArea:"submit"}},r.a.createElement(Oe.b,null))))}function Je(e){var t=e.requireLastName?[e.player.firstName,e.player.lastName].join(" "):e.player.firstName;return r.a.createElement("div",{id:e.player.id,className:[we.a.playerLine,qe.a.playerLine].join(" ")},r.a.createElement("div",{className:["playerInfo"].join(" "),onClick:function(t){return e.setDisplayPlayer(t.target.parentElement.id)}},t),r.a.createElement("button",{name:"cancel",className:[we.a.cancel,qe.a.cancel].join(" "),onClick:e.clearClash},r.a.createElement(Oe.c,null)))}function Xe(e){var t=Object(a.useState)([]),n=Object(c.a)(t,2),i=n[0],o=n[1],u=Object(a.useMemo)((function(){return"individual"===e.settings.competitors}),[e.settings.competitors]),d=Object(a.useContext)(Ce),f=Object(a.useCallback)(Object(s.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.player&&e.player.id){t.next=2;break}return t.abrupt("return");case 2:C({url:"/tournament/"+e.id+"/fetchClashes",params:{id:e.player.id}}).then(o);case 3:case"end":return t.stop()}}),t)}))),[e.id,o,e.player]),p=Object(a.useCallback)(function(){var t=Object(s.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",x({url:"/tournament/"+e.id+"/clearClash",data:{playerId:e.player.id,oppId:n}}).then(f));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.id,e.player,f]),b=Object(a.useMemo)((function(){if(!e.playerDict.size)return null;for(var t=[],n=function(n){var a=e.playerDict.get(i[n][1]);if(!a)return"continue";t.push(r.a.createElement(Je,{key:["clash",n].join("."),player:a,requireLastName:u,clearClash:function(){return p(a.id)},setDisplayPlayer:e.setDisplayPlayer}))},a=0;a<i.length;a++)n(a);return t}),[e.playerDict,e.playerDictKey,i,p,e.setDisplayPlayer,u]);return Object(a.useEffect)((function(){e.settings.allowClashes&&f()}),[f,e.settings.allowClashes]),r.a.createElement(r.a.Fragment,null,b,r.a.createElement(Ye,{id:e.id,getDisplayName:d,onSubmit:function(t){t.preventDefault(),t.persist();var n=t.target,a=e.players.find((function(e){return d(e.id)===n.oppName.value}));return x({data:{playerId:e.player.id,oppId:a.id},url:n.action}).then((function(){t.target.reset()})).then(f)},player:e.player,players:e.players,action:m.a.resolve(k,["tournament",e.id,"createClash"].join("/"))}))}function Ze(e){var t=Object(a.useState)([]),n=Object(c.a)(t,2),i=n[0],o=n[1],u=Object(a.useCallback)(Object(s.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.player&&e.player.id){t.next=2;break}return t.abrupt("return");case 2:C({url:"/tournament/"+e.id+"/fetchBonuses",params:{id:e.player.id}}).then(o);case 3:case"end":return t.stop()}}),t)}))),[e.id,o,e.player]),d=Object(a.useCallback)(function(){var t=Object(s.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",x({url:"/tournament/"+e.id+"/clearBonus",data:{id:e.player.id,round:n}}).then((function(){u(),e.update(!0)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.id,e.player,u,e.update]),f=r.a.useCallback((function(t){var n=t.bonus,i=t.i,o=Object(a.useState)(!1),l=Object(c.a)(o,2),s=l[0],f=l[1],b=Object(a.useRef)(null),g=Object(a.useCallback)((function(e){switch(e.keyCode){case 27:return f(!1);case 13:var t=b.current;if(!t)return;t.requestSubmit(),e.preventDefault()}}),[f]);return s?r.a.createElement("form",{ref:b,target:"_self",onSubmit:function(t){t.persist(),t.preventDefault(),P(t).then((function(){t.target.reset()})).then((function(){u(),e.update(!0)}))},onKeyDown:g,method:"POST",action:m.a.resolve(k,["tournament",e.id,"updateBonus"].join("/"))},r.a.createElement("div",{className:[qe.a.scoreSection,"match"===e.settings.displayPoints?qe.a.matchOnly:""].join(" ")},r.a.createElement("input",{type:"hidden",name:"id",value:e.player.id}),r.a.createElement("input",{type:"hidden",name:"round",value:n.round}),r.a.createElement("div",{className:["fieldBox"].join(" "),style:{gridArea:"round"}},"Round: ",n.round),r.a.createElement("input",{type:"number",className:[we.a.input,qe.a.input].join(" "),name:"MP",placeholder:"MP",defaultValue:n.MP,onFocus:function(e){return p(e,1)},style:{gridArea:"MP"},step:.25}),"game"===e.settings.displayPoints?r.a.createElement("input",{type:"number",className:[we.a.input,qe.a.input].join(" "),name:"GP",placeholder:"GP",defaultValue:n.GP,onFocus:function(t){return p(t,e.settings.gamePointTotal)},style:{gridArea:"GP"},step:.25}):null,r.a.createElement("button",{tabIndex:-1,className:we.a.submit,style:{gridArea:"submit"}},r.a.createElement(Oe.b,null)))):r.a.createElement("div",{id:e.player.id,className:[qe.a.resultsRow,qe.a.bonusRow,"match"===e.settings.displayPoints?qe.a.matchOnly:""].join(" "),key:["row","bonus",i].join(".")},r.a.createElement("div",{className:["fieldBox"].join(" "),style:{gridArea:"round"}},"Round: ",n.round),r.a.createElement("div",{className:["fieldBox"].join(" "),style:{gridArea:"MP"}},"MP: ",null!==n.MP?n.MP.toFixed(1):null),"game"===e.settings.displayPoints?r.a.createElement("div",{className:["fieldBox"].join(" "),style:{gridArea:"GP"}},"GP: ",null!==n.GP?n.GP.toFixed(1):null):null,r.a.createElement("button",{name:"edit",className:we.a.edit,onClick:function(){return f(!0)},style:{gridArea:"edit"}},r.a.createElement(Oe.a,null)),r.a.createElement("button",{name:"cancel",className:we.a.cancel,onClick:function(){return d(Number(n.round))},style:{gridArea:"submit"}},r.a.createElement(Oe.c,null)))}),[i,d,e.settings.displayPoints,u]);Object(a.useEffect)((function(){e.settings.allowClashes&&u()}),[u,e.settings.allowClashes]);var p=Object(a.useCallback)((function(e,t){var n=e.target;n&&(n.value||(n.defaultValue=t.toString(),n.select()))}),[]);return r.a.createElement(r.a.Fragment,null,i.map((function(e,t){return r.a.createElement(f,{key:["bonus",t].join(" "),bonus:e,i:t})})),r.a.createElement("form",{target:"_self",onSubmit:function(t){t.persist(),t.preventDefault(),P(t).then((function(){t.target.reset()})).then((function(){u(),e.update(!0)}))},method:"POST",action:m.a.resolve(k,["tournament",e.id,"createBonus"].join("/"))},r.a.createElement("div",{className:[qe.a.scoreSection,"match"===e.settings.displayPoints?qe.a.matchOnly:""].join(" ")},r.a.createElement("input",{type:"hidden",name:"id",value:e.player.id}),r.a.createElement("input",{type:"number",className:[we.a.input,qe.a.input].join(" "),name:"round",required:!0,placeholder:"Round",onFocus:function(t){return p(t,e.status.round)},autoComplete:"off",min:1,max:e.settings.totalRounds,style:{gridArea:"round"}}),r.a.createElement("input",{type:"number",className:[we.a.input,qe.a.input].join(" "),name:"MP",placeholder:"MP",onFocus:function(e){return p(e,1)},style:{gridArea:"MP"},step:.25}),"game"===e.settings.displayPoints?r.a.createElement("input",{type:"number",className:[we.a.input,qe.a.input].join(" "),name:"GP",placeholder:"GP",onFocus:function(t){return p(t,e.settings.gamePointTotal)},style:{gridArea:"GP"},step:.25}):null,r.a.createElement("button",{tabIndex:-1,className:we.a.submit,style:{gridArea:"submit"}},r.a.createElement(Oe.b,null)))))}var Qe=n(78),$e=Object.entries(Qe).map((function(e){var t=Object(c.a)(e,2),n=t[0];return{name:t[1],id:n}}));function et(e){var t=Object(a.useState)(""),n=Object(c.a)(t,2),i=n[0],o=n[1],l=Object(a.useState)(null),s=Object(c.a)(l,2),u=s[0],m=s[1],d=Object(a.useMemo)((function(){return Array.from(e.playerDict.values())}),[e.playerDict,e.playerDictKey]),f=Object(a.useContext)(Ce),p=function(t){if(o(i),e.playerID)return!1!==t?C({url:"/tournament/"+e.id+"/fetchPlayer",params:{id:e.playerID}}).then((function(n){n.histories[0]||(n.histories[0]=null),m(n),t&&e.modifyPlayerDict(n,Math.random().toString().slice(2,9))})):void m(e.playerDict.get(e.playerID));m(null)};Object(a.useEffect)((function(){p()}),[e.playerID,e.playerDictKey]);var b=Object(a.useCallback)((function(t,n,a,i){var o=Object(c.a)(t,2),l=o[0],s=o[1];return"Playing"===l&&s?r.a.createElement("div",{className:qe.a.row,key:["row",n].join(".")},r.a.createElement("div",{className:"fieldBox"},l+":"),r.a.createElement("div",{className:"playerInfo",id:s,onClick:function(t){return e.setDisplayPlayer(t.target.id)}},f(s))):r.a.createElement("div",{className:qe.a.row,key:["row",n].join(".")},r.a.createElement("div",{className:"fieldBox"},(i?Ee(l.trim()):l)+":"),r.a.isValidElement(s)?s:r.a.createElement("div",{className:"fieldBox"},null!==s&&""!==s?s:"\u200b"))}),[e.setDisplayPlayer,f]);if(!u)return r.a.createElement("div",{className:qe.a.profileContainer},r.a.createElement(te,{onSubmit:e.setDisplayPlayer,options:Array.from(e.playerDict.values()),getName:function(e){return f(e)},showHistory:!0,styles:qe.a}));var g=u?{"Unique ID":u.id,Status:!1!==u.active?"Active":"Inactive",Rating:u.rating,Nationality:r.a.createElement(ne,{content:u.nationality,url:["tournament",e.status.id,"updatePlayer"].join("/"),inputType:"text",onSubmitSuccess:function(e){return p(!0),e},additionalStyles:{editableField:"fieldBox"},name:"nationality",additionalInputProps:{id:u.id},show:{submit:!0},search:{options:$e,getName:function(e){return e.name}}}),"Performance rating":u.performanceRating,Playing:u.isPlaying}:{},v=u.histories,y=(Math.max(u.histories.length,1)-1-(u.isPlaying?1:0)).toString(),h=u.histories.reduce((function(e,t){return t?e+=t.played:e}),0),E=u?{Score:u.score.toString()+" / "+y,"Game score":u.gamePoints.toString()+" / "+h.toString(),"Expected score":u.expectedScore.toFixed(2),"Expected game score":u.expectedGameScore.toFixed(2)+" / "+h}:{};return e.settings.displayPoints||(delete E["Game score"],delete E["Expected game score"]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:[qe.a.profileContainer,"scrollable"].join(" ")},r.a.createElement("div",null,r.a.createElement("div",{className:qe.a.infoSection},r.a.createElement("div",{className:qe.a.row},r.a.createElement("div",{style:{gridRow:"1 / span 1",gridColumn:"1 / span 2"},className:["playerInfo",qe.a.name].join(" "),id:u.id,onClick:function(t){return e.setDisplayPlayer(t.target.id)}},f(u))),Object.entries(g).map(b))),r.a.createElement(Re,{header:"Contact",useInternalState:!0,style:{gridColumn:"1 / span 2"}},Object.entries(u.contact).map((function(e,t,n){return b(e,t,n,!0)}))),r.a.createElement(Re,{header:"Information",useInternalState:!0,style:{gridColumn:"1 / span 2"}},Object.entries(u.meta).map((function(e,t,n){return b(e,t,n,!0)}))),r.a.createElement(Re,{header:"Score",useInternalState:!0,style:{gridColumn:"1 / span 2"}},Object.entries(E).map(b)),e.settings.allowClashes?r.a.createElement(Re,{header:"Forbidden Pairings",useInternalState:!0,style:{gridColumn:"1 / span 2"}},r.a.createElement(Xe,Object.assign({},e,{players:d,player:u}))):null,r.a.createElement(Re,{header:"Results",useInternalState:!0,style:{gridColumn:"1 / span 2"}},v.map((function(t,n){if(0===n||!t)return null;var a=t.id,i=t.colour,o=t[e.settings.displayPoints];return r.a.createElement("div",{className:qe.a.resultsRow,key:["row","history",n].join(".")},r.a.createElement("div",{className:"fieldBox"},n),r.a.createElement("div",{className:"playerInfo",id:a,onClick:function(t){return e.setDisplayPlayer(t.target.id)}},f(a)),r.a.createElement("div",{className:"fieldBox"},i||"\u200b"),r.a.createElement("div",{className:"fieldBox"},"undefined"!==typeof o&&null!==o?o:"\u200b"))}))),e.settings.allowBonuses?r.a.createElement(Re,{header:"Bonus points",useInternalState:!0,style:{gridColumn:"1 / span 2"}},r.a.createElement(Ze,Object.assign({},e,{players:d,player:u,update:p}))):null),r.a.createElement("div",{className:["button",qe.a.closeButton].join(" "),onClick:function(){return e.setDisplayPlayer("")}},r.a.createElement(Oe.c,null)," Close profile"))}var tt={h2h:{name:"By head-to-head score",func:function(e,t){return t.scoreAgainst(e.id)-e.scoreAgainst(e.id)}},gamePoint:{name:"By game point total",func:function(e,t){return t.gamePoints-e.gamePoints}},gamePointDiff:{name:"By net game points",func:function(e,t){return t.netGamePoint-e.netGamePoint}},whites:{name:"By times played black",func:function(e,t){return e.whiteTotal-t.whiteTotal}},progScore:{name:"By progressive score",func:function(e,t){return t.progressiveScore-e.progressiveScore}},wins:{name:"By most wins",func:function(e,t){return t.histories&&e.histories?t.histories.filter((function(e){return 1===e.match})).length-e.histories.filter((function(e){return 1===e.match})).length:0}},gameh2h:{name:"By head-to-head of game points",func:function(e,t){return t.gameScoreAgainst(e.id)-e.gameScoreAgainst(e.id)}},perfRating:{name:"By performance rating",func:function(e,t){return t.performanceRating-e.performanceRating}},rating:{name:"By rating",func:function(e,t){return t.rating-e.rating}},oppRating:{name:"By average rating cut",func:function(e,t){var n,a;if(t.oppRatingSum!==e.oppRatingSum)return t.oppRatingSum-e.oppRatingSum;var r=null===(n=e.histories)||void 0===n?void 0:n.filter((function(e){return e})),i=null===(a=t.histories)||void 0===a?void 0:a.filter((function(e){return e}));if(!r||!i||!r.length||!i.length)return 0;for(var o=r.sort((function(e,t){return e.oppRating-t.oppRating})),l=i.sort((function(e,t){return e.oppRating-t.oppRating}));;){var s=[o.shift(),l.shift()],c=s[0],u=s[1];if(void 0==c||void 0===u)break;if(c||u){var m=o.reduce((function(e,t){return t?e+=t.oppRating:e}),0)/o.length,d=l.reduce((function(e,t){return t?e+=t.oppRating:e}),0)/l.length;if(m!==d)return d-m}}return 0}},alphabetical:{name:"Alphabetical",func:function(e,t){return t.firstName>e.firstName?-1:e.firstName>t.firstName?1:0}}};function nt(e){return e?"On":!1===e?"Off":""}var at={general:{tournamentId:{name:"Unique ID",type:"string",locked:!0,primaryKey:!0},status:{name:"Status",enum:["uninitialised","active","finished"],convert:Ee,defaultValue:"uninitialised",value:function(e){return e.round?!1===e.active?"finished":"active":"uninitialised"}},pairingSystem:{name:"Pairing system",enum:["swiss","round-robin"],convert:Ee,lockOnInit:!0,defaultValue:"swiss"},competitors:{name:"Tournament type",enum:["individual","team"],convert:Ee,lockOnInit:!0,defaultValue:"individual"},totalRounds:{name:"Total rounds",convert:function(e){return"Infinity"===e?"\u221e":e.toString()},type:"number",defaultValue:1/0,lockWhen:{pairingSystem:"round-robin"},nb:{min:1,max:100},allow:{infinity:!0}},ratingSystem:{name:"Rating system",enum:["ECF","FIDE","USCF"],lockOnInit:!0,defaultValue:"ECF"},displayPoints:{name:"Games per pairing",convert:function(e){return"match"===e?"Just One":"Multiple"},enum:["match","game"],defaultValue:"match"},gamePointTotal:{name:"Number of games per pairing",type:"number",defaultValue:1,show:{displayPoints:"game"},lockOnInit:!0,nb:{step:1,min:1},allow:{any:!0},highlight:!0,linked:"byeGameReward"},public:{name:"Public",convert:nt,lockOnInit:!1,type:"boolean",defaultValue:!1,level:1},tieBreaks:{name:"Tie Breaks",convert:function(){return""},type:"string",defaultValue:null,validate:function(e){var t,n=e.split(","),a=Object(X.a)(n);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(!(r in tt))throw"Invalid tiebreak '".concat(r,"'")}}catch(i){a.e(i)}finally{a.f()}return!0},hidden:!0}},permissions:{allowNewPlayers:{name:"Mid-way joining?",convert:nt,lockOnInit:!1,type:"boolean",defaultValue:!0,hidden:!0},checkForDuplicatePlayers:{name:"Check for duplicate players?",convert:nt,lockOnInit:!1,type:"boolean",defaultValue:!0,show:{allowNewPlayers:!0,pairingSystem:"swiss"},highlight:!0},allowSelfSubmissions:{name:"User submissions?",convert:nt,lockOnInit:!1,type:"boolean",defaultValue:!0,hidden:!0},allowClashes:{name:"Forbid certain pairings?",convert:nt,lockOnInit:!1,type:"boolean",defaultValue:!0,show:{pairingSystem:"swiss"}},allowBonuses:{name:"Input score bonuses for players?",convert:nt,lockOnInit:!1,type:"boolean",defaultValue:!0}},points:{lossReward:{name:"Points on loss",lockOnInit:!0,type:"number",defaultValue:0,nb:{step:.1}},drawReward:{name:"Points on draw",lockOnInit:!0,type:"number",defaultValue:.5,nb:{step:.1}},winReward:{name:"Points on win",lockOnInit:!0,type:"number",defaultValue:1,nb:{step:.1}},byeReward:{name:"Bye reward",enum:["win","draw","loss"],lockOnInit:!0,defaultValue:"win"},byeGameReward:{name:"Bye reward in game points",type:"number",lockOnInit:!1,defaultValue:1,show:{displayPoints:"game"},nb:{min:0},highlight:!0},performanceSystem:{name:"Performance rating",enum:["ELO","FIDE"],lockOnInit:!1,defaultValue:"ELO"}},stats:{nbPlayers:{name:"Number of players",type:"number",defaultValue:0,value:function(e,t){return t.length},convert:function(e){return e.toString()}},activePlayers:{name:"Active players",type:"number",defaultValue:0,value:function(e,t){return t.filter((function(e){return e.active})).length},convert:function(e){return e.toString()}},matchesPlayed:{name:"Matches played",type:"number",defaultValue:0,value:function(e,t){return t.reduce((function(e,t){return e+t.played}),0)/2},convert:function(e){return e.toString()}},gamesPlayed:{name:"Games played",type:"number",defaultValue:0,value:function(e,t){return t.reduce((function(e,t){return e+t.histories.reduce((function(e,t){return t?e+=t.played:e}),0)}),0)/2},convert:function(e){return e.toString()}},averageRating:{name:"Average rating",type:"number",defaultValue:1200,value:function(e,t){var n=t.reduce((function(e,t){return e+t.rating}),0);return Math.round(n/t.length)},convert:function(e){return e.toString()}},createdAt:{name:"Created at",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0},updatedAt:{name:"Last updated",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0}},public:{vanityURL:{name:"Custom ID",type:"string",defaultValue:"",action:"updateVanityURL",level:2},url:{name:"URL",type:"link",defaultValue:"",value:function(e,t,n){return"".concat(w,"tournament/").concat(n.vanityURL||e.id).trim()},level:2},timeControl:{name:"Time control",type:"string",defaultValue:"",level:2},location:{name:"Location",type:"string",defaultValue:"",level:2},profileURL:{name:"Link to website",type:"string",level:2},rulesURL:{name:"Link to rules",type:"string",level:2},logoURL:{name:"Link to profile picture",type:"string",level:2},streamURL:{name:"Stream link",type:"string",level:2},showRatings:{name:"Show ratings",convert:nt,type:"boolean",defaultValue:!0,level:1},roundTimes:{name:"Show round times",convert:nt,type:"boolean",defaultValue:!0,locked:!1,level:1}}},rt=n(355);function it(e){var t=Object(a.useState)(-1),n=Object(c.a)(t,2),i=n[0],o=n[1],l=Object(a.useState)(-1),s=Object(c.a)(l,2),u=s[0],m=s[1],d=Object(a.useState)(0),f=Object(c.a)(d,2),p=f[0],b=f[1],g=Object(a.useState)([]),v=Object(c.a)(g,2),y=v[0],h=v[1],E=Object(a.useMemo)((function(){return e.children.map((function(e){return e.props.id}))}),[e.children]),j=Object(a.useMemo)((function(){return y.map((function(e){return e.props.id}))}),[y]),_=Object(a.useMemo)((function(){for(var e=0;e<E.length;e++)if(E[e]!==j[e])return!0;return!1}),[E,j]);Object(a.useEffect)((function(){h(e.children)}),[e.children]);var O=Object(a.useCallback)((function(e){var t=e.target;t&&(o(j.indexOf(t.id)),b(e.target.getBoundingClientRect().height))}),[j,b,o]),N=Object(a.useCallback)((function(e){var t=e.target;"last"===t.id?m(j.length):j.indexOf(t.id)===i+1||j.indexOf(t.id)===i?m(-1):m(j.indexOf(t.id))}),[j,p,m,i]),S=Object(a.useCallback)((function(e){if(!(i<0)&&!(u<0)){var t=y[i],n=y[u],a=y.slice(0);a.splice(i,1),a.splice(u===y.length?a.length:a.indexOf(n),0,t),h(a),m(-1),o(-1)}}),[m,o,i,u,y,h]),k=Object(a.useCallback)((function(){h(e.children)}),[h,e.children]),w=Object(a.useCallback)((function(){e.onSubmit(j)}),[e.onSubmit,j]);return r.a.createElement("div",{className:[e.className].join(" ")},y.map((function(e,t){return r.a.createElement("div",{key:["draggable","div",t].join("."),id:e.props.id,className:ee.a.listElement,draggable:!0,onDragStart:O,onDragEnd:S,onDragOver:N,style:{marginTop:u===j.indexOf(e.props.id)&&p?p+10+"px":0}},r.a.createElement("div",{className:[ee.a.number,"fieldBox"].join(" ")},"#",E.indexOf(e.props.id)+1),r.a.cloneElement(e,{}))})),r.a.createElement("div",{className:ee.a.buttonContainer,onDragOver:N,style:{marginTop:u===y.length&&p?p+10+"px":0}},r.a.createElement("div",{className:["fieldBox",ee.a.tbReset].join(" "),id:"last",onDragOver:N,onClick:k,style:{opacity:_?1:0}},r.a.createElement(rt.a,null),"RESET"),r.a.createElement("div",{className:["fieldBox",ee.a.tbSubmit].join(" "),id:"last",onClick:w,style:{visibility:_?"visible":"hidden"}},r.a.createElement(K.u,null),"SAVE")),r.a.createElement("div",null,"\u200b"))}var ot=Object.values(at).reduce((function(e,t){for(var n=0,a=Object.values(t);n<a.length;n++){var r=a[n];r.show&&e.push.apply(e,Object(ae.a)(Object.keys(r.show)))}return e}),[]);function lt(e){var t=Object(a.useState)("general"),n=Object(c.a)(t,2),i=n[0],o=n[1],l=Object(a.useCallback)((function(t,n,a){try{var r;if(a.enum){var i=a.enum.indexOf(n);-1===i&&console.error("Invalid setting value "+t+": "+n);var o=(i+1)%a.enum.length;r=a.enum[o]}else if("boolean"===a.type)r=!n;else if("number"===a.type){if("Infinity"===n||"\u221e"===n?r=1/0:n=Number(n),"totalRounds"===t){if(n<=e.status.round)throw new Error("Can't make total number of rounds less than current round number");if(n!==1/0&&n>=100)throw new Error("Can't make total number of rounds more than 100")}return n}e.updateSetting(t,r,a)}catch(l){l&&l.message&&e.triggerError(l.message)}}),[e.status.round,e.updateSetting,e.triggerError]),s=Object(a.useMemo)((function(){return Object.entries(e.settings).filter((function(e){var t=Object(c.a)(e,1)[0];return ot.includes(t)}))}),[e.settings]);Object(a.useEffect)((function(){!function(){for(var e=0,t=Array.from(document.querySelectorAll("."+[qe.a.sectionListWrapper].join(".")));e<t.length;e++){var n=t[e],a=n.firstElementChild;n.style.height=n.className.includes(qe.a.expanded)?a.getBoundingClientRect().height+"px":"0px"}}()}),[JSON.stringify(s)]);var u=Object(a.useCallback)((function(t,n){var a,i=Object(c.a)(t,2),o=i[0],s=i[1],u=!1;if(s.hidden)u=!0;else if(s.show)for(var f=0,p=Object.entries(s.show);f<p.length;f++){var b=Object(c.a)(p[f],2),g=b[0],v=b[1];if(e.settings[g]!==v){u=!0;break}}if(u)return null;var y=!1;if(s.locked)y=!0;else if(s.lockOnInit&&e.status.round)y=!0;else if(s.lockWhen)for(var h=0,E=Object.entries(s.lockWhen);h<E.length;h++){var j=Object(c.a)(E[h],2),_=j[0],O=j[1];if(e.settings[_]===O){y=!0;break}}var N=null!==(a=e.settings[o])&&void 0!==a?a:s.defaultValue,S=s.convert&&!s.value?s.convert(N):N;return r.a.createElement("div",{className:qe.a.row,key:["row",n].join(".")},r.a.createElement("div",{className:["fieldBox",e.status.active&&s.highlight?qe.a.semiPresent:""].join(" ")},s.name,s.name.endsWith("?")?"":":"),y||!e.status.active||s.value?(s.value&&(S=s.value(e.status,e.players,e.settings)),s.convert&&(S=s.convert(S)),r.a.createElement("div",{style:{cursor:"link"===s.type?"copy":"default"},className:["fieldBox",qe.a.locked].join(" "),onClick:"link"!==s.type?null:function(){return navigator.clipboard.writeText(S)}},"undefined"!==typeof S?S.toString():"\u200b")):"string"===s.type?r.a.createElement(ne,{handleSubmit:function(t,n){return e.updateSetting(t,n,s)},content:S,url:m.a.resolve(k,["tournament",e.status.id,s.action||"updateSetting"].join("/")),inputType:"text",onSubmitSuccess:function(t){return e.updateTournamentSettings(),t},additionalStyles:{editableField:qe.a.editableField,input:qe.a.input},name:o,additionalInputProps:{},show:Object(d.a)({submit:!0},s.allow),useHandleSubmit:!0}):"number"===s.type?r.a.createElement(ne,{handleSubmit:function(t,n){return e.updateSetting(t,n,s)},content:S,url:["tournament",e.status.id,"updateSetting"].join("/"),inputType:"number",onSubmitSuccess:function(t){return e.updateTournamentSettings(),t},additionalStyles:{editableField:qe.a.editableField,input:qe.a.input},name:o,additionalInputProps:s.nb,show:Object(d.a)({submit:!0,increment:!0},s.allow),useHandleSubmit:!0}):r.a.createElement("div",{className:["fieldBox",qe.a.editable].join(" "),onClick:function(){return l(o,N,s)}},"undefined"!==typeof S?S.toString():"\u200b"))}),[e.settings,e.status,e.players,e.updateSetting,e.status.id,e.updateTournamentSettings]),f=Object(a.useMemo)((function(){var t=Object.entries(tt);if(e.settings.tieBreaks){var n=e.settings.tieBreaks.split(",");t=t.sort((function(e,t){return n.indexOf(e[0])-n.indexOf(t[0])}))}return t}),[e.settings.tieBreaks]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:[qe.a.profileContainer,"scrollable"].join(" ")},Object.entries(at).map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return"public"==n?null:r.a.createElement(Re,{key:n,value:n,header:Ee(n),expanded:i===n,setExpanded:function(e,t){return o(e?t:"")}},Object.entries(a).map(u))})),r.a.createElement(Re,{value:"tiebreaks",header:"Tie Breaks",expanded:"tiebreaks"===i,setExpanded:function(e,t){return o(e?t:"")}},r.a.createElement(it,{className:qe.a.tieBreaks,onSubmit:function(t){return e.updateSetting("tieBreaks",t.join(",")).then(e.updateState)}},f.map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{key:n,id:n,className:["fieldBox",qe.a.tb].join(" ")},a.name)})))),r.a.createElement(Pe,null)))}var st=Object.values(at).reduce((function(e,t){for(var n=0,a=Object.values(t);n<a.length;n++){var r=a[n];r.show&&e.push.apply(e,Object(ae.a)(Object.keys(r.show)))}return e}),[]);function ct(e){var t=Object(a.useCallback)((function(t,n,a){try{var r;if(a.enum){var i=a.enum.indexOf(n);-1===i&&console.error("Invalid setting value "+t+": "+n);var o=(i+1)%a.enum.length;r=a.enum[o]}else if("boolean"===a.type)r=!n;else if("number"===a.type){if("Infinity"===n||"\u221e"===n?r=1/0:n=Number(n),"totalRounds"===t){if(n<=e.status.round)throw new Error("Can't make total number of rounds less than current round number");if(n!==1/0&&n>=100)throw new Error("Can't make total number of rounds more than 100")}return n}e.updateSetting(t,r)}catch(l){l&&l.message&&e.triggerError(l.message)}}),[e.status.round,e.updateSetting,e.triggerError]),n=Object(a.useCallback)((function(t){return x({url:"/tournament/"+e.status.id+"/clearRound",data:{round:t}})}),[e.status.id]),i=Object(a.useMemo)((function(){return Object.entries(e.settings).filter((function(e){var t=Object(c.a)(e,1)[0];return st.includes(t)}))}),[e.settings]);Object(a.useEffect)((function(){!function(){for(var e=0,t=Array.from(document.querySelectorAll("."+[qe.a.sectionListWrapper].join(".")));e<t.length;e++){var n=t[e],a=n.firstElementChild;n.style.height=n.className.includes(qe.a.expanded)?a.getBoundingClientRect().height+"px":"0px"}}()}),[JSON.stringify(i)]);for(var o=Object(a.useCallback)((function(t){return r.a.createElement("div",{className:[qe.a.row,qe.a.roundRow].join(" "),key:["row",t].join(".")},r.a.createElement("div",{className:"fieldBox"},"Round ".concat(t,":")),r.a.createElement(ne,{handleClear:function(){return n(t)},content:e.rounds[t]?e.rounds[t].toString():"",defaultEditContent:new Date(Date.now()).toString(),url:m.a.resolve(k,["tournament",e.status.id,"updateRound"].join("/")),inputType:"datetime-local",onSubmitSuccess:function(t){return e.updateRounds(),t},additionalStyles:{editableField:qe.a.editableField,input:qe.a.input},additionalInputProps:{},name:"round."+t.toString(),show:{submit:!0,increment:!1,clear:!0},handleSubmit:function(t,n){if(isNaN(new Date(n).valueOf()))return Promise.reject();var a=t.split(".").pop();return x({url:m.a.resolve(k,["tournament",e.status.id,"updateRound"].join("/")),data:Object(J.a)({},Number(a),new Date(n).toISOString())})},useHandleSubmit:!0}))}),[e.updateSetting,e.rounds,e.status.id,e.updateRounds]),l=Object(a.useCallback)((function(n,a){var i,o=Object(c.a)(n,2),l=o[0],s=o[1],u=!1;if(s.show)for(var f=0,p=Object.entries(s.show);f<p.length;f++){var b=Object(c.a)(p[f],2),g=b[0],v=b[1];e.settings[g]!==v&&(u=!0)}if(u)return null;var y=!1;(s.locked||s.lockOnInit&&e.status.round)&&(y=!0);var h=null!==(i=e.settings[l])&&void 0!==i?i:s.defaultValue,E=s.convert&&!s.value?s.convert(h):h;return r.a.createElement("div",{className:qe.a.row,key:["row",a].join(".")},r.a.createElement("div",{className:["fieldBox",s.show?qe.a.semiPresent:""].join(" ")},s.name,s.name.endsWith("?")?"":":"),y||s.value?(s.value&&(E=s.value(e.status,e.players,e.settings)),s.convert&&(E=s.convert(E)),r.a.createElement("div",{style:{cursor:"link"===s.type?"copy":"default"},className:["fieldBox",qe.a.locked].join(" "),onClick:"link"!==s.type?null:function(){return navigator.clipboard.writeText(E)}},"undefined"!==typeof E?E.toString():"\u200b")):"string"===s.type?r.a.createElement(ne,{handleSubmit:e.updateSetting,content:E,url:m.a.resolve(k,["tournament",e.status.id,s.action||"updateSetting"].join("/")),inputType:"text",onSubmitSuccess:function(t){return e.updateTournamentSettings(),t},additionalStyles:{editableField:qe.a.editableField,input:qe.a.input},name:l,additionalInputProps:{},show:Object(d.a)({submit:!0,clear:!0},s.allow)}):"number"===s.type?r.a.createElement(ne,{handleSubmit:e.updateSetting,content:E,url:m.a.resolve(k,["tournament",e.status.id,"updateSetting"].join("/")),inputType:"number",onSubmitSuccess:function(t){return e.updateTournamentSettings(),t},additionalStyles:{editableField:qe.a.editableField,input:qe.a.input},name:l,additionalInputProps:s.nb,show:Object(d.a)({submit:!0,increment:!0},s.allow)}):r.a.createElement("div",{className:["fieldBox",qe.a.editable].join(" "),onClick:function(){return t(l,h,s)}},"undefined"!==typeof E?E.toString():"\u200b"))}),[e.settings,e.status,e.players,e.updateSetting,e.status.id,e.updateTournamentSettings]),s=[],u=e.settings.totalRounds===1/0||"Infinity"===e.settings.totalRounds?Math.max(e.rounds.length,1):e.settings.totalRounds,f=1;f<=u;f++)s.push(f);var p=at.public;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:[qe.a.profileContainer,"scrollable"].join(" ")},r.a.createElement(Re,{key:"public",value:"public",header:"Information",useInternalState:!0,expanded:!0},Object.entries(p).map(l)),e.settings.roundTimes?r.a.createElement(Re,{key:"rounds",value:"rounds",header:"Rounds",useInternalState:!0,expanded:!0},s.map(o)):null,e.settings.logoURL?r.a.createElement(Re,{key:"profile",value:"profile",header:"Profile",useInternalState:!0,expanded:!0},e.settings.profileURL?r.a.createElement("a",{href:e.settings.profileURL.trim()},r.a.createElement("img",{className:qe.a.profilePicture,src:e.settings.logoURL.trim(),alt:"Invalid image URL"})):r.a.createElement("div",null,r.a.createElement("img",{className:qe.a.profilePicture,src:e.settings.logoURL.trim(),alt:"Invalid image URL"}))):null,r.a.createElement(Pe,null)))}var ut=n(36),mt=n.n(ut),dt={pre:{id:{name:"",className:"blank",sort:!1,value:function(){return 0},postConvert:function(e,t){return(1+t).toString()}},name:{name:"Name",className:"player",id:function(e){return e.id},sort:function(e,t){return e>t?1:e<t?-1:0},value:function(e,t,n){return"individual"===n.competitors?[e.firstName,e.lastName].join(" "):e.firstName}},rating:{name:"Rating",className:"locked",value:function(e){return e.rating},show:function(e,t,n){return n.showRatings}}},roundColumn:{name:function(e,t){return e.slice(-1)},className:function(e,t,n){return"*"===e?"edit":""===e?"unset":"locked"},value:function(){},convert:function(e,t,n){if(""===e)return"";if("*"===e)return"*";var a,r=parseInt(e);return a=.5===r?"\xbd":r.toString(),e.endsWith("b")&&(a+="b"),a},sort:function(e,t){if(e===t)return 0;if(""===e)return-1;if(""===t)return-1;if("*"===e)return 1;if("*"===t)return-1;var n=[parseInt(e),parseInt(t)],a=n[0],r=n[1];return e.endsWith("b")&&(a-=.001),t.endsWith("b")&&(r-=.001),r-a}},post:{score:{name:"MP",className:"locked",value:function(e){return parseFloat(e.score.toString())},convert:function(e,t){return e.toFixed(1)+" / "+t.played}},gamePoints:{name:"GP",className:"locked",value:function(e){return e.gamePoints},convert:function(e){return e.toFixed(1)}},winPercentage:{name:"Win %",className:"rating",value:function(e){return 0===e.played?-1:100*e.score/e.played},convert:function(e){return e<0?"-":e.toFixed()}},performanceRating:{name:"Perf",className:"rating",value:function(e){return e.performanceRating},convert:function(e){return e.toFixed()},show:function(e,t,n){return n.showRatings}},ratingDifference:{name:"P. +/-",className:"rating",value:function(e){return e.performanceRating?e.performanceRating-e.rating:0},convert:function(e){return e?e>0?"+"+e.toString():e.toString():""},show:function(e,t,n){return n.showRatings}},expectedScore:{name:"Expected",className:"rating",value:function(e){return e.expectedScore},convert:function(e,t){return e.toFixed(1)+" / "+t.played},show:function(e,t,n){return n.showRatings}},expectedDifference:{name:"E. +/-",className:"rating",value:function(e){return e.score-e.expectedScore},convert:function(e){return"undefined"===typeof e?"":e>0?"+"+e.toFixed(2):e.toFixed(2)},show:function(e,t,n){return n.showRatings}}}};function ft(e){var t=Object(a.useMemo)((function(){return e.status.round>e.settings.totalRounds||"Infinity"===e.settings.totalRounds?e.status.round:e.settings.totalRounds}),[e.status.round,e.settings.totalRounds]),n=Object(a.useMemo)((function(){for(var e=[],n=1;n<=t;n++)e.push("round."+n.toString());return e}),[t]),i=Object(a.useMemo)((function(){return[].concat(Object(ae.a)(Object.keys(dt.pre)),Object(ae.a)(n),Object(ae.a)(Object.keys(dt.post)))}),[n]).filter((function(t,n){var a=dt.pre[t]||dt.post[t];return!a||!(a.show&&!a.show(null,n,e.settings))})),o=Object(a.useCallback)((function(e,t){return i.includes(t)?e[0]!==t?[t,0]:[t,e[1]+1]:["",0]}),[i]),l=Object(a.useReducer)(o,["score",0]),s=Object(c.a)(l,2),u=s[0],m=s[1],d=Object(a.useCallback)((function(n){for(var a=[""],r=1;r<=t;r++)n.histories[r]?(null===n.histories[r].match?a[r]="*":a[r]=n.histories[r].match.toString(),"bye"===n.histories[r].id&&(a[r]+="b")):r===e.status.round?a[r]="*":a[r]="";return a.slice(1)}),[t,e.status.round]),f=Object(a.useMemo)((function(){for(var t=[],n=function(n){for(var a=e.players[n],r=[],i=0,o=Object.entries(dt.pre);i<o.length;i++){var l=Object(c.a)(o[i],2),s=(l[0],l[1]);s.show&&!s.show(a,n,e.settings)||r.push([s.value(a,n,e.settings),s,a])}for(var u=d(a).map((function(e){return[e,dt.roundColumn,a]})),m=[],f=0,p=Object.entries(dt.post);f<p.length;f++){var b=Object(c.a)(p[f],2),g=(b[0],b[1]);g.show&&!g.show(a,n,e.settings)||m.push([g.value(a,n,e.settings),g,a])}var v=[].concat(r,Object(ae.a)(u),m);t.push(v)},a=0;a<e.players.length;a++)n(a);var o=function(e,t){return t-e},l=u[0].startsWith("round")?dt.roundColumn:dt.pre[u[0]]||dt.post[u[0]];if(l&&!1!==l.sort){l.sort&&(o=l.sort);var s=i.indexOf(u[0]);t=t.sort((function(e,t){return u[1]%2?o(t[s][0],e[s][0]):o(e[s][0],t[s][0])}))}return t.map((function(t,n){return r.a.createElement("tr",{key:"row."+n,className:mt.a.tr},t.map((function(t,a){var i=Object(c.a)(t,3),o=i[0],l=i[1],s=i[2],u=o?o.toString():"";l.convert?u=l.convert(o,s,e.settings):l.postConvert&&(u=l.postConvert(u,n)),"undefined"!==typeof u&&""!==u||(u="\u200b");var m="function"===typeof l.className?l.className(u,a,e.settings):l.className;return r.a.createElement("th",{key:[o,a].join(".")},r.a.createElement("div",{id:l.id?l.id(s,a):void 0,className:[mt.a.cell,mt.a[m]].join(" "),onClick:"Name"===l.name&&l.id?function(){return e.setDisplayPlayer(l.id(s,a))}:null},u))})))}))}),[e.players,e.settings,d,u]),p="Tournament '".concat(e.status.name||e.status.id,"' results after ").concat(e.status.round," rounds");return r.a.createElement("div",{className:[mt.a.gridPage,"scrollable"].join(" ")},r.a.createElement("div",{className:mt.a.titles},r.a.createElement("div",null,p),r.a.createElement("div",{className:["button",mt.a.button].join(" "),onClick:e.show},r.a.createElement(ye.b,{style:{color:"indianred"}})," Back"),r.a.createElement("div",{className:["button",mt.a.button].join(" "),onClick:e.toggleRightTab},e.rightTab?r.a.createElement(ye.a,{style:{color:"indianred"}}):r.a.createElement(G.d,{style:{color:"#385898"}}),e.rightTab?"Close":"Show"," profile view")),r.a.createElement("table",{className:mt.a.table},r.a.createElement("thead",null,r.a.createElement("tr",null,i.map((function(e,t){var n=e.startsWith("round")?dt.roundColumn:dt.pre[e]||dt.post[e];return r.a.createElement("th",{scope:"column",key:["column",t].join("."),className:mt.a.th,id:e,onClick:function(){return m(e)}},r.a.createElement("div",{className:[mt.a.cell,mt.a.headerCell].join(" ")},"function"===typeof n.name?n.name(e,t):n.name))})))),r.a.createElement("tbody",null,f)))}for(var pt=n(12),bt=n.n(pt),gt={},vt=0,yt=Object.entries(Qe);vt<yt.length;vt++){var ht=Object(c.a)(yt[vt],2),Et=ht[0],jt=ht[1];gt[jt.toLowerCase()]=Et}function _t(e){var t=Object(a.useRef)(),n=Object(a.useRef)(),i=Object(a.useState)(!1),o=Object(c.a)(i,2),l=(o[0],o[1],Object(a.useMemo)((function(){return{firstName:{name:"Name",search:["name"],convert:function(e,t){return t.firstName=e,t},type:"string",required:!0},rating:{name:"Rating",search:["rating"],type:"number",required:!0},nationality:{name:"Nationality",type:"string",validate:function(e){return Object.values(Qe).some((function(t){return t.toLowerCase()===e.toLowerCase()}))},convert:function(e,t){return t.nationality=gt[e.toLowerCase()],t},feedback:r.a.createElement(r.a.Fragment,null,"The list of valid federations is as follows:",r.a.createElement("br",null),Object.values(Qe).join(", ")),search:["country","nation"]},email:{name:"Email",search:["email"],type:"string",validate:function(e){return D.test(e)},feedback:r.a.createElement(r.a.Fragment,null,"Email inputs must match the following regex format:",r.a.createElement("br",null),D.toString()),convert:function(e,t){return t.contact||(t.contact={}),t.contact.email=e,t}},facebook:{name:"Facebook",type:"string",search:["facebook"],convert:function(e,t){return t.contact||(t.contact={}),t.contact.facebook=e,t}},phone:{name:"Phone #",type:"string",search:["phone","number","contact"],convert:function(e,t){return t.contact||(t.contact={}),t.contact.phone=e,t}},lichess:{name:"Lichess username",search:["lichess"],type:"string",validate:function(e){return L.test(e)},feedback:r.a.createElement(r.a.Fragment,null,"Invalid format a Lichess username")},chessCom:{name:"Chess.com username",search:["chess.com"],type:"string"},ecfId:{name:"ECF ID",search:["ecf"],type:"string",convert:function(e,t){return t.ecf={id:e},t}},fideId:{name:"FIDE ID",search:["fide"],type:"string",convert:function(e,t){return t.fide={id:e},t}}}}),[!1])),s=Object(a.useState)([]),u=Object(c.a)(s,2),m=u[0],d=u[1],f=Object(a.useState)([]),p=Object(c.a)(f,2),b=p[0],g=p[1],v=Object(a.useState)([]),y=Object(c.a)(v,2),h=y[0],E=y[1],j=Object(a.useContext)(xe),_=Object(a.useCallback)((function(e){var t=[],n=[];e.shift().forEach((function(e,a){t[a]=e;for(var r=0,i=Object.entries(l);r<i.length;r++){var o=Object(c.a)(i[r],2),s=o[0],u=o[1];if(!n.includes(s)){var m,d=Object(X.a)(u.search);try{for(d.s();!(m=d.n()).done;){var f=m.value;if(e.toLowerCase().includes(f))return n[a]=s}}catch(p){d.e(p)}finally{d.f()}}}})),e=e.filter((function(e){return e.length===t.length}));var a=t.map((function(t,a){switch(n[a]){case"rating":return"number";default:return e.every((function(e){return!e[a].trim()||I.test(e[a].trim())||T.test(e[a].trim())}))&&e.some((function(e){return e[a].trim()}))?"boolean":"string"}}));return-1===n.indexOf("firstName")?(j({type:"error",message:"Must have at least one column with title 'name'"}),[]):(d(a),g(n),E(n),e.map((function(e){return e.map((function(e,t){var r=e.trim();switch(a[t]){case"number":return Number(r);case"boolean":return!T.test(r.trim())&&(!!I.test(r.trim())||void 0);case"string":if(!r)return"";if("nationality"===n[t]){if("USA"===r)return"United States of America";if("Russia"===r)return"Russian Federation"}return r;default:return}})).reduce((function(e,n,a){return e[t[a]]=n,e}),{})})))}),[l,j]),O=Object(a.useState)([]),N=Object(c.a)(O,2),S=N[0],k=N[1],w=Object(a.useCallback)((function(){t.current&&(t.current.value=""),n.current&&(n.current.value=""),E([]),k([])}),[t,n,E,k]),C=Object(a.useCallback)((function(){E(b)}),[E,b]),P=Object(a.useCallback)((function(){var e=t.current;if(e){var a=e.value;if(a.trim()){var r=Te.a.parse(a,{delimitersToGuess:[",","\t"],fastMode:!0,skipEmptyLines:"greedy"}),i=_(r.data);k(i);var o=n.current;o&&(o.value=JSON.stringify(i,null,4))}}}),[t,n,_]),R=Object(a.useMemo)((function(){return S.length?Object.keys(S[0]):[]}),[S]),B=Object(a.useMemo)((function(){if(!S.length)return[[],[]];var t,n=[],a=[],r=Object(X.a)(S);try{var i=function(){var r=t.value,i=h.indexOf("firstName"),o=r[R[i]].toLowerCase(),l=e.players.find((function(e){return(e.firstName+" "+e.lastName).toLowerCase()===o}));l?(r.__player=l,r=Object.assign(l,r),a.push(r)):n.push(r)};for(r.s();!(t=r.n()).done;)i()}catch(o){r.e(o)}finally{r.f()}return[a,n]}),[S,R,h,e.players,!1]),M=Object(c.a)(B,2),A=M[0],F=M[1],U=Object(a.useMemo)((function(){return A.concat(F)}),[A,F]),G=Object(a.useCallback)((function(){var t=F.map((function(e){for(var t=0;t<h.length;t++)if(h[t]){var n=l[h[t]];n.convert?e=n.convert(e[R[t]],e):e[h[t]]=e[R[t]],delete e[R[t]]}return e}));x({url:["tournament",e.id,"bulkAddPlayers"].join("/"),data:t}).then(e.leave).then(e.updatePlayerDict)}),[w,F,h,R,l,e.id,e.leave,e.updatePlayerDict]),H=Object(a.useCallback)((function(e,t,n){var a=S.slice(0);a[e][t]=n,k(a)}),[S,k]),V=Object(a.useState)(""),W=Object(c.a)(V,2),z=W[0],q=W[1],Y=Object(a.useState)(-2),J=Object(c.a)(Y,2),Z=J[0],$=J[1],ee=Object(a.useCallback)((function(){if(z&&!(Z<-1)){var e=h.indexOf(z),t=h.slice(0),n=Z>-1?t.splice(Z,1,z):[void 0],a=Object(c.a)(n,1)[0];e>=0&&t.splice(e,1,a),E(t),q(""),$(-2)}}),[z,Z,E,h,q,$]),te=Object(a.useMemo)((function(){return r.a.createElement("tr",null,R.map((function(e,t){return r.a.createElement("th",{key:["key",t].join(".")},h[t]?r.a.createElement("div",{className:["fieldBox",bt.a.parsedHeader,bt.a.tableHeader,Z===t?bt.a.dragEnter:""].join(" "),draggable:!0,onDragStart:function(){return q(h[t])},onDragEnd:ee,onDragEnter:function(){return $(t)}},l[h[t]].name):r.a.createElement("div",{className:["fieldBox",bt.a.tableHeader,Z===t?bt.a.dragEnter:""].join(" "),onDragEnter:function(){return $(t)}},e))})))}),[R,Z,$,h]),ae=Object(a.useState)(""),re=Object(c.a)(ae,2),ie=re[0],oe=re[1],le=Object(a.useState)([]),se=Object(c.a)(le,2),ce=se[0],ue=se[1],me=Object(a.useMemo)((function(){return U.length&&!ce.length?r.a.createElement("div",{className:[bt.a.target,"scrollable"].join(" "),onDragEnter:function(){return $(-1)}},r.a.createElement("button",{className:["button",bt.a.submit,bt.a.clear].join(" "),onClick:w},"CLEAR ALL"),r.a.createElement("button",{className:["button",bt.a.submit].join(" "),onClick:G},"IMPORT DATA")):r.a.createElement("div",{className:[bt.a.target,"scrollable"].join(" "),onDragEnter:function(){return $(-1)}},r.a.createElement("div",{className:bt.a.list},ce.map((function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:["fieldBox",bt.a.error].join(" "),onClick:function(){oe(e.id),e.meta.feedback&&setTimeout((function(){return j({message:e.meta.feedback,type:"info",title:"Validation for header: "+e.meta.header})}),800)}},e.message),r.a.createElement("div",{className:"fieldBox button",onClick:function(){var t=document.getElementById(e.id);t&&t.scrollIntoView({behavior:"smooth"})}},r.a.createElement(K.l,null)))}))),U.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:["button",bt.a.submit,bt.a.clear].join(" "),onClick:w},"CLEAR ALL")):null,r.a.createElement("div",{className:bt.a.placeholder},"When your spreadsheet is uploaded, any errors found will appear here. Handle all errors to import the data."))}),[ce,oe,U,G,w]),de=Object(a.useMemo)((function(){return U.map((function(e,t){return r.a.createElement("tr",{key:["tr",t].join(" ")},R.map((function(n,a){var i=e[n],o=!1;return""!==i&&void 0!==i||!e.__player?void 0===i&&(i=""):(i=e.__player[h[a]]||"",o=!0),r.a.createElement("td",{id:[t,a].join("."),key:["td",t,a].join(" ")},r.a.createElement(ne,{url:"",content:i.toString(),handleSubmit:function(e,n){return Promise.resolve(H(t,e,n))},onSubmitSuccess:function(e){return e},name:n,additionalStyles:{editableField:["fieldBox",o?bt.a.borrowed:"",ce.some((function(e){return e.id===[t,a].join(".")}))?bt.a.errorCell:"",ie===[t,a].join(".")?bt.a.highlighted:""].join(" ")},additionalInputProps:{},useHandleSubmit:!0,inputType:"number"===m[a]?"number":"text"}))})))}))}),[h,ie,ce]),fe=Object(a.useMemo)((function(){var e=Object.entries(l).filter((function(e){var t=Object(c.a)(e,1)[0];return!h.includes(t)})),t=h.every((function(e,t){return e===b[t]}))?null:r.a.createElement("button",{className:["button",bt.a.submit,bt.a.reset].join(" "),onClick:C},"RESET HEADERS");return r.a.createElement("div",{className:[bt.a.target,"scrollable"].join(" "),onDragEnter:function(){return $(-1)}},r.a.createElement("div",{className:bt.a.list},e.map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{key:n,draggable:!0,className:["fieldBox",bt.a.parsedHeader].join(" "),onDragStart:function(){return q(n)},onDragEnd:ee},a.name)}))),t,r.a.createElement("div",{className:bt.a.placeholder},"These are the known headers for each player that ScorchApp processes in a special way. It is important to identify these correctly in your spreadsheet.",r.a.createElement("br",null),"Any data that does not fit a known header category will still be stored and displayed but it is not of any significance to ScorchApp.",r.a.createElement("br",null),"If you think there is a header missing, please contact a developer."))}),[h,q,ee,l,$,b]);Object(a.useEffect)((function(){for(var e=[],t=0;t<h.length;t++){var n=h[t];if(n)for(var a=l[n],r=0;r<U.length;r++){var i=U[r][R[t]];if(a.type&&typeof i!==a.type)e.push({message:"Invalid type: [".concat(r,",").concat(n,"]: should be a ").concat(a.type),id:[r,t].join("."),type:"error",meta:Object.assign(a,{header:n})});else if(a.validate)a.validate(i)||e.push({message:"Failed validation: [".concat(r,",").concat(n,"]: click to see more information"),id:[r,t].join("."),type:"error",meta:Object.assign(a,{header:n})})}}h.includes("firstName")||e.unshift({message:"Must have field 'name'",id:[0,0].join("."),type:"error",meta:Object.assign(l.firstName,{header:"firstName"})}),h.includes("rating")||e.unshift({message:"Must have field 'rating'",id:[0,0].join("."),type:"error",meta:Object.assign(l.firstName,{header:"rating"})}),ue(e),oe("")}),[h,U,ue]);var pe=Object(a.useState)("headers"),be=Object(c.a)(pe,2),ge=be[0],ve=be[1],he=Object(a.useState)("errors"),Ee=Object(c.a)(he,2),je=Ee[0],_e=Ee[1],Oe="Smart Import for tournament '".concat(e.status.name||e.status.id,"'");return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:bt.a.stage},r.a.createElement("div",{className:["container"].join(" "),style:{gridColumn:"1 / span 2"}},r.a.createElement("div",{className:mt.a.titles},r.a.createElement("div",null,Oe),r.a.createElement("div",{className:["button",mt.a.closeButton].join(" "),onClick:e.leave},r.a.createElement(ye.b,null)))),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:bt.a.pasteContainer,onDragEnter:function(){return $(-1)}},r.a.createElement("div",{className:bt.a.paste},r.a.createElement("div",{className:[bt.a.pasteArea].join(" ")},r.a.createElement("textarea",{ref:t,className:bt.a.textarea,name:"textArea",placeholder:"Please paste your input in csv (comma-separated values) format\n\\ You can do that by going to Excel or your spreadsheet program of choice and selecting everything.\n\\ Copy it and paste it here, then hit SUBMIT when you're happy.",onClick:function(e){return e.target.select()}}),U.length?null:r.a.createElement("button",{className:[bt.a.submit,"button"].join(" "),onClick:P},"SUBMIT"))))),r.a.createElement("div",{className:"container",style:{display:"none"}},r.a.createElement("div",{className:bt.a.pasteContainer,onDragEnter:function(){return $(-1)}},r.a.createElement("div",{className:bt.a.paste},r.a.createElement("div",{className:[bt.a.pasteArea].join(" ")},r.a.createElement("textarea",{ref:n,className:[bt.a.output,"scrollable"].join(" "),name:"textArea",placeholder:"Raw data output"}))))),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:[bt.a.pasteContainer,"scrollable"].join(" ")},de.length?null:r.a.createElement("div",{className:[bt.a.placeholder,bt.a.description].join(" ")},"Welcome to Smart Import! Here you can use spreadsheet data to create new players.",r.a.createElement("br",null),"ScorchApp will automatically try and detect relevant Headers from your data.",r.a.createElement("br",null),"You can then drag and drop the headers if you think any are missing.",r.a.createElement("br",null),"Get pasting to start!"),r.a.createElement("table",{className:bt.a.playerTable},r.a.createElement("thead",null,te),r.a.createElement("tbody",null,de))))),r.a.createElement("div",{className:[Q.a.profile,bt.a.headerSection].join(" ")},r.a.createElement("div",{className:Q.a.profileStage},r.a.createElement(De,{name:ge,setName:function(e){return ve(e)},nameDict:{headers:r.a.createElement(r.a.Fragment,null,r.a.createElement(K.o,{style:{color:"lightgrey"}}),r.a.createElement("div",null,"Headers"))}}),"headers"===ge?fe:null)),r.a.createElement("div",{className:[Q.a.profile,bt.a.errors].join(" ")},r.a.createElement("div",{className:Q.a.profileStage},r.a.createElement(De,{name:je,setName:function(e){return _e(e)},nameDict:{errors:r.a.createElement(r.a.Fragment,null,r.a.createElement(K.k,{style:{color:"#385898"}}),r.a.createElement("div",null,"Errors"))}}),"errors"===je?me:null)))}var Ot=[30.8,38.4,30.8];function Nt(e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),t.eventName=e,document.dispatchEvent(t)}function St(e){var t=Object(a.useState)(e),n=Object(c.a)(t,2),r=n[0],i=n[1];Object(a.useEffect)((function(){JSON.stringify(e)!==JSON.stringify(r)&&(S.set("columns",e.map((function(e){return e.toString()})).join(",")),i(e))}),[e])}function kt(e){var t=Object(a.useReducer)((function(e,t){return t}),Ot),n=Object(c.a)(t,2),i=n[0],o=n[1],u=Object(a.useState)(0),m=Object(c.a)(u,2),f=m[0],p=m[1],b=Object(a.useMemo)((function(){return i.reduce((function(e,t){var n;return e.push((null!==(n=e[e.length-1])&&void 0!==n?n:0)+t),e}),[]).slice(0,-1)}),[i]);St(i);var g=Object(a.useState)(0),v=Object(c.a)(g,2),y=v[0],h=v[1],E=Object(a.useState)(""),j=Object(c.a)(E,2),_=j[0],O=j[1],N=Object(a.useState)(!1),k=Object(c.a)(N,2),w=k[0],P=k[1],R=Object(a.useState)(!1),D=Object(c.a)(R,2),B=D[0],I=D[1],T=Object(a.useState)(void 0),L=Object(c.a)(T,2),M=L[0],A=L[1],F=Object(a.useState)(!1),U=Object(c.a)(F,2),H=U[0],V=U[1],W=Object(a.useState)(!1),z=Object(c.a)(W,2),q=z[0],Y=z[1],Z=Object(a.useCallback)((function(){oe({set:w}),P(!w)}),[P,w]),$=Object(a.useCallback)((function(e){return Y(null!==e&&void 0!==e?e:!q)}),[q]),ee=Object(a.useCallback)(Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.get("columns");case 2:(t=e.sent)&&o(t.split(",").map((function(e){return Number(e)})));case 4:case"end":return e.stop()}}),e)}))),[o]);Object(a.useEffect)((function(){ee()}),[ee]);var te=Object(a.useCallback)((function(e,t){var n=t.set;if(0===i[0]){var a=i.slice(0);return a[0]=Ot[0],a[1]<Ot[0]?a=Ot:a[1]=a[1]-Ot[0],o(a),!0}return"boolean"===typeof n?n:!e}),[i,o]),ne=Object(a.useCallback)((function(e,t){var n=t.set;if(!1!==n&&100===b[b.length-1]){var a=i.slice(0);return a[a.length-1]=Ot[a.length-1],a[a.length-2]<Ot[a.length-2]?a=Ot:a[a.length-2]=a[a.length-2]-Ot[a.length-1],o(a),!0}return"boolean"===typeof n?n:!e}),[i,b]),ae=Object(a.useReducer)(ne,!0),re=Object(c.a)(ae,2),ie=re[0],oe=re[1],le=Object(a.useState)("settings"),se=Object(c.a)(le,2),ce=se[0],ue=se[1],me=Object(a.useReducer)(te,!0),de=Object(c.a)(me,2),fe=de[0],pe=de[1],be=Object(a.useCallback)((function(e){ie||oe({set:!0}),"player"!==ce&&ue("player"),O(e)}),[O,ce,ue,ie,oe]),ge=Object(a.useState)(Math.random().toString(16).slice(2,9)),ve=Object(c.a)(ge,2),ye=ve[0],he=ve[1],Ee=Object(a.useState)(""),je=Object(c.a)(Ee,2),Oe=je[0],ke=je[1],we=Object(a.useState)({}),xe=Object(c.a)(we,2),Pe=xe[0],Re=xe[1],Be=Object(a.useState)({}),Ie=Object(c.a)(Be,2),Te=Ie[0],Le=Ie[1],Me=Object(a.useState)([]),Ae=Object(c.a)(Me,2),Fe=Ae[0],Ue=Ae[1],Ge=Object(a.useState)([]),He=Object(c.a)(Ge,2),Ke=He[0],We=He[1];!function(e){var t=e.columns,n=e.boundaries,r=e.resize,i=e.setColumns,o=e.setResize,l=e.toggleSidebar,s=e.toggleRightTab,u=Object(a.useState)(0),m=Object(c.a)(u,2),d=m[0],f=m[1],p=Object(a.useCallback)((function(e){var a=e.x/window.innerWidth*100;if(d){var r=t.slice(0,d-1).reduce((function(e,t){return e+t}),0),c=r+t[d-1]+t[d],u=a-r,m=c-a;u<2?(m+=u,u=0,1===d&&l({set:!1}),Nt("mouseup")):m<2&&(u+=m,m=0,d===t.length-1&&(Nt("mouseup"),s({set:!1}))),t[d-1]=u,t[d]=m,i(t.slice(0))}else{var f=n.findIndex((function(e){return Math.abs(e-a)<.4}));(0===f&&0===n[0]||f===n.length-1&&100===n[n.length-1])&&(f=-1),o(f+1)}}),[d,t,o,i,n,l,s]);St(t),Object(a.useEffect)((function(){return document.addEventListener("mousemove",p),function(){return document.removeEventListener("mousemove",p)}}),[d,p]),Object(a.useEffect)((function(){if(r){var e=function(){return f(r)};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[r,f]),Object(a.useEffect)((function(){var e=function(){return f(0)};return document.addEventListener("mouseup",e),function(){return document.removeEventListener("mouseup",e)}}),[r,f])}({columns:i,boundaries:b,resize:f,setColumns:o,setResize:p,toggleSidebar:pe,toggleRightTab:oe});var ze=Object(a.useState)(!1),qe=Object(c.a)(ze,2),Ye=qe[0],Je=qe[1],Xe=Object(a.useState)(Date.now()),Ze=Object(c.a)(Xe,2),Qe=Ze[0],$e=Ze[1],tt=Object(a.useCallback)((function(e,t){if(t.id)return e.delete(t.id),t.id===_&&be(""),he(t.hash||Math.random().toString(16).slice(2,9)),e;var n;n=t.players?t.players:[t.player];var a,r=Object(X.a)(n);try{for(r.s();!(a=r.n()).done;){var i=a.value;e.set(i.id,i)}}catch(o){r.e(o)}finally{r.f()}return he(t.hash||Math.random().toString(16).slice(2,9)),e}),[be,he,_,Qe]),nt=Object(a.useReducer)(tt,new Map),at=Object(c.a)(nt,2),rt=at[0],it=at[1],ot=Object(a.useCallback)((function(t){return!t&&Date.now()-Qe<3e3?($e(Date.now()),Je(!0),Promise.resolve()):C({url:"/tournament/"+e.id+"/fetchPlayers"}).then((function(e){$e(Date.now()),Je(!1),We(e),it({players:e})}))}),[e.id,We,he,it,Qe]);Object(a.useEffect)((function(){if(Ye){var e=setTimeout(ot,5e3);return function(){return clearTimeout(e)}}}),[Ye,ot]);var st=Object(a.useCallback)((function(){return C({url:"/tournament/"+e.id+"/getStatus"}).then(Re)}),[e.id,Re]),ut=Object(a.useCallback)((function(){return C({url:"/tournament/"+e.id+"/getSettings"}).then(Le)}),[e.id,Le]),mt=Object(a.useCallback)((function(t,n,a){var r;return x({url:"tournament/"+e.id+"/updateSetting",data:(r={},Object(J.a)(r,t,n),Object(J.a)(r,null===a||void 0===a?void 0:a.linked,(null===a||void 0===a?void 0:a.linked)?n:void 0),r)}).then(ut)}),[e.id,ut]),dt=Object(a.useCallback)((function(){return C({url:"/tournament/"+e.id+"/fetchRounds"}).then(Ue)}),[e.id,Ue]),pt=Object(a.useCallback)(Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:V(Ke.filter((function(e){return!1!==e.active})).length>=2);case 1:case"end":return e.stop()}}),e)}))),[Ke,V]);Object(a.useEffect)((function(){if(!e.id)return null;dt(),st(),ut(),ot(!0)}),[e.id,dt,st,ut]);var bt=Object(a.useCallback)((function(e){if(!e)return"\u200b";if("bye"===e)return"BYE";if("string"!==typeof e){var t=e;return"bye"===t.id||"BYE"===t.id?"BYE":"individual"===Te.competitors?[t.firstName,t.lastName].join(" "):t.firstName}var n=rt.get(e);return n?"individual"===Te.competitors?[n.firstName,n.lastName].join(" "):n.firstName:e}),[rt,ye,Te.competitors]);if(!e.id)return null;if(w)return r.a.createElement("div",{className:Q.a.tournament},r.a.createElement(ft,{show:Z,setDisplayPlayer:be,status:Pe,players:Ke,settings:Te,rightTab:ie,toggleRightTab:function(){return oe({set:!ie})}}),ie?r.a.createElement("div",{className:Q.a.profile},r.a.createElement(De,{name:ce,setName:function(e){return ue(e)},nameDict:{player:r.a.createElement(r.a.Fragment,null,r.a.createElement(G.d,null),"Profile")}}),r.a.createElement(Ce.Provider,{value:bt},r.a.createElement(et,{id:e.id,status:Pe,playerID:_,setDisplayPlayer:be,playerDict:rt,modifyPlayerDict:function(e,t){return it({player:e,hash:t})},settings:Te}))):null);if(B)return r.a.createElement("div",{className:Q.a.background},r.a.createElement("div",{className:Q.a.tournament},r.a.createElement(_t,{status:Pe,settings:Te,id:e.id,updatePlayerDict:ot,players:Ke,leave:function(){return I(!1)}})));var gt={};return f&&(gt.cursor="ew-resize"),r.a.createElement("div",{className:Q.a.background},r.a.createElement("div",{className:Q.a.tournament,style:Object(d.a)({gridTemplateColumns:i.join("% ")+"%"},gt)},fe?r.a.createElement(Ve,{playerDict:rt,playerDictKey:ye,updatePlayerDict:ot,setPlayerDict:it,settings:Te,id:e.id,setDisplayPlayer:be,checkIfEnoughPlayers:pt,togglePasteInput:function(){return I(!0)},stateKey:Oe,updateSetting:mt}):null,r.a.createElement(_e,{userRound:y,setRound:h,status:Pe,settings:Te,updateTournamentStatus:st,round:Pe.round,totalRounds:Te.totalRounds,closeTournament:e.closeTournament,toggleCrossTable:Z,setLastRound:A,lastRoundOverride:M,triggerError:e.triggerError,switchMode:q,switchPairings:$}),q?r.a.createElement(Se,{userRound:y,status:Pe,playerDict:rt,updatePlayerDict:ot,settings:Te,id:e.id,playerDictKey:ye,triggerConfirm:e.triggerConfirm,switchPairings:$,updateTournamentStatus:st}):r.a.createElement(Ne,{userRound:y,status:Pe,playerDict:rt,updatePlayerDict:ot,updateStatus:st,settings:Te,id:e.id,canTriggerNextRound:H,toggleSidebar:function(){return pe({})},toggleRightTab:function(){return oe({set:!ie})},setDisplayPlayer:be,updateRound:st,updateSetting:mt,setLastRound:A,lastRoundOverride:M,toggleCrossTable:Z,playerDictKey:ye,triggerConfirm:e.triggerConfirm}),ie?r.a.createElement("div",{className:Q.a.profile},r.a.createElement("div",{className:Q.a.profileStage},r.a.createElement(De,{name:ce,setName:function(e){return ue(e)},nameDict:{settings:r.a.createElement(r.a.Fragment,null,r.a.createElement(K.h,{style:{color:"lightgrey"}}),r.a.createElement("div",null,"Settings")),player:r.a.createElement(r.a.Fragment,null,r.a.createElement(K.A,{style:{color:"#385898"}}),r.a.createElement("div",null,"Profile")),public:Te.public?r.a.createElement(r.a.Fragment,null,r.a.createElement(K.n,{style:{color:"green"}}),r.a.createElement("div",null,"Public")):""}}),"settings"===ce?r.a.createElement(lt,{updateTournamentSettings:ut,updateSetting:mt,status:Pe,settings:Te,setLastRound:A,triggerError:e.triggerError,players:Ke,updateRounds:dt,rounds:Fe,updateState:function(){return ke(Math.random().toString(16).slice(2,9))}}):"player"===ce?r.a.createElement(Ce.Provider,{value:bt},r.a.createElement(et,{id:e.id,status:Pe,playerID:_,setDisplayPlayer:be,playerDict:rt,modifyPlayerDict:function(e,t){return it({player:e,hash:t})},settings:Te,playerDictKey:ye})):"public"===ce?r.a.createElement(ct,{updateTournamentSettings:ut,updateSetting:mt,status:Pe,settings:Te,setLastRound:A,triggerError:e.triggerError,players:Ke,updateRounds:dt,rounds:Fe}):null)):null))}var wt=n(17),Ct=n.n(wt);function xt(e){return r.a.createElement("span",{id:e.id,className:e.className,style:Object(d.a)({height:e.radius,width:e.radius,lineHeight:e.radius,borderRadius:"50%",display:"inline-block",cursor:"default"},e.style),onClick:e.onClick,onMouseEnter:e.onMouseEnter},e.content)}var Pt={username:{name:"Username",type:"string",convert:function(e){return e||"guest"},locked:!0,primaryKey:!0},email:{name:"Email",type:"string",locked:!0,defaultValue:""},licensed:{name:"License",type:"number",defaultValue:0,locked:!0,convert:function(e){return 1===e?"Trial":2===e?"Licensed":3===e?"Admin":"Free"}},daysRemaining:{name:"Trial time",type:"number",locked:!0,value:function(e){return Math.floor(30-(t=new Date(e.lastLicensed),(new Date(Date.now()).valueOf()-t.valueOf())/864e5));var t},convert:function(e){return e+" days"},validate:function(e,t){return 1===t.licensed}},lastLicensed:{name:"Last licensed",type:"date",defaultValue:null,locked:!0,convert:function(e){return new Date(e).toString().slice(0,21)},validate:function(e){return!!e}},backgroundURL:{name:"Background Image",type:"string",defaultValue:"/images/leaves-texture.png",locked:!0,validate:function(e){return!!e},editable:!0},createdAt:{name:"Account created",convert:function(e){return new Date(e).toString().slice(0,21)},locked:!0,defaultValue:Date.now()},updatedAt:{name:"Last seen",convert:function(e){return new Date(e).toString().slice(0,21)},locked:!0,defaultValue:Date.now()}};function Rt(e){var t=e.getBoundingClientRect();return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2-30}}function Dt(e,t,n,a){var i,o,l=Math.abs(n.x-t.x),s=Math.abs(n.y-t.y),c=(i=n.x-t.x,o=n.y-t.y,Math.sqrt(Math.pow(i,2)+Math.pow(o,2))),u=Math.sign((n.x-t.x)*(n.y-t.y)),m=180*Math.atan(s/l)/Math.PI;return r.a.createElement("div",{key:["line",n.x,n.y].join("."),className:Ct.a.line,style:{width:c+"px",height:a+"px",backgroundColor:"white",position:"absolute",left:e?(t.x+n.x)/2-l/2:t.x-l/2,top:e?(t.y+n.y)/2:t.y,transform:"rotate(".concat(m*u,"deg) scaleX(").concat(e?1:0,") scaleY(1)"),opacity:e?1:0,transition:"transform 3s, left 3s, top 3s, opacity 3s"}})}function Bt(e){var t=je({},"tournamentDict"),n=Object(c.a)(t,2),i=n[0],o=n[1],u=je(!0,"loading"),m=Object(c.a)(u,2),d=m[0],f=m[1],p=je(!1,"loadingOverride"),b=Object(c.a)(p,2),g=b[0],v=b[1],y=je(!1,"linesMounted"),h=Object(c.a)(y,2),E=h[0],j=h[1],_=je(!1,"adjustedLines"),O=Object(c.a)(_,2),N=O[0],k=O[1],w=je("","selected"),P=Object(c.a)(w,2),R=P[0],D=P[1],B=Object(a.useCallback)((function(){return C({url:"/profile/tournaments"}).then((function(e){var t=e.reduce((function(e,t){return e[t.id]=t,e}),{});return o(t),t})).catch((function(t){return console.error(t),e.endSession(),{}}))}),[o,e.endSession]),I=Object(a.useCallback)((function(e){return e?Object.values(i).length?e in i?Promise.resolve():Promise.reject():B().then((function(t){if(void 0===t[e])throw new Error})):Promise.reject()}),[i,B]),T=Object(a.useCallback)((function(t){return I(t).then((function(){S.set("tournamentID",t,{path:"/"}).catch(console.error),e.setTournamentID(t)})).catch((function(){S.remove("tournamentID").catch(console.error),e.setTournamentID("")}))}),[I,e.setTournamentID]),L=Object(a.useCallback)(Object(s.a)(l.a.mark((function t(){var n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x({url:"/initialise"});case 3:if(n=t.sent){t.next=6;break}throw new Error;case 6:return e.setTournamentID(n),t.next=9,B();case 9:t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),(a=t.t0).response&&401!==a.response.status||e.endSession();case 15:case"end":return t.stop()}}),t,null,[[0,11]])}))),[e.setTournamentID,B,e.endSession]),M=Object(a.useCallback)(function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=6;break}return e.next=3,x({url:"/user/closeAuthorization/all"});case 3:o({}),e.next=11;break;case 6:return delete(n=Object.assign({},i))[t],e.next=10,x({url:"/tournament/".concat(t,"/closeAuthorization")});case 10:o(n);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i,o]),F=Object(a.useState)([]),U=Object(c.a)(F,2),V=U[0],W=U[1],z=Object(a.useRef)(),q=Object(a.useCallback)((function(){if(z.current){for(var e=Rt(z.current),t=[],n=0,a=Array.from(document.getElementsByClassName(Ct.a.dot));n<a.length;n++){var r=a[n];"0"!==r.style.opacity&&t.push(Dt(E,e,Rt(r),2))}W(t)}}),[z,Dt,E]);Object(a.useEffect)((function(){q(),j(!0);var e=setTimeout((function(){return k(!0)}),3e3);return function(){return clearTimeout(e)}}),[q,k,j,R]);var Y=Object(a.useMemo)((function(){return{create:{onClick:L,content:r.a.createElement(Oe.e,null),description:"Create new tournament"},roundRobin:{onClick:function(){},content:r.a.createElement(K.i,null),description:"Create new Round-Robin tournament"},settings:{onClick:function(){},content:r.a.createElement(G.e,null),description:"User settings"},load:{onClick:B,content:r.a.createElement(he.b,null),description:"Load previous tournaments"},back:{onClick:e.endSession,content:r.a.createElement(G.f,null),description:"Exit to login"},close:{onClick:function(){return e.triggerConfirm("Delete all saved tournaments?",M,(function(){}))},noSet:!0,content:r.a.createElement(G.h,null),description:"Close all tournaments",style:{border:"8px solid darkred"}},refresh:{onClick:B,noSet:!0,content:r.a.createElement(ye.c,null),description:"Refresh tournament list",style:{border:"8px solid darkblue"}}}}),[L,B,e.endSession,e.triggerConfirm,M,D]),J=Object(a.useCallback)((function(e,t){var n=e.reduce((function(e,t){return t in Y?(e[t]=Y[t],e):e}),{});return Object.entries(n).reduce((function(e,n,a){var i=Object(c.a)(n,2),o=i[0],u=i[1],m=[r.a.createElement("div",{className:[Ct.a.dotDescription,R===o?Ct.a.descriptionSelected:""].join(" "),key:["navData",t,"description",a].join(".")},u.description),r.a.createElement(xt,{key:["navData",t,"dot",a].join("."),radius:"50px",className:[Ct.a.dot,N?"":Ct.a.dotUnloaded].join(" "),id:o,content:u.content,onClick:function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(R!==o){e.next=4;break}D(""),e.next=7;break;case 4:return e.next=6,u.onClick(t);case 6:u.noSet||D(o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),style:u.style})];return"right"===t&&(m=m.reverse()),e.push(r.a.createElement("div",{className:[Ct.a.dotContainer,N?Ct.a.dotContainerLoaded:""].join(" "),key:["NavData",t,"div",a].join("i")},m)),e}),[])}),[Y,N,R,D]),X=Object(a.useCallback)(Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.get("tournamentID");case 2:(t=e.sent)&&T(t);case 4:case"end":return e.stop()}}),e)}))),[T]);Object(a.useEffect)((function(){X()}),[X]),Object(a.useEffect)((function(){window.addEventListener("resize",q);var e=setTimeout((function(){return f(!1)}),3e3);return function(){window.removeEventListener("resize",q),clearTimeout(e)}}),[q,f]);var Z=Object(a.useMemo)((function(){switch(R){case"load":return J(["refresh","close","load"],"left");case"settings":default:return J(["create","settings","load"],"left")}}),[R,J]),$=Object(a.useMemo)((function(){return R?r.a.createElement("div",{className:Ct.a.container},r.a.createElement("div",{className:Q.a.profile},r.a.createElement(De,{name:R,setName:function(e){return D(e)},nameDict:{settings:r.a.createElement(r.a.Fragment,null,r.a.createElement(G.e,null),"User Settings"),load:r.a.createElement(r.a.Fragment,null,r.a.createElement(he.b,null),"Previous Tournaments")}}),"load"===R?r.a.createElement(It,{setTournamentID:T,createNewTournament:L,removeID:M,updateTournamentSettings:B,tournamentDict:i,closeListing:function(){return D("")},triggerConfirm:e.triggerConfirm}):"settings"===R?r.a.createElement(Tt,{user:e.user,updateTournamentSettings:function(){return Promise.resolve()},updateSetting:function(){return Promise.resolve()},closeListing:function(){return D("")},updateUser:e.updateUser}):null)):J(["back"],"right")}),[D,R,T,L,M,B,i,e.triggerConfirm,J,e.user]);return r.a.createElement("div",{className:A.a.canvas},V,r.a.createElement("div",{className:[A.a.column,Ct.a.leftColumn].join(" ")},Z),r.a.createElement("div",{ref:z,className:[A.a.column,Ct.a.column].join(" ")},r.a.createElement(H,{setLoading:function(e){return v(e)},loading:d||g,classNames:{logo:Ct.a.logo}})),r.a.createElement("div",{className:[A.a.column,Ct.a.rightColumn].join(" ")},$))}function It(e){var t=Object(a.useState)(0),n=Object(c.a)(t,2),i=n[0],o=n[1],l=Object(a.useCallback)((function(t){return Object.values(t).map((function(t,n){var a=t.name||t.id;return r.a.createElement("div",{className:[qe.a.row,Ct.a.row].join(" "),key:["row",n].join(".")},r.a.createElement("div",{className:[Ct.a.clickButton,"fieldBox"].join(" "),onClick:function(){return e.setTournamentID(t.id)}},a),r.a.createElement("div",{className:[Ct.a.clickButton,Ct.a.close,"fieldBox"].join(" "),onClick:function(){e.triggerConfirm("Delete tournament '"+a+"'?\nPlease note this action cannot be undone.",(function(){return e.removeID(t.id)}),(function(){}))}},r.a.createElement(G.c,null)))})).filter((function(e){return e}))}),[e.tournamentDict,e.setTournamentID,e.triggerConfirm,e.removeID]),s=r.a.useRef();return Object(a.useEffect)((function(){var e=setTimeout((function(){s.current&&o(s.current.getBoundingClientRect().height)}),250);return function(){return clearTimeout(e)}}),[s,e.tournamentDict,l,o]),r.a.createElement("div",{className:Ct.a.sidebar},r.a.createElement("div",{className:[Ct.a.profile].join(" ")},r.a.createElement("div",{className:"topBanner"},"Load Tournament"),r.a.createElement("div",{className:["scrollable",Ct.a.scrollable].join(" ")},r.a.createElement("div",{className:Ct.a.listWrapper,style:{height:i}},r.a.createElement("div",{ref:s,className:Ct.a.listing},l(e.tournamentDict)))))," ")}function Tt(e){var t=Object(a.useState)(0),n=Object(c.a)(t,2),i=n[0],o=n[1],l=r.a.useRef();Object(a.useEffect)((function(){var e=setTimeout((function(){l.current&&o(l.current.getBoundingClientRect().height)}),250);return function(){return clearTimeout(e)}}),[l,o]);var s=Object(a.useCallback)((function(t,n){return x({url:"/profile/updateSetting",data:Object(J.a)({},t,n)}).then(e.updateUser)}),[e.updateUser]),u=Object(a.useMemo)((function(){return Object.entries(Pt).map((function(t,n){var a=Object(c.a)(t,2),i=a[0],o=a[1],l=e.user[i]||o.defaultValue;if(o.value&&(l=o.value(e.user)),"number"===o.type&&(l=Number(l)),o.validate&&!o.validate(l,e.user))return null;var u=l;o.convert&&(u=o.convert(l));var m="undefined"!==typeof u?u.toString():"\u200b";return r.a.createElement("div",{className:qe.a.row,key:["row",n].join(".")},r.a.createElement("div",{className:["fieldBox"].join(" ")},o.name+":"),o.editable?r.a.createElement(ne,{handleSubmit:s,content:u,url:"/updateSetting",inputType:"text",onSubmitSuccess:function(t){return e.updateTournamentSettings(),t},additionalStyles:{editableField:"fieldBox",input:Ct.a.input},name:i,additionalInputProps:{},show:{submit:!0},useHandleSubmit:!0}):r.a.createElement("div",{style:{cursor:"link"===o.type?"copy":"default"},className:["fieldBox","licensed"===i?Ct.a["license"+l.toString()]:""].join(" "),onClick:"link"!==o.type?null:function(){return navigator.clipboard.writeText(m)}},m))}))}),[e.user]);return r.a.createElement("div",{className:Ct.a.sidebar},r.a.createElement("div",{className:[Q.a.profile,Ct.a.profile].join(" ")},r.a.createElement("div",{className:"topBanner"},"Settings"),r.a.createElement("div",{className:[Ct.a.listWrapper,"scrollable"].join(" "),style:{height:i}},r.a.createElement("div",{ref:l,className:Ct.a.listing},u))),r.a.createElement("div",{className:["bottomBanner",Ct.a.bottomBanner].join(" ")},r.a.createElement("div",{onClick:e.closeListing,className:"button"},r.a.createElement(G.f,null))))}var Lt=n(51),Mt=n.n(Lt);function At(e){var t=r.a.isValidElement(e.message)||"string"===typeof e.message?e.message:JSON.stringify(e.message,null,4)+"\n\nIf you're seeing this error, please report it to the developers.",n=Object(a.useRef)(null);return Object(a.useEffect)((function(){n.current.focus()}),[n]),r.a.createElement("div",{className:Mt.a.shade,onClick:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:["container",Mt.a.container].join(" ")},r.a.createElement("div",{className:Mt.a.alertBox},e.title?r.a.createElement("div",{className:Mt.a.title},e.title):null,r.a.createElement("div",{className:[Mt.a.textBox,"scrollable"].join(" ")},t),"confirm"!==e.type?r.a.createElement("button",{className:[Mt.a.OK,"button","error"===e.type?Mt.a.ERROR:""].join(" "),onClick:e.close,ref:n},"OK"):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:[Mt.a.NO,"button"].join(" "),ref:n,onClick:function(){e.reject(),e.close()}},r.a.createElement(G.h,null)),r.a.createElement("button",{className:[Mt.a.YES,"button"].join(" "),onClick:function(){e.resolve(),e.close()}},r.a.createElement(G.g,null))))))}function Ft(){var e=Object(a.useState)(""),t=Object(c.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(""),u=Object(c.a)(o,2),m=u[0],d=u[1],f=je("login","mode"),p=Object(c.a)(f,2),b=p[0],g=p[1],v=Object(a.useReducer)((function(e,t){return Object.assign({},e,t)}),{message:"",title:"",type:""}),y=Object(c.a)(v,2),h=y[0],E=y[1],j=Object(a.useCallback)((function(){return E({message:""})}),[E]),_=Object(a.useCallback)((function(e,t,n){return E({message:e,title:"CONFIRM ACTION",type:"confirm",resolve:t,reject:n})}),[E]),O=Object(a.useCallback)((function(e){return E({message:e,title:"ERROR",type:"error"})}),[E]),N=Object(a.useCallback)((function(e){d(e),g(e?"tournament":"menu")}),[d,g]),k=Object(a.useCallback)(function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.set("sessionID",t,{path:"/"});case 2:i(t),g("menu");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i,g]),w=Object(a.useCallback)(Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.set("tournamentID","",{path:"/"});case 2:g("menu"),d("");case 4:case"end":return e.stop()}}),e)}))),[d,g]),P=Object(a.useCallback)(Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x({url:"/endSession"});case 3:return e.next=5,S.set("sessionID","",{path:"/"});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:return e.prev=10,i(""),g("login"),e.finish(10);case 14:case"end":return e.stop()}}),e,null,[[0,7,10,14]])}))),[i,g]);Object(a.useEffect)((function(){return R((function(e,t){return E({title:"ERROR: "+e,type:"error",message:"string"===typeof t?t.startsWith("<!DOCTYPE html>")?r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}}):r.a.createElement(r.a.Fragment,null,t.split("\n").map((function(e,t){return r.a.createElement("p",{key:["e",t].join(".")},e)}))):JSON.stringify(t,null,4)})})),function(){return R((function(){}))}}),[O]);var D=Object(a.useCallback)(Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.get("sessionID");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:i(t),g("menu");case 7:case"end":return e.stop()}}),e)}))),[i,g]);Object(a.useEffect)((function(){D()}),[D]);var B=je({},"user"),I=Object(c.a)(B,2),T=I[0],L=I[1],M=Object(a.useCallback)((function(){return n?C({url:"/profile"}).then(L):null}),[L,n]);Object(a.useEffect)((function(){M()}),[M]);var A=Object(a.useMemo)((function(){switch(b){case"login":return r.a.createElement(V,{login:k});case"menu":return r.a.createElement(Bt,{endSession:P,setTournamentID:N,triggerConfirm:_,user:T,updateUser:M});case"tournament":return r.a.createElement(kt,{id:m,closeTournament:w,triggerError:O,triggerConfirm:_});default:return console.error("invalid mode"),g("login"),null}}),[T,M,b,k,n,P,N,_,m,w,O,g]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,null),r.a.createElement("div",{className:"stage",style:{backgroundImage:T.backgroundURL?"url(".concat(T.backgroundURL,")"):void 0}},r.a.createElement(xe.Provider,{value:E},A),h.message&&("string"!==typeof h.message||h.message.length>10)?r.a.createElement(At,Object.assign({},h,{close:j})):null))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(i.render)(r.a.createElement(Ft,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},9:function(e,t,n){e.exports={sidebar:"sidebar_sidebar__3Z89I","slide-in-from-left":"sidebar_slide-in-from-left__3kaGk",players:"sidebar_players__3X4vY",newPlayers:"sidebar_newPlayers__2MILk",stage:"sidebar_stage__14IEV",playersSection:"sidebar_playersSection__3_kKf",scoreSection:"sidebar_scoreSection__2Qh1c",addPlayerForm:"sidebar_addPlayerForm__1BL-S",input:"sidebar_input__3Y8ld",playerLine:"sidebar_playerLine__1cnKs",cancel:"sidebar_cancel__1DhJL",edit:"sidebar_edit__zaTlg",activate:"sidebar_activate__2-tDL",submit:"sidebar_submit__22Uk4",info:"sidebar_info__2QcrS",null:"sidebar_null__39tIA",playerInfo:"sidebar_playerInfo__12dBq",team:"sidebar_team__3Gw6e",scoreSeparator:"sidebar_scoreSeparator__1zbAQ",sectionHeader:"sidebar_sectionHeader__2UjkE",playerInactive:"sidebar_playerInactive__1Y9Kw",topBanner:"sidebar_topBanner__3fw_E",bottomBanner:"sidebar_bottomBanner__ZFfBX",striped:"sidebar_striped__dRdNU",searchResults:"sidebar_searchResults__3jJ2m"}}},[[357,1,2]]]);
//# sourceMappingURL=main.1b85f193.chunk.js.map