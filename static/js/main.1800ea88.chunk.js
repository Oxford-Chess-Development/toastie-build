(this["webpackJsonptoastie-desktop"]=this["webpackJsonptoastie-desktop"]||[]).push([[0],[,,function(e,t,n){"use strict";n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return b})),n.d(t,"f",(function(){return _}));var a=n(4),r=n.n(a),i=n(22),o=n(7),s=n(39),l=n.n(s),c=n(45),u=n(14),d=n(8),m=n(9),p=new(n(58).a),f=function(){},g=new(function(){function e(){Object(d.a)(this,e)}return Object(m.a)(e,[{key:"getAll",value:function(){return u.c||u.d?u.a.get({}).then((function(e){return e.reduce((function(e,t){return e[t.name]=t.value,e}),{})})).catch((function(e){return console.log(e),{}})):Promise.resolve(p.getAll()||{})}},{key:"get",value:function(e){return u.c||u.d?u.a.get({name:e}).then((function(e){return e.map((function(e){return e.value}))})).then((function(e){return e[0]||""})).catch((function(e){return console.log(e),""})):Promise.resolve(p.get(e)||"")}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object.assign({},n);if(u.c||u.d){var r=new Date(Date.now());return a=Object.assign(a,{name:e,value:t,url:v,expirationDate:r.setFullYear(r.getFullYear()+1)}),u.a.set(a).then((function(){return u.a.get({})})).then((function(e){return e.map((function(e){return{name:e.name,value:e.value}}))})).catch(console.error)}return Promise.resolve(p.set(e,t,n))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u.c||u.d?u.a.remove(v,e):p.get(e)?Promise.resolve(p.remove(e,t)):Promise.reject("Couldn't remove cookie")}}]),e}()),v=u.b?c.server:c.prodServer;function h(e){return e=Object.assign(e,{method:"GET"}),l()(e).then((function(e){return e.data})).catch((function(e){throw console.error(e),e.response&&f([e.response.status,e.response.statusText,":","/"+e.response.config.url.split("/").pop()].join(" ")),e}))}function y(e){return e=Object.assign(e,{method:"POST",headers:{"Content-Type":"application/json"}}),l()(e).then((function(e){return e.data})).catch((function(e){throw e&&e.response&&e.response.data&&f(e.response.data),e}))}function b(e){e.preventDefault(),e.persist();var t=e.target;return y({data:Array.from(t).reduce((function(e,t){return t.name?("submit"===t.name||("number"===t.type?e[t.name]=Number(t.value):e[t.name]=t.value),e):e}),{}),url:t.action})}function _(e){f=e}l.a.defaults.baseURL=v,l.a.interceptors.request.use(function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=i.a,e.t1={},e.t2=t,e.t3=i.a,e.t4={},e.t5=t.headers,e.t6=JSON,e.next=9,g.getAll();case 9:return e.t7=e.sent,e.t8=e.t6.stringify.call(e.t6,e.t7),e.t9={Authorization:e.t8},e.t10=(0,e.t3)(e.t4,e.t5,e.t9),e.t11={headers:e.t10},e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t11));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},,,function(e,t,n){e.exports={container:"components_container__1CCB7",editableField:"components_editableField__2fs18",form:"components_form__1RjIP",input:"components_input__I_Vv7",submitHidden:"components_submitHidden__PvrYt",any:"components_any__3pCEP",submit:"components_submit__1SFYQ",increment:"components_increment__19rbD",cancel:"components_cancel__1_2ia",infinity:"components_infinity__1rF3u",resolve:"components_resolve__1X_KN",reject:"components_reject__3ymMO",neutral:"components_neutral__392Xn","flash-green":"components_flash-green__2Wczz",centre:"components_centre__2BcEl",tooltip:"components_tooltip__1IKxP",sectionContainer:"components_sectionContainer__1tg1I",sectionHeader:"components_sectionHeader__-UWwY",sectionHeaderText:"components_sectionHeaderText__1OTig",sectionListWrapper:"components_sectionListWrapper__a03uW",sectionList:"components_sectionList__117sb",expanded:"components_expanded__3qOxR",sectionToggle:"components_sectionToggle__2z6Il"}},function(e,t,n){e.exports={sidebar:"profile_sidebar__C1jtg","slide-in-from-right":"profile_slide-in-from-right__2jdIT",profile:"profile_profile__1V8qL",roundRow:"profile_roundRow__3OA2r",row:"profile_row__aUfgI",resultsRow:"profile_resultsRow__4zleX",editable:"profile_editable__24Eas",editableField:"profile_editableField__2onPe",input:"profile_input__2tu2X",sectionContainer:"profile_sectionContainer__Tm0AF",sectionHeader:"profile_sectionHeader__UZUfT",sectionHeaderText:"profile_sectionHeaderText__XE7UN",sectionListWrapper:"profile_sectionListWrapper__1K1-l",sectionList:"profile_sectionList__3bJ8Z",expanded:"profile_expanded__3QtaO",sectionToggle:"profile_sectionToggle__2qBPk",semiPresent:"profile_semiPresent__1APEU"}},,,,function(e,t,n){e.exports={column:"login_column__14Kgt",initialiseButton:"login_initialiseButton__3CXrs",forgottenContainer:"login_forgottenContainer__2yR4y",forgotten:"login_forgotten__3VFQz",form:"login_form__1ieaR",input:"login_input__3ze1R",submit:"login_submit__2qxJT",loginSection:"login_loginSection__1BBMn",loginBackground:"login_loginBackground__y9UZ2",foreground:"login_foreground__2Cqo8",loginForeground:"login_loginForeground__lnGgY",registerForeground:"login_registerForeground__3D6jX",flip:"login_flip__2KG2q",messageBar:"login_messageBar__6TM4O"}},function(e,t,n){e.exports={sidebar:"sidebar_sidebar__3Z89I","slide-in-from-left":"sidebar_slide-in-from-left__3kaGk",playersSection:"sidebar_playersSection__3_kKf",scoreSection:"sidebar_scoreSection__2Qh1c",addPlayerForm:"sidebar_addPlayerForm__1BL-S",input:"sidebar_input__3Y8ld",submit:"sidebar_submit__22Uk4",edit:"sidebar_edit__zaTlg",cancel:"sidebar_cancel__1DhJL",activate:"sidebar_activate__2-tDL",playerInfo:"sidebar_playerInfo__12dBq",playerLine:"sidebar_playerLine__1cnKs",scoreSeparator:"sidebar_scoreSeparator__1zbAQ",sectionHeader:"sidebar_sectionHeader__2UjkE",playerInactive:"sidebar_playerInactive__1Y9Kw",topBanner:"sidebar_topBanner__3fw_E",bottomBanner:"sidebar_bottomBanner__ZFfBX"}},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return l}));var a="function"===typeof window.require,r=!1,i="function"===typeof window.require&&!window.require("electron-is-dev"),o=a?window.require("electron").remote:null,s=(a&&o.session,a?o.getCurrentWindow():{minimize:function(){},maximize:function(){},restore:function(){},close:function(){},isMaximized:function(){return!0}}),l=a?s.webContents.session.cookies:null;console.log("isDev",r),console.log("isElectron",a),console.log("isProd",i)},,,function(e,t,n){e.exports={pairings:"pairings_pairings__2Z6gd",pairingContainer:"pairings_pairingContainer__2snrJ",pairing:"pairings_pairing__jh3eo","fade-in":"pairings_fade-in__3Iydy",topBanner:"pairings_topBanner__duKX4",playerInfo:"pairings_playerInfo__2BGOf",resultsBridge:"pairings_resultsBridge__1P3NX",statusBar:"pairings_statusBar__Y2g9v","slide-in-from-bottom":"pairings_slide-in-from-bottom__1tu-V",waitButton:"pairings_waitButton__3CIsd",nextButton:"pairings_nextButton__1fjha",inputResult:"pairings_inputResult__8kpK5",setResult:"pairings_setResult__3mSXp",neutral:"pairings_neutral__2WWsU",bye:"pairings_bye__2Q8Qe",submit:"pairings_submit__258vX",errorMessage:"pairings_errorMessage__1qM9W"}},function(e,t,n){e.exports={leftColumn:"menu_leftColumn__13Ey0",rightColumn:"menu_rightColumn__2D55A",line:"menu_line__2oByf",row:"menu_row__q-PZk",listWrapper:"menu_listWrapper__1_77c",clickButton:"menu_clickButton__1F_HI",dotContainer:"menu_dotContainer__ze3l6",dotDescription:"menu_dotDescription__19QYi",dot:"menu_dot__3Dq9b",dotContainerLoaded:"menu_dotContainerLoaded__3YmWC",descriptionSelected:"menu_descriptionSelected__2aKX-",close:"menu_close__3eKoV",logo:"menu_logo__3MwZ9","float-down":"menu_float-down__1GhiB",dotUnloaded:"menu_dotUnloaded__2DT-h",expand:"menu_expand__1E6M-","briefly-expand":"menu_briefly-expand__ex-pm"}},,function(e,t,n){e.exports={canvas:"app_canvas__1MLEL",column:"app_column__2WVoo",logo:"app_logo__b6W_t",loadingLine:"app_loadingLine__1xeSs",staticLogo:"app_staticLogo__1-Wsi",loadingGif:"app_loadingGif__2PnUi",crownOutline:"app_crownOutline__2IPSS","fade-in":"app_fade-in__3kaKs","grow-right":"app_grow-right__1NUcX"}},,,function(e,t,n){"use strict";function a(e){return e?e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase():e}function r(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))},function(e,t,n){e.exports={tournament:"tournament_tournament__1ikhA",titleBar:"tournament_titleBar__1Kvez","slide-in-from-top":"tournament_slide-in-from-top__22vmU",row:"tournament_row__3K-Kn",header:"tournament_header__hB1Cf",container:"tournament_container__DVAFe",form:"tournament_form__1Pn88",input:"tournament_input__xb1Th",editableField:"tournament_editableField__1rO3U"}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return h}));var a=n(1),r=n.n(a),i=n(4),o=n.n(i),s=n(7),l=n(3),c=n(2),u=n(5),d=n.n(u),m=n(16);function p(e){var t,n=Object(a.useState)(e.content),i=Object(l.a)(n,2),u=i[0],p=i[1],f=Object(a.useState)(!1),g=Object(l.a)(f,2),v=g[0],y=g[1],b=Object(a.useState)(!1),_=Object(l.a)(b,2),E=_[0],j=_[1],O=Object(a.useRef)(null),N=Object(a.useRef)(null),w=function(t){t.preventDefault();var n=t.target;"HTMLButtonElement"===n.constructor.name&&n.parentNode[e.name||"name"].stepDown()},S=function(t){t.preventDefault();var n=t.target;"HTMLButtonElement"===n.constructor.name&&n.parentNode[e.name||"name"].stepUp()},x=function(t){return t.preventDefault(),e.handleSubmit(e.name||"name",0).then((function(){y(!1),p("0")}))},k=function(t){return t.preventDefault(),e.handleSubmit(e.name||"name","Infinity").then((function(){y(!1),p("\u221e")}))},C=function(t){return t.preventDefault(),Object(c.a)(t).then(Object(s.a)(o.a.mark((function n(){var a;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.target,!e.validateInput){n.next=4;break}return n.next=4,e.validateInput(a);case 4:case"end":return n.stop()}}),n)})))).then((function(){return y(!1),t})).then(e.onSubmitSuccess).then((function(e){var t=e.target.firstChild.value;p(t)}))},D=function(e){return 27!==e.keyCode||y(!1),e},P=function(t){var n,a,i,o,s,l,c,u,p,f=t||e.defaultEditContent;return"datetime-local"===e.inputType?f=function(e){if(isNaN(e.valueOf()))return"";var t=6e4*e.getTimezoneOffset();return new Date(e.valueOf()-t).toISOString().slice(0,16)}(function(e){var t=new Date(e.setUTCHours(e.getUTCHours()+1));return t.getUTCMinutes()<30?new Date(t.setUTCMinutes(30)):new Date(new Date(t.setUTCMinutes(0)).setUTCHours(t.getUTCHours()+1))}(new Date(f))):(null===(n=e.show)||void 0===n?void 0:n.any)&&"0"===f&&(f=""),r.a.createElement("form",{className:d.a.form,target:"_self",onKeyDown:D,onSubmit:C,method:"POST",action:e.url},r.a.createElement("input",Object.assign({type:e.inputType,className:[d.a.input,e.additionalStyles.input].join(" "),name:e.name||"name",defaultValue:f||"\u200b",required:!0,ref:O},e.additionalInputProps)),r.a.createElement("button",{value:"\u2717",className:[!(null===(a=e.show)||void 0===a?void 0:a.submit)||(null===(i=e.show)||void 0===i?void 0:i.infinity)||(null===(o=e.show)||void 0===o?void 0:o.any)?d.a.submitHidden:"",d.a.cancel].join(" "),onClick:function(){return y(!1)}},r.a.createElement(m.c,null)),r.a.createElement("button",{className:[(null===(s=e.show)||void 0===s?void 0:s.any)?"":d.a.submitHidden,d.a.any].join(" "),onClick:x},"Any"),r.a.createElement("button",{className:[(null===(l=e.show)||void 0===l?void 0:l.infinity)?"":d.a.submitHidden,d.a.infinity].join(" "),onClick:k},"\u221e"),r.a.createElement("button",{type:"button",value:"\u25bc",className:[(null===(c=e.show)||void 0===c?void 0:c.increment)?"":d.a.submitHidden,d.a.increment].join(" "),onClick:w},r.a.createElement(m.d,null)),r.a.createElement("button",{className:[(null===(u=e.show)||void 0===u?void 0:u.increment)?"":d.a.submitHidden,d.a.increment].join(" "),onClick:S},r.a.createElement(m.h,null)),r.a.createElement("button",{type:"submit",value:"\u2714",className:[(null===(p=e.show)||void 0===p?void 0:p.submit)?"":d.a.submitHidden,d.a.submit].join(" ")},r.a.createElement(m.b,null)))};Object(a.useEffect)((function(){p(e.content)}),[e.content]),Object(a.useEffect)((function(){if(E){var e=O.current;e&&e.select()}}),[E]),h((function(e){N.current&&N.current.contains(e.target)||y(!1)}));var I,B=Math.random().toString(16).slice(2,9),T=u;return T&&"datetime-local"===e.inputType?(I=new Date(u),T=isNaN(I.valueOf())?"":I.toLocaleString("en-GB").slice(0,-3)):(null===(t=e.show)||void 0===t?void 0:t.any)&&"0"===T&&(T="Any"),r.a.createElement("div",{ref:N,className:[d.a.container,e.additionalStyles.container].join(" "),id:B},v?P(u):r.a.createElement("div",{className:[d.a.editableField,e.additionalStyles.editableField||""].join(" "),onClick:function(){y(!0),j(!0)}},v?P(u):T||e.defaultContent||"\u200b"))}n(40);var f=n(19),g=n.n(f);function v(e){var t=Object(a.useState)(void 0),n=Object(l.a)(t,2),i=n[0],o=n[1],s=Object(a.useState)(""),u=Object(l.a)(s,2),p=u[0],f=u[1],v=function(t){var n=t.target.parentElement,a=e.validate(n);f("string"===typeof a?a:""),o("boolean"===typeof a?a:"string"!==typeof a&&void 0)};return r.a.createElement("form",{className:e.className,target:"_self",onSubmit:function(t){if(t.persist(),!e.validate(t.target))return t.preventDefault();Object(c.a)(t).then(e.handleSubmit)},method:"POST",action:g.a.resolve(c.e,["tournament",e.tournamentID,"addResult"].join("/"))},r.a.createElement("input",{type:"number",min:0,step:.5,name:"resultWhite",required:!0,className:e.inputClassName,onChange:v}),r.a.createElement("div",{className:d.a.centre},p?r.a.createElement("span",{className:d.a.tooltip},p):null,i?r.a.createElement("button",{tabIndex:-1,className:d.a.resolve},r.a.createElement(m.b,null)):!1===i?r.a.createElement("button",{tabIndex:-1,className:d.a.reject,onClick:function(e){e.preventDefault(),e.target.parentElement.parentElement.reset(),f(""),o(void 0)}},r.a.createElement(m.c,null)):r.a.createElement("div",{className:d.a.neutral},r.a.createElement(m.f,null))),r.a.createElement("input",{type:"number",min:0,step:.5,name:"resultBlack",required:!0,className:e.inputClassName,onChange:v}),Object.entries(e.hidden).map((function(e,t){var n=Object(l.a)(e,2),a=n[0],i=n[1];return r.a.createElement("input",{key:["hiddenInput",t].join("."),type:"hidden",name:a,value:i,required:!0})})))}var h=function(e){Object(a.useEffect)((function(){return window.addEventListener("mousedown",e),function(){return window.removeEventListener("mousedown",e)}}),[e])}},function(e,t,n){e.exports={crossTable:"crosstable_crossTable__3tCtZ",titles:"crosstable_titles__2lOQ_",table:"crosstable_table__FafeF",td:"crosstable_td__1hxGz",th:"crosstable_th__Gp7TR",cell:"crosstable_cell__1NDzK",playerBox:"crosstable_playerBox__ImPf9",resultsCell:"crosstable_resultsCell__3g4mX",headerCell:"crosstable_headerCell__2zS_u",firstColumn:"crosstable_firstColumn__2m7R_",closeButton:"crosstable_closeButton__2pu_0"}},,,function(e,t,n){e.exports={statusBar:"statusbar_statusBar__3f7HO",favicon:"statusbar_favicon__1Unmh",menu:"statusbar_menu__3nFvT",title:"statusbar_title__3ClL5",exec:"statusbar_exec__2fXB2",close:"statusbar_close__3ssky"}},function(e,t,n){e.exports={alertBox:"alert_alertBox__-kpK4",error:"alert_error__wKYnQ",textBox:"alert_textBox__ATagI",response:"alert_response__1RX0q",NO:"alert_NO__2Bl9f",YES:"alert_YES__pKi26"}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(23),r={general:{tournamentId:{name:"Unique ID",type:"string",locked:!0,primaryKey:!0},status:{name:"Status",enum:["uninitialised","active","finished"],convert:a.b,defaultValue:"uninitialised",value:function(e){return e.round?!1===e.active?"finished":"active":"uninitialised"}},pairingSystem:{name:"Pairing system",enum:["swiss"],convert:a.b,lockOnInit:!0,defaultValue:"swiss"},competitors:{name:"Tournament type",enum:["individual","team"],convert:a.b,lockOnInit:!0,defaultValue:"individual"},totalRounds:{name:"Total rounds",convert:function(e){return"Infinity"===e?"\u221e":e.toString()},type:"number",defaultValue:1/0,nb:{min:1,max:100},allow:{infinity:!0}},ratingSystem:{name:"Rating system",enum:["ECF","FIDE","USCF"],lockOnInit:!0,defaultValue:"FIDE"},displayPoints:{name:"Show",convert:function(e){return Object(a.b)(e)+" Points"},enum:["match","game"],defaultValue:"match"},gamePointTotal:{name:"Sum results to",type:"number",defaultValue:1,show:{displayPoints:"game"},lockOnInit:!0,nb:{step:1,min:1},allow:{any:!0}}},stats:{nbPlayers:{name:"Number of players",type:"number",defaultValue:0,value:function(e,t){return t.length},convert:function(e){return e.toString()}},activePlayers:{name:"Active players",type:"number",defaultValue:0,value:function(e,t){return t.filter((function(e){return e.active})).length},convert:function(e){return e.toString()}},matchesPlayed:{name:"Matches played",type:"number",defaultValue:0,value:function(e,t){return t.reduce((function(e,t){return e+t.played}),0)/2},convert:function(e){return e.toString()}},gamesPlayed:{name:"Games played",type:"number",defaultValue:0,value:function(e,t){return t.reduce((function(e,t){return e+t.histories.slice(1).reduce((function(e,t){return e+t.played}),0)}),0)/2},convert:function(e){return e.toString()}},averageRating:{name:"Average rating",type:"number",defaultValue:1200,value:function(e,t){var n=t.reduce((function(e,t){return e+t.rating}),0);return Math.round(n/t.length)},convert:function(e){return e.toString()}},createdAt:{name:"Created at",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0},updatedAt:{name:"Last updated",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0}},permissions:{allowNewPlayers:{name:"Mid-way joining?",convert:function(e){return Object(a.b)(e.toString())},lockOnInit:!1,type:"boolean",defaultValue:!0},allowSelfSubmissions:{name:"User submissions?",convert:function(e){return Object(a.b)(e.toString())},lockOnInit:!1,type:"boolean",defaultValue:!0},roundTimes:{name:"Round times?",convert:function(e){return Object(a.b)(e.toString())},type:"boolean",defaultValue:!1,locked:!1}},points:{lossReward:{name:"Points on loss",lockOnInit:!0,type:"number",defaultValue:0,nb:{step:.1}},drawReward:{name:"Points on draw",lockOnInit:!0,type:"number",defaultValue:.5,nb:{step:.1}},winReward:{name:"Points on win",lockOnInit:!0,type:"number",defaultValue:1,nb:{step:.1}},byeReward:{name:"Bye reward",enum:["win","draw","loss"],lockOnInit:!0,defaultValue:"win"},performanceSystem:{name:"Performance rating",enum:["ELO","FIDE"],lockOnInit:!1,defaultValue:"ELO"}}},i={username:{name:"Username",type:"string",locked:!0,primaryKey:!0},location:{name:"Location",type:"string",locked:!0,defaultValue:"Oxford, UK"},language:{name:"Language",type:"string",defaultValue:"English (UK)",locked:!0},createdAt:{name:"Created at",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0,defaultValue:Date.now()},updatedAt:{name:"Last updated",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0,defaultValue:Date.now()}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(3),r=n(1),i=n.n(r);function o(e){var t=e.header,n=e.body;return i.a.createElement("div",{className:e.styles.crossTable,style:e.style},i.a.createElement("table",{className:e.styles.table},i.a.createElement("thead",null,i.a.createElement("tr",null,Object.entries(t).map((function(t,n){var r=Object(a.a)(t,2),o=r[0],s=r[1];return i.a.createElement("th",{scope:"column",key:["column",n].join("."),className:e.styles.th},s?i.a.createElement("div",{className:[e.styles.cell,e.styles.headerCell].join(" "),onClick:function(){return e.handleHeaderClick(o)}},s):"")})))),i.a.createElement("tbody",null,n.map((function(t,n){var a=t.shift(),r=t;return i.a.createElement("tr",{key:"row."+n,className:e.styles.tr},i.a.createElement("th",{scope:"row"},a),r.map((function(t,a){var r=["cell",n,a].join(".");return i.a.createElement("td",{id:r,key:r,className:e.styles.td},t)})))})))))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return b}));var a=n(8),r=n(9),i=n(12),o=n(13),s=n(1),l=n.n(s),c=n(19),u=n.n(c),d=n(2),m={space:/\s+/g,letters:/\w+/g,image:/<img\s+.*?src=["'](.*).*?">/,date:/^[0-9]{4}-[0-9]{1,2}-[0-9]{1,2}_/,href:/^(https?:)?\/\//,email:/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/},p=n(20),f=n.n(p),g=n(10),v=n.n(g),h=n(15);function y(e){var t;return l.a.createElement("div",{className:[f.a.logo,null===(t=e.classNames)||void 0===t?void 0:t.logo].join(" ")},e.loading?l.a.createElement(l.a.Fragment,null,l.a.createElement("img",{className:f.a.staticLogo,src:"./images/dubrovny.png",alt:"swiss-logo.png"}),l.a.createElement("img",{className:f.a.crownOutline,src:"./images/crown-outline.png",alt:"outline-gif"}),l.a.createElement("img",{className:f.a.loadingGif,src:"./images/loading-crown.gif",alt:"loading-gif"})):l.a.createElement("img",{className:f.a.staticLogo,src:"./images/favicon.png",alt:"swiss-logo.png"})," ")}var b=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={loading:!1,register:!1,errorMessage:""},e.handleSubmit=function(t){e.setState({loading:!0}),Object(d.a)(t).then((function(t){return e.props.login(t)})).catch((function(t){t&&t.response&&t.response.data&&e.setState({errorMessage:t.response.data}),console.error(t)})).finally((function(){e.setState({loading:!1})}))},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:f.a.canvas},l.a.createElement("div",{className:f.a.column}),l.a.createElement("div",{className:[f.a.column,v.a.column].join(" ")},l.a.createElement(y,{setLoading:function(t){return e.setState({loading:t})},loading:this.state.loading}),this.loginSection,l.a.createElement("div",{className:v.a.messageBar},this.state.errorMessage||"\u200b")),l.a.createElement("div",{className:f.a.column}))}},{key:"loginForm",get:function(){return l.a.createElement("form",{className:v.a.form,method:"POST",onSubmit:this.handleSubmit,action:u.a.resolve(d.e,"login")},l.a.createElement("input",{type:"text",name:"username",required:!0,placeholder:"username",className:["input",v.a.input].join(" ")}),l.a.createElement("input",{type:"password",name:"password",required:!0,placeholder:"password",className:["input",v.a.input].join(" ")}),l.a.createElement("div",{className:v.a.forgottenContainer},l.a.createElement("div",{className:["input",v.a.forgotten].join(" ")},"username reminder"),l.a.createElement("div",{className:["input",v.a.forgotten].join(" ")},"password reset")),l.a.createElement("input",{type:"submit",value:"LOGIN",className:["input",v.a.submit].join(" ")}))}},{key:"registerForm",get:function(){return l.a.createElement("form",{className:v.a.form,method:"POST",onSubmit:this.handleSubmit,action:u.a.resolve(d.e,"register")},l.a.createElement("input",{type:"text",name:"username",required:!0,placeholder:"username",className:["input",v.a.input].join(" ")}),l.a.createElement("input",{type:"password",name:"password",required:!0,placeholder:"password",minLength:8,className:["input",v.a.input].join(" ")}),l.a.createElement("input",{type:"email",name:"email",required:!0,placeholder:"email",className:["input",v.a.input].join(" "),pattern:m.email.source}),l.a.createElement("input",{type:"submit",value:"REGISTER",className:["input",v.a.submit].join(" ")}))}},{key:"loginSection",get:function(){var e=this;return l.a.createElement("div",{className:[v.a.loginSection,v.a.initialiseButton].join(" ")},l.a.createElement("div",{className:v.a.loginBackground},l.a.createElement("div",{className:[v.a.flip,"button"].join(" "),onClick:function(){e.setState({loading:!0,register:!1,errorMessage:""}),setTimeout((function(){return e.setState({loading:!1})}),500)}},l.a.createElement("div",null,"LOGIN"),l.a.createElement("div",null,l.a.createElement(h.a,null))),l.a.createElement("div",null),l.a.createElement("div",{className:[v.a.flip,"button"].join(" "),onClick:function(){e.setState({loading:!0,register:!0,errorMessage:""}),setTimeout((function(){return e.setState({loading:!1})}),500)}},l.a.createElement("div",null,"REGISTER"),l.a.createElement("div",null,l.a.createElement(h.b,null))),"Background"),l.a.createElement("div",{className:[v.a.foreground,this.state.register?v.a.registerForeground:v.a.loginForeground].join(" ")},this.state.register?this.registerForm:this.loginForm))}}]),n}(l.a.Component)},,,function(e){e.exports=JSON.parse('{"server":"http://localhost:8080/","prodServer":"https://api.oxfordchess.co.uk/"}')},,,,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return I}));var a=n(3),r=n(4),i=n.n(r),o=n(7),s=n(8),l=n(9),c=n(12),u=n(13),d=n(1),m=n.n(d),p=n(19),f=n.n(p),g=n(20),v=n.n(g),h=n(6),y=n.n(h),b=n(18),_=n.n(b),E=n(42),j=n(2),O=n(57),N=n(23),w=n(38),S=n(26),x=n(15),k=n(16),C=n(41),D=n(25),P=n(28),I=function(t){Object(u.a)(r,t);var n=Object(c.a)(r);function r(){var e;Object(s.a)(this,r);for(var t=arguments.length,a=new Array(t),l=0;l<t;l++)a[l]=arguments[l];return(e=n.call.apply(n,[this].concat(a))).state={tournamentDict:{},loading:!0,loadingOverride:!1,register:!1,errorMessage:"",lines:[],linesMounted:!1,linesAdjusted:!1,selected:"",hovered:""},e.setTournamentID=function(t){return e.validateTournament(t).then((function(){j.d.set("tournamentID",t,{path:"/"}).catch(console.error),e.props.setTournamentID(t)})).catch((function(){j.d.remove("tournamentID").catch(console.error),e.props.setTournamentID("")}))},e.updateTournamentDict=function(){return Object(j.b)({url:"/tournaments"}).then((function(t){return e.setState({tournamentDict:t}),t})).catch((function(t){return console.error(t),e.props.endSession(),{}}))},e.createNewTournament=Object(o.a)(i.a.mark((function t(){var n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(j.c)({url:"/initialise"});case 3:if(n=t.sent){t.next=6;break}throw new Error;case 6:return e.props.setTournamentID(n.id),t.next=9,e.updateTournamentDict();case 9:t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),(a=t.t0).response&&401!==a.response.status||e.props.endSession();case 15:case"end":return t.stop()}}),t,null,[[0,11]])}))),e.removeID=function(){var t=Object(o.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=6;break}return t.next=3,Object(j.c)({url:"/closeAuthorization/all"});case 3:e.setState({tournamentDict:{}}),t.next=11;break;case 6:return delete(a=e.state.tournamentDict)[n],t.next=10,Object(j.c)({url:"/closeAuthorization/"+n});case 10:e.setState({tournamentDict:a});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.logoRef=m.a.createRef(),e.drawLines=function(){if(e.logoRef.current){for(var t=e.getElementCentre(e.logoRef.current),n=[],a=0,r=Array.from(document.getElementsByClassName(_.a.dot));a<r.length;a++){var i=r[a];"0"!==i.style.opacity&&n.push(e.renderLineBetween(i.id,t,e.getElementCentre(i),2))}e.setState({lines:n,linesMounted:!0}),setTimeout((function(){return e.setState({linesAdjusted:!0})}),3e3)}},e}return Object(l.a)(r,[{key:"validateTournament",value:function(e){return e?Object.values(this.state.tournamentDict).length?e in this.state.tournamentDict?Promise.resolve():Promise.reject():this.updateTournamentDict().then((function(t){if(void 0===t[e])throw new Error})):Promise.reject()}},{key:"getElementCentre",value:function(e){var t=e.getBoundingClientRect();return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2-30}}},{key:"renderLineBetween",value:function(e,t,n,a){var r=Math.abs(n.x-t.x),i=Math.abs(n.y-t.y),o=Object(N.a)(n.x-t.x,n.y-t.y),s=Math.sign((n.x-t.x)*(n.y-t.y)),l=180*Math.atan(i/r)/Math.PI;return m.a.createElement("div",{key:["line",n.x,n.y].join("."),className:_.a.line,style:{width:o+"px",height:a+"px",backgroundColor:"white",position:"absolute",left:this.state.linesMounted?(t.x+n.x)/2-r/2:t.x-r/2,top:this.state.linesMounted?(t.y+n.y)/2:t.y,transform:"rotate(".concat(l*s,"deg) scaleX(").concat(this.state.linesMounted?1:0,") scaleY(1)"),opacity:this.state.linesMounted?1:0,transition:"transform 3s, left 3s, top 3s, opacity 3s"}})}},{key:"handleNavData",value:function(e,t){var n=this,r=this.navData,s=e.reduce((function(e,t){return t in r?(e[t]=r[t],e):e}),{});return Object.entries(s).reduce((function(e,r,s){var l=Object(a.a)(r,2),c=l[0],u=l[1],d=[m.a.createElement("div",{className:[_.a.dotDescription,n.state.selected===c?_.a.descriptionSelected:""].join(" "),key:["navData",t,"description",s].join(".")},u.description),m.a.createElement(O.a,{key:["navData",t,"dot",s].join("."),radius:"50px",className:[_.a.dot,n.state.linesAdjusted?"":_.a.dotUnloaded].join(" "),id:c,content:u.content,onClick:function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.state.selected!==c){e.next=4;break}n.setState({selected:""}),e.next=7;break;case 4:return e.next=6,u.onClick(t);case 6:u.noSet||n.setState({selected:c});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onMouseEnter:function(){return n.setState({hovered:"back"})},onMouseLeave:function(){return n.setState({hovered:""})},style:u.style})];return"right"===t&&(d=d.reverse()),e.push(m.a.createElement("div",{className:[_.a.dotContainer,n.state.linesAdjusted?_.a.dotContainerLoaded:""].join(" "),key:["NavData",t,"div",s].join("i")},d)),e}),[])}},{key:"componentDidUpdate",value:function(e,t){this.state.selected!==t.selected&&this.drawLines()}},{key:"componentDidMount",value:function(){var t=Object(o.a)(i.a.mark((function t(){var n,a=this;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.d.get("tournamentID");case 2:(n=t.sent)?this.props.setTournamentID(n):this.updateTournamentDict(),window.addEventListener("resize",this.drawLines),this.drawLines(),e(this.drawLines),setTimeout((function(){return a.setState({loading:!1})}),3e3);case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){window.addEventListener("resize",this.drawLines)}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:v.a.canvas},this.state.lines,m.a.createElement("div",{className:[v.a.column,_.a.leftColumn].join(" ")},function(){switch(e.state.selected){case"load":return e.handleNavData(["refresh","close","load"],"left");case"settings":default:return e.handleNavData(["create","settings","load"],"left")}}()),m.a.createElement("div",{ref:this.logoRef,className:[v.a.column,_.a.column].join(" ")},m.a.createElement(E.a,{setLoading:function(t){return e.setState({loadingOverride:t})},loading:this.state.loading||this.state.loadingOverride,classNames:{logo:_.a.logo}})),m.a.createElement("div",{className:[v.a.column,_.a.rightColumn].join(" ")},function(){switch(e.state.selected){case"load":return m.a.createElement(B,{setTournamentID:e.props.setTournamentID,createNewTournament:e.createNewTournament,removeID:e.removeID,updateTournamentSettings:e.updateTournamentDict,tournamentDict:e.state.tournamentDict,closeListing:function(){return e.setState({selected:""})},triggerConfirm:e.props.triggerConfirm});case"settings":return m.a.createElement(T,{updateTournamentSettings:function(){return Promise.resolve()},updateSetting:function(){return Promise.resolve()},settings:{},closeListing:function(){return e.setState({selected:""})}});default:return e.handleNavData(["back"],"right")}}()))}},{key:"navData",get:function(){var e=this;return{create:{onClick:this.createNewTournament,content:m.a.createElement(k.g,null),description:"Create new Swiss tournament"},roundRobin:{onClick:function(){},content:m.a.createElement(P.a,null),description:"Create new Round-Robin tournament"},settings:{onClick:function(){},content:m.a.createElement(x.d,null),description:"User settings"},load:{onClick:this.updateTournamentDict,content:m.a.createElement(C.a,null),description:"Load previous tournaments"},back:{onClick:this.props.endSession,content:m.a.createElement(x.e,null),description:"Exit to login"},close:{onClick:function(){return e.props.triggerConfirm("Delete all saved tournaments?",e.removeID,(function(){}))},noSet:!0,content:m.a.createElement(x.f,null),description:"Close all tournaments",style:{border:"8px solid darkred"}},refresh:{onClick:this.updateTournamentDict,noSet:!0,content:m.a.createElement(D.b,null),description:"Refresh tournament list",style:{border:"8px solid darkblue"}}}}}]),r}(m.a.Component),B=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={height:0},e.listing=m.a.createRef(),e.renderHeight=function(){e.listing.current&&e.setState({height:e.listing.current.getBoundingClientRect().height})},e}return Object(l.a)(n,[{key:"generateListing",value:function(e){var t=this,n=Object.keys(e).reduce((function(e,n){var a=t.props.tournamentDict[n];return a?(e[a]||(e[a]=0),e[a]++,e):e}),{});return Object.entries(e).map((function(e,r){var i=Object(a.a)(e,2),o=i[0],s=i[1],l=void 0===n[s]?o:1===n[s]?s:s+"\n"+o;return m.a.createElement("div",{className:[y.a.row,_.a.row].join(" "),key:["row",r].join(".")},m.a.createElement("div",{className:[_.a.clickButton,"fieldBox"].join(" "),onClick:function(){return t.props.setTournamentID(o)}},l),m.a.createElement("div",{className:[_.a.clickButton,_.a.close,"fieldBox"].join(" "),onClick:function(){t.props.triggerConfirm("Delete tournament '"+l+"'?",(function(){return t.props.removeID(o)}),(function(){}))}},m.a.createElement(x.c,null)))})).filter((function(e){return e}))}},{key:"componentDidMount",value:function(){setTimeout(this.renderHeight,1e3)}},{key:"render",value:function(){return m.a.createElement("div",{className:y.a.sidebar},m.a.createElement("div",{className:y.a.profile},m.a.createElement("div",{className:"topBanner"},"Load Tournament"),m.a.createElement("div",{className:_.a.listWrapper,style:{height:this.state.height}},m.a.createElement("div",{ref:this.listing,className:_.a.listing},this.generateListing(this.props.tournamentDict)))),m.a.createElement("div",{className:"bottomBanner"},m.a.createElement("div",{onClick:this.props.createNewTournament,className:"button"},m.a.createElement(P.b,null)),m.a.createElement("div",{onClick:this.props.closeListing,className:"button"},m.a.createElement(x.e,null))))}}]),n}(m.a.Component),T=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"renderSettings",value:function(){var e=this;return Object.entries(w.b).map((function(t,n){var r=Object(a.a)(t,2),i=r[0],o=r[1],s=e.props.settings[i]||o.defaultValue,l=!1;o.locked&&(l=!0);var c=o.convert?o.convert(s):s,u="undefined"!==typeof c?c.toString():"\u200b";return m.a.createElement("div",{className:y.a.row,key:["row",n].join(".")},m.a.createElement("div",{className:"fieldBox"},o.name+":"),"number"===o.type?m.a.createElement(S.a,{handleSubmit:e.props.updateSetting,content:u,url:f.a.resolve(j.e,["updateUserSetting"].join("/")),inputType:"number",onSubmitSuccess:function(t){return e.props.updateTournamentSettings(),t},additionalStyles:{editableField:y.a.editableField,input:y.a.input},name:i,additionalInputProps:{},show:{submit:!0,increment:!0}}):m.a.createElement("div",{className:["fieldBox",l?y.a.locked:y.a.editable].join(" "),onClick:l?function(){}:function(){return e.props.updateSetting(i,s)}},u))}))}},{key:"render",value:function(){return m.a.createElement("div",{className:y.a.sidebar},m.a.createElement("div",{className:y.a.profile},m.a.createElement("div",{className:"topBanner"},"Settings"),this.renderSettings(),m.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},m.a.createElement("div",{style:{transform:"rotate(-30deg)"}},"This feature is in beta"))),m.a.createElement("div",{className:"bottomBanner"},m.a.createElement("div",{onClick:this.props.closeListing,className:"button"},m.a.createElement(x.e,null))))}}]),n}(m.a.Component)}).call(this,n(89).setImmediate)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(22),r=n(1),i=n.n(r);function o(e){return i.a.createElement("span",{id:e.id,className:e.className,style:Object(a.a)({height:e.radius,width:e.radius,lineHeight:e.radius,borderRadius:"50%",display:"inline-block",cursor:"default"},e.style),onClick:e.onClick,onMouseEnter:e.onMouseEnter},e.content)}},,function(e,t,n){e.exports=n(91)},,,,,function(e,t,n){},,function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(36),o=(n(64),n(4)),s=n.n(o),l=n(7),c=n(8),u=n(9),d=n(12),m=n(13),p=(n(66),n(42)),f=n(14),g=n(28),v=n(30),h=n.n(v),y=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={name:""},e.minimise=function(){f.e.minimize()},e.close=function(){f.e.close()},e.toggleMaximisation=function(){e.maximised?(f.e.restore(),e.forceUpdate()):(f.e.maximize(),e.forceUpdate())},e}return Object(u.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:h.a.statusBar},r.a.createElement("div",{className:h.a.title},"Tournament by Oxford Chess Development"),r.a.createElement("div",{className:h.a.menu},r.a.createElement("div",{className:h.a.favicon},r.a.createElement("img",{alt:"favicon",draggable:!1,src:"./logo192.png"}))),r.a.createElement("div",{className:h.a.exec},r.a.createElement("div",{onClick:this.minimise},r.a.createElement(g.e,null)),r.a.createElement("div",{onClick:this.toggleMaximisation},this.maximised?r.a.createElement(g.f,null):r.a.createElement(g.d,null)),r.a.createElement("div",{onClick:this.close,className:h.a.close},r.a.createElement(g.c,null))))}},{key:"maximised",get:function(){return f.e.isMaximized()}}]),n}(r.a.Component),b=n(22),_=n(32),E=n(29),j=n(3),O=n(2),N=n(19),w=n.n(N),S=n(24),x=n.n(S),k=n(26),C=n(25),D=n(15),P=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t=!1;t="undefined"!==typeof this.props.lastRoundOverride?this.props.lastRoundOverride:this.props.settings.totalRounds===this.props.status.round;var n=w.a.resolve(O.e,["tournament",this.props.status.id,"setName"].join("/"));return r.a.createElement("div",{className:x.a.titleBar,style:{gridColumn:"2 /span 1"}},r.a.createElement("div",{className:x.a.row},r.a.createElement("div",{className:["topBanner",x.a.header].join(" ")},r.a.createElement(k.a,{content:this.props.status.name,url:n,inputType:"text",handleSubmit:function(e,t){return Object(O.c)({url:n,data:Object(_.a)({},e,t)})},additionalStyles:x.a,additionalInputProps:{},onSubmitSuccess:function(t){return e.props.updateTournamentStatus(),t},defaultContent:"Unnamed Swiss Tournament"}))),r.a.createElement("div",{className:x.a.row},r.a.createElement("div",{className:"topBanner "+x.a.header},"ID: ",this.props.status.id),r.a.createElement("div",{className:"topBanner "+x.a.header},"Round: ",this.props.status.round?this.props.status.round+" / "+("Infinity"===this.props.totalRounds?"\u221e":this.props.totalRounds):"Not yet initialised")),r.a.createElement("div",{className:x.a.row},r.a.createElement("div",{className:"button",onClick:this.props.closeTournament},r.a.createElement("span",{role:"img","aria-label":"back"},r.a.createElement(C.a,null))),r.a.createElement("div",{className:"button",onClick:function(){e.props.status.round>=e.props.settings.totalRounds&&e.props.triggerError("Increase the number of rounds in Settings to continue!"),e.props.setLastRound(!t)}},r.a.createElement("span",{role:"img","aria-label":"decommission"},t?r.a.createElement(D.h,null):r.a.createElement(C.c,null))),r.a.createElement("div",{className:"button",onClick:this.props.toggleCrossTable},r.a.createElement(D.g,null))))}}]),n}(r.a.Component),I=n(17),B=n.n(I),T=n(16),R=n(41);function L(e){var t=Object(a.useMemo)((function(){return e.status.round}),[e.status.round]),n=Object(a.useCallback)((function(n,a){var r=a.id,i=a.W,o=a.B;return n.set(r,[i?i.histories?i.histories[t][e.settings.displayPoints]:null:0,o?o.histories?o.histories[t][e.settings.displayPoints]:null:0]),n}),[t,e.settings.displayPoints]),i=Object(a.useState)([]),o=Object(j.a)(i,2),c=o[0],u=o[1],d=Object(a.useReducer)(n,new Map),m=Object(j.a)(d,2),p=m[0],f=m[1],g=Object(a.useCallback)((function(){if(t)return Object(O.b)({url:"/tournament/"+e.id+"/getPairings"}).then((function(t){var n,a=Object(E.a)(t);try{for(a.s();!(n=a.n()).done;){var r=Object(j.a)(n.value,2),i=r[0],o=r[1];f({id:i+"."+o,W:e.playerDict.get(i),B:e.playerDict.get(o)})}}catch(s){a.e(s)}finally{a.f()}u(t)})).catch(console.error)}),[e.id,u,f,t,e.playerDict]);function v(t,n){return n?"bye"===t?"BYE":(a="individual"===e.settings.competitors?[n.firstName,n.lastName].join(" "):n.firstName,"".concat(a," [").concat(n.score,"]")):t;var a}var h=Array.from(p.values()).filter((function(e){return e.every((function(e){return null===e}))})),y=function(){return Object(O.b)({url:"/tournament/"+e.id+"/getNextPairings"}).then((function(e){return u(e)})).then((function(){g(),e.updatePlayerDict()})).then(e.updateRound).catch(console.error)};function b(t){if(""!==t.resultWhite.value||""!==t.resultBlack.value)return!!Array.from(t).every((function(e){return e.validity.valid}))&&(!e.settings.gamePointTotal||(Number(t.resultWhite.value)+Number(t.resultBlack.value)===("game"===e.settings.displayPoints?e.settings.gamePointTotal:1)||"Setting: sum results to "+e.settings.gamePointTotal))}return Object(a.useEffect)((function(){g()}),[g,t]),r.a.createElement("div",{className:B.a.pairings},r.a.createElement("div",{className:["topBanner",B.a.topBanner].join(" ")},"Pairings"),r.a.createElement("div",{className:B.a.pairingContainer},function(){var t,n=[],a=e.playerDict,i=Object(E.a)(c);try{for(i.s();!(t=i.n()).done;){var o,u,d=Object(j.a)(t.value,2),m=d[0],f=d[1],h=[a.get(m),a.get(f)],y=h[1],_=[v(m,h[0]),v(f,y)],O=_[0],N=_[1],w=m+"."+f,S=p.get(w);S&&n.push(r.a.createElement("div",{id:w,className:B.a.pairing,key:["pairings",m,f].join(".")},r.a.createElement("div",{className:["playerInfo",B.a.playerInfo,"bye"===m?B.a.bye:""].join(" "),id:m,onClick:function(t){return e.setDisplayPlayer(t.target.id)}},O),null!==S[0]||null!==S[1]?r.a.createElement("div",{className:B.a.resultsBridge},r.a.createElement("div",{className:B.a.setResult},null!==(o=S[0])&&void 0!==o?o:"\u200b"),r.a.createElement("div",{className:B.a.neutral},r.a.createElement(T.f,null)),r.a.createElement("div",{className:B.a.setResult},null!==(u=S[1])&&void 0!==u?u:"\u200b")):r.a.createElement(k.b,{tournamentID:e.id,className:B.a.resultsBridge,inputClassName:B.a.inputResult,hidden:{W:m,B:f},validate:b,handleSubmit:function(){var t=Object(l.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.updatePlayerDict();case 2:return g(),t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),r.a.createElement("div",{className:["playerInfo",B.a.playerInfo,B.a.playerInfo,"bye"===f?B.a.bye:""].join(" "),id:f,onClick:function(t){return e.setDisplayPlayer(t.target.id)}},N)))}}catch(x){i.e(x)}finally{i.f()}return n}()),r.a.createElement("div",{className:["bottomBanner",B.a.statusBar].join(" ")},r.a.createElement("div",{className:["button"].join(" "),onClick:e.toggleSidebar},r.a.createElement(R.a,null)),function(){var t;return t=e.status.round>=e.settings.totalRounds||"undefined"!==typeof e.lastRoundOverride&&e.lastRoundOverride,e.canTriggerNextRound?h.length>0?r.a.createElement("div",{className:[B.a.waitButton].join(" ")},"Awaiting ".concat(h.length," result").concat(h.length>1?"s":"")):t?r.a.createElement("div",{className:[B.a.finishButton,"button"].join(" "),onClick:e.toggleCrossTable},"Final Standings"):r.a.createElement("div",{className:[B.a.nextButton,"button"].join(" "),onClick:y},"Next Round"):r.a.createElement("div",{className:[B.a.waitButton].join(" ")},"Tournament must have at least 2 active players")}(),r.a.createElement("div",{className:["button"].join(" "),onClick:e.toggleSettings},r.a.createElement(D.d,null))))}var F=n(34),M=n(55),A=n.n(M),q=n(11),V=n.n(q);function H(){for(var e=[],t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s){var l=Object(j.a)(s,3),c=l[0],u=l[1],d=l[2];e.push(r.a.createElement("div",{key:["button",d].join("."),onClick:c,className:"button"},u))}}return e}var U=n(5),z=n.n(U);function K(){return r.a.createElement("div",{className:z.a.sectionContainer},r.a.createElement("div",{className:[z.a.sectionHeader,"topBanner"].join(" ")},r.a.createElement("div",{className:z.a.sectionHeaderText})))}function W(e){var t=Object(a.useState)(e.expanded||!0),n=Object(j.a)(t,2),i=n[0],o=n[1],s=e.useInternalState?i:e.expanded;return Object(a.useEffect)((function(){for(var e=0,t=Array.from(document.querySelectorAll("."+[z.a.sectionListWrapper].join(".")));e<t.length;e++){var n=t[e],a=n.firstElementChild;n.style.height=n.className.includes(z.a.expanded)?a.getBoundingClientRect().height+"px":"0px"}}),[s]),r.a.createElement("div",{className:z.a.sectionContainer,style:e.style},r.a.createElement("div",{className:[z.a.sectionHeader,"topBanner"].join(" ")},r.a.createElement("div",{className:z.a.sectionHeaderText,onClick:function(){return e.useInternalState?o(!s):e.setExpanded(!s,e.value)}},e.header),e.children.length?r.a.createElement("div",{className:z.a.sectionToggle,onClick:function(){return e.useInternalState?o(!s):e.setExpanded(!s,e.value)}},r.a.createElement(T.e,{style:{transform:s?"rotate(-90deg)":"rotate(0deg)"}})):null),r.a.createElement("div",{className:[z.a.sectionListWrapper,s?z.a.expanded:""].join(" "),style:{height:"0px"}},r.a.createElement("div",{className:[z.a.sectionList].join(" "),id:e.id},e.children)))}var G=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];return(e=t.call.apply(t,[this].concat(o))).state={round:0,players:{},linkedState:{}},e.updatePlayerList=function(){var t=Object(l.a)(s.a.mark((function t(n){var a,r,i,o,l,c,u,d,m;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===n){t.next=6;break}return t.next=3,e.updatePlayerState();case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0={round:e.state.round,players:e.state.linkedState};case 7:for(a=t.t0,r=a.round,i=a.players,o={},l=0,c=Object.entries(i);l<c.length;l++)u=Object(j.a)(c[l],2),d=u[0],m=u[1],o[d]=m.map((function(t){return e.props.playerDict.get(t)})).sort((function(e,t){return t.rating-e.rating})).filter((function(e){return e}));e.setState({round:r,players:o}),e.props.checkIfEnoughPlayers(!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updatePlayerState=function(){return Object(O.b)({url:"/tournament/"+e.props.id+"/getState"}).then((function(t){var n=t.round,a=t.players;return e.setState({linkedState:a}),{round:n,players:a}}))},e.editToDisplay=function(t,n){for(var a=t;a.parentElement&&a.id!==n.id;)a=a.parentElement;var r=a.parentElement.cloneNode();Object(i.render)(e.generateActivePlayer(n,0),r),a.replaceWith(r.firstChild)},e.editEscape=function(t,n){27===t.keyCode&&e.editToDisplay(t.target,n)},e.editPlayer=function(t){var n=t.target;if("HTMLButtonElement"===n.constructor.name){var a=n.parentNode,r=a.id,o=a.parentNode.id.split(".").slice(1).join("."),s=e.state.players[o.toString()].find((function(e){return e.id===r}));a.innerHTML="";var l=e.generateForm(r,s.firstName,s.lastName,s.rating,s);Object(i.render)(l,a),a.firstChild.firstChild.firstChild.focus()}},e.activatePlayer=function(t){var n=t.target;if("HTMLButtonElement"===n.constructor.name){var a=n.parentNode.id;Object(O.b)({url:"/tournament/"+e.props.id+"/activatePlayer",params:{id:a}}).then((function(){return e.updatePlayer(a)})).catch(console.error)}},e.clearPlayer=function(t){var n=t.target;if("HTMLButtonElement"===n.constructor.name){var a=n.parentNode.id;Object(O.b)({url:"/tournament/"+e.props.id+"/clearPlayer",params:{id:a}}).then((function(){return e.updatePlayer(a)})).catch(console.error)}},e.clearPlayerList=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(O.b)({url:"/tournament/"+e.props.id+"/clearPlayers"}).catch(console.error);case 2:e.props.checkIfEnoughPlayers();case 3:case"end":return t.stop()}}),t)}))),e.handlePaste=function(t){var n=t.clipboardData.getData("text").toString();if(n.trim()&&(n.split("\n").length||!n.split(",").length||!n.split("\t").length)){t.preventDefault();var a=A.a.parse(n,{delimitersToGuess:[",","\t"],dynamicTyping:!0,fastMode:!0}).data.map((function(t){var a=Object(j.a)(t,3),r=a[0],i=a[1],o=a[2];if(!e.requireLastName){var s=[].concat(Object(F.a)(t),[""]);r=s[0],o=s[1],i=s[2]}if(!r||!i&&e.requireLastName||null===o||void 0===o)return null;try{if("string"!==typeof r)throw[r,"string"].join(",");if("string"!==typeof i&&e.requireLastName)throw[i,"string"].join(",");if("number"!==typeof o)throw[o,"number"].join(",");return{firstName:r,lastName:i,rating:o}}catch(c){if(!n.split("\n").length)return null;var l=c.split(",");return console.error(new TypeError("Bad input on row "+t.join(",")+"\n"+l[0]+" is not type "+l[1])),null}})).filter((function(e){return e}));Object(O.c)({url:"tournament/"+e.props.id+"/appendPlayers",data:a}).then((function(){return Promise.all([e.props.updatePlayerDict(),e.updatePlayerList()])}))}},e.generateActivePlayer=function(t,n){var a=e.requireLastName?[t.firstName,t.lastName].join(" "):t.firstName;return r.a.createElement("div",{key:["playerLine",n].join("."),id:t.id,className:V.a.playerLine},r.a.createElement("div",{className:["playerInfo",V.a.playerInfo,t.active?"":V.a.playerInactive].join(" "),style:{gridColumn:e.state.round&&!e.props.settings.allowNewPlayers?"1 / span 3":void 0},onClick:function(t){return e.props.setDisplayPlayer(t.target.parentElement.id)}},a," (",t.rating.toString(),") ",e.state.round&&t.played<e.state.round?"*":""),e.state.round&&!e.props.settings.allowNewPlayers?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{name:"edit",className:V.a.edit,onClick:e.editPlayer},r.a.createElement(T.a,null)),t.active?r.a.createElement("button",{name:"cancel",className:V.a.cancel,onClick:e.clearPlayer},r.a.createElement(T.c,null)):r.a.createElement("button",{name:"active",className:V.a.activate,onClick:e.activatePlayer},r.a.createElement(T.b,null))))},e.prevPropsPlayerDict=new Map,e.prevPropsPlayerDictKey=void 0,e}return Object(u.a)(n,[{key:"updatePlayer",value:function(e){var t=this;return Object(O.b)({url:"/tournament/"+this.props.id+"/fetchPlayer",params:{id:e}}).then((function(e){return t.props.modifyPlayerDict(e),e}))}},{key:"generateForm",value:function(e,t,n,a,i){var o=this;return r.a.createElement("div",{key:["scoreSectionEdited",e].join("."),className:V.a.scoreSection},r.a.createElement("form",{target:"_self",onKeyDown:function(e){return o.editEscape(e,i)},onSubmit:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(O.a)(t).then(o.updatePlayerList).then(Object(l.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.updatePlayer(i.id);case 2:n=e.sent,o.editToDisplay(t.target,n);case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),method:"POST",action:w.a.resolve(O.e,["tournament",this.props.id,"editPlayer"].join("/"))},r.a.createElement("input",{type:"text",className:V.a.input,name:"firstName",defaultValue:t,required:!0,style:{width:this.requireLastName?"25%":"65%"}}),r.a.createElement("input",{type:"text",className:V.a.input,name:"lastName",defaultValue:n,required:this.requireLastName,style:{width:"40%",display:this.requireLastName?"block":"none"}}),r.a.createElement("input",{type:"number",className:V.a.input,min:0,max:3200,name:"rating",defaultValue:a,required:!0,style:{width:"20%"}}),r.a.createElement("input",{type:"hidden",name:"id",value:e,required:!0}),r.a.createElement("button",{tabIndex:-1,className:V.a.submit},r.a.createElement(T.b,null))))}},{key:"generateNewForms",value:function(e){for(var t=this,n=new Array(e),a=0;a<e;a++){var i=["playerForm",a].join(".");n[a]=r.a.createElement("form",{id:["addPlayerForm",a].join("."),ref:i,key:i,target:"_self",onSubmit:function(e){return Object(O.a)(e).then((function(){e.target.reset()})).then((function(){return Promise.all([t.props.updatePlayerDict(),t.updatePlayerList()])})).then((function(){t.refs["playerForm.0"].childNodes[0].focus()}))},method:"POST",action:w.a.resolve(O.e,["tournament",this.props.id,"appendPlayer"].join("/"))},r.a.createElement("input",{type:"text",className:V.a.input,name:"firstName",placeholder:this.requireLastName?"First name":"Team name",required:!0,style:{width:this.requireLastName?"25%":"65%"},onPaste:this.handlePaste}),r.a.createElement("input",{type:"text",className:V.a.input,name:"lastName",placeholder:"Last name",required:this.requireLastName,style:{width:"40%",display:this.requireLastName?"block":"none"}}),r.a.createElement("input",{type:"number",className:V.a.input,min:0,max:3200,name:"rating",placeholder:this.requireLastName?"Rating":"Av. Rating",required:!0,style:{width:"20%"}}),r.a.createElement("button",{tabIndex:-1,className:V.a.submit},r.a.createElement(T.b,null)))}return n}},{key:"generateActivePlayerList",value:function(){for(var e=[],t=this.state.players,n=this.state.round;n>=0;n-=.5){var a=n.toString();if(t[a]&&t[a].length){var i=r.a.createElement(W,{header:a+" points",useInternalState:!0,id:["container",a].join(".")},t[a].map(this.generateActivePlayer));e.push(i)}}return e}},{key:"componentDidUpdate",value:function(){var e=this;if(this.props.playerDict.size){if(Array.from(this.props.playerDict.keys()).some((function(t){return!e.prevPropsPlayerDict.get(t)})))return this.triggerReload();if(this.props.playerDictKey!==this.prevPropsPlayerDictKey)return this.triggerReload();var t=Array.from(this.props.playerDict.values()),n=Array.from(this.prevPropsPlayerDict.values());return JSON.stringify(n)!==JSON.stringify(t)?this.triggerReload():void 0}}},{key:"triggerReload",value:function(){this.prevPropsPlayerDictKey=this.props.playerDictKey,this.updatePlayerList(),this.prevPropsPlayerDict=this.props.playerDict}},{key:"componentDidMount",value:function(){this.updatePlayerList()}},{key:"render",value:function(){var e=this;if(this.props.wideLeft)return null;var t=this.generateActivePlayerList(),n=this.generateNewForms(Math.max(1,10-Object.values(this.state.players).reduce((function(e,t){return e+t.length}),0)));return r.a.createElement("div",{className:V.a.sidebar},r.a.createElement("div",{className:V.a.topBanner},"Tournament Players"),r.a.createElement("div",{className:V.a.playersSection},t.length?null:r.a.createElement("div",{className:V.a.scoreSection},r.a.createElement("div",{className:V.a.playerLine},r.a.createElement("div",{className:V.a.sectionHeader},t.length?"Player List":"No players added yet"))),t,this.state.round&&!this.props.settings.allowNewPlayers?r.a.createElement("div",{className:V.a.scoreSection},n):null,r.a.createElement(K,null)),r.a.createElement("div",{className:"bottomBanner"},H([Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.updatePlayerDict(),e.updatePlayerList();case 2:case"end":return t.stop()}}),t)}))),r.a.createElement(C.b,null),"refresh"],0===this.state.round?[Object(l.a)(s.a.mark((function t(){var n,a,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0,a=Object.values(e.refs);case 1:if(!(n<a.length)){t.next=9;break}if("HTMLFormElement"===(r=a[n]).constructor.name){t.next=5;break}return t.abrupt("continue",6);case 5:r.reset();case 6:n++,t.next=1;break;case 9:if(0===e.state.round){t.next=11;break}return t.abrupt("return");case 11:return t.next=13,e.clearPlayerList();case 13:e.updatePlayerList();case 14:case"end":return t.stop()}}),t)}))),r.a.createElement(D.f,null),"close"]:null)))}},{key:"requireLastName",get:function(){return"individual"===this.props.settings.competitors}}]),n}(r.a.Component),X=n(6),Y=n.n(X),J=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={playerID:"",player:null},e}return Object(u.a)(n,[{key:"updatePlayerFromProps",value:function(e){var t=this;if(this.setState({playerID:this.props.playerID}),this.props.playerID){if(!1!==e)return Object(O.b)({url:"/tournament/"+this.props.id+"/fetchPlayer",params:{id:this.props.playerID}}).then((function(e){e.histories[0]||(e.histories[0]=null),t.setState({player:e})}));var n=this.props.playerDict.get(this.props.playerID);this.setState({player:n})}else this.setState({player:null})}},{key:"getNameFromPlayer",value:function(e){return e?"individual"===this.props.settings.competitors?[e.firstName,e.lastName].join(" "):e.firstName:"\u200b"}},{key:"componentDidUpdate",value:function(e){(this.state.playerID!==this.props.playerID||this.props.playerDictKey!==e.playerDictKey)&&this.updatePlayerFromProps(!1)}},{key:"getDisplayName",value:function(e){if(e){if("bye"===e)return"BYE";var t=this.props.playerDict.get(e);return t?"individual"===this.props.settings.competitors?[t.firstName,t.lastName].join(" "):t.firstName:e}}},{key:"renderEntry",value:function(e,t){var n=this,a=Object(j.a)(e,2),i=a[0],o=a[1];return"Playing"===i&&o?r.a.createElement("div",{className:Y.a.row,key:["row",t].join(".")},r.a.createElement("div",{className:"fieldBox"},i+":"),r.a.createElement("div",{className:"playerInfo",id:o,onClick:function(e){return n.props.setDisplayPlayer(e.target.id)}},o)):r.a.createElement("div",{className:Y.a.row,key:["row",t].join(".")},r.a.createElement("div",{className:"fieldBox"},i+":"),r.a.createElement("div",{className:"fieldBox"},null!==o&&void 0!==o?o:"\u200b"))}},{key:"render",value:function(){var e=this;if(!this.state.player)return null;var t=this.state.player,n=this.getNameFromPlayer(t),a=t?{"Unique ID":t.id,Status:!1!==t.active?"Active":"Inactive",Rating:t.rating,"Performance rating":t.performanceRating,Playing:this.getDisplayName(t.isPlaying)}:{},i=(Math.max(t.histories.length,1)-1-(t.isPlaying?1:0)).toString(),o=t.histories.slice(1).reduce((function(e,t){return e+t.played}),0),s=t?{Score:t.score.toString()+" / "+i,"Game score":t.gamePoints.toString()+" / "+o.toString(),"Expected score":t.expectedScore.toFixed(2),"Expected game score":t.expectedGameScore.toFixed(2)+" / "+o}:{};this.props.settings.displayPoints||(delete s["Game score"],delete s["Expected game score"]);var l=t.histories;return r.a.createElement("div",{className:Y.a.sidebar},r.a.createElement("div",{className:Y.a.profile},r.a.createElement("div",{className:"topBanner"},n),Object.entries(a).map(this.renderEntry),r.a.createElement(W,{header:"Score",useInternalState:!0,style:{gridColumn:"1 / span 2"}},Object.entries(s).map(this.renderEntry)),r.a.createElement(W,{header:"Results",useInternalState:!0,style:{gridColumn:"1 / span 2"}},l.map((function(t,n){if(0===n||!t)return null;var a=t.id,i=t.colour,o=t[e.props.settings.displayPoints];return r.a.createElement("div",{className:Y.a.resultsRow,key:["row","history",n].join(".")},r.a.createElement("div",{className:"fieldBox"},n),r.a.createElement("div",{className:"playerInfo",id:a,onClick:function(t){return e.props.setDisplayPlayer(t.target.id)}},e.getDisplayName(a)),r.a.createElement("div",{className:"fieldBox"},i||"\u200b"),r.a.createElement("div",{className:"fieldBox"},"undefined"!==typeof o&&null!==o?o:"\u200b"))}))),r.a.createElement(K,null)),r.a.createElement("div",{className:"bottomBanner"},H([function(){return e.props.setDisplayPlayer("")},r.a.createElement(D.f,null),"close"])))}}]),n}(r.a.Component),Q=n(38),Z=n(23),$=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={sectionExpando:"general"},e.handleToggle=function(t,n,a){try{var r;if(a.enum){var i=a.enum.indexOf(n);-1===i&&console.error("Invalid setting value "+t+": "+n);var o=(i+1)%a.enum.length;r=a.enum[o]}else if("boolean"===a.type)r=!n;else if("number"===a.type){if("Infinity"===n||"\u221e"===n?r=1/0:n=Number(n),"totalRounds"===t){if(n<=e.props.status.round)throw new Error("Can't make total number of rounds less than current round number");if(n!==1/0&&n>=100)throw new Error("Can't make total number of rounds more than 100")}return n}e.props.updateSetting(t,r)}catch(s){s&&s.message&&e.props.triggerError(s.message)}},e.modifyHeightValues=function(){for(var e=0,t=Array.from(document.querySelectorAll("."+[Y.a.sectionListWrapper].join(".")));e<t.length;e++){var n=t[e],a=n.firstElementChild;n.style.height=n.className.includes(Y.a.expanded)?a.getBoundingClientRect().height+"px":"0px"}},e.watchProps=Object.values(Q.a).reduce((function(e,t){for(var n=0,a=Object.values(t);n<a.length;n++){var r=a[n];r.show&&e.push.apply(e,Object(F.a)(Object.keys(r.show)))}return e}),[]),e.renderRound=function(t){return r.a.createElement("div",{className:[Y.a.row,Y.a.roundRow].join(" "),key:["row",t].join(".")},r.a.createElement("div",{className:"fieldBox"},"Round ".concat(t,":")),r.a.createElement(k.a,{handleSubmit:e.props.updateSetting,content:e.props.rounds[t]?e.props.rounds[t].toString():"",defaultEditContent:new Date(Date.now()).toISOString(),url:w.a.resolve(O.e,["tournament",e.props.status.id,"updateRound"].join("/")),inputType:"datetime-local",onSubmitSuccess:function(t){return e.props.updateRounds(),t},additionalStyles:{editableField:Y.a.editableField,input:Y.a.input},additionalInputProps:{},name:t.toString(),show:{submit:!0,increment:!0}}))},e.renderEntry=function(t,n){var a,i=Object(j.a)(t,2),o=i[0],s=i[1],l=!1;if(s.show)for(var c=0,u=Object.entries(s.show);c<u.length;c++){var d=Object(j.a)(u[c],2),m=d[0],p=d[1];e.props.settings[m]!==p&&(l=!0)}var f=!1;(s.locked||s.lockOnInit&&e.props.status.round)&&(f=!0);var g=null!==(a=e.props.settings[o])&&void 0!==a?a:s.defaultValue,v=s.convert&&!s.value?s.convert(g):g,h="undefined"!==typeof v?v.toString():"\u200b";return r.a.createElement("div",{className:Y.a.row,key:["row",n].join("."),style:{height:s.show?l?"0px":"29px":void 0}},r.a.createElement("div",{className:["fieldBox",s.show?Y.a.semiPresent:""].join(" ")},s.name,s.name.endsWith("?")?"":":"),f||s.value?r.a.createElement("div",{className:["fieldBox",Y.a.locked].join(" ")},s.value?s.convert(s.value(e.props.status,e.props.players)):h):"number"===s.type?r.a.createElement(k.a,{handleSubmit:e.props.updateSetting,content:h,url:w.a.resolve(O.e,["tournament",e.props.status.id,"updateSetting"].join("/")),inputType:"number",onSubmitSuccess:function(t){return e.props.updateTournamentSettings(),t},additionalStyles:{editableField:Y.a.editableField,input:Y.a.input},name:o,additionalInputProps:s.nb,show:Object(b.a)({submit:!0,increment:!0},s.allow)}):r.a.createElement("div",{className:["fieldBox",Y.a.editable].join(" "),onClick:function(){return e.handleToggle(o,g,s)}},h))},e}return Object(u.a)(n,[{key:"componentDidUpdate",value:function(e,t){var n,a=Object(E.a)(this.watchProps);try{for(a.s();!(n=a.n()).done;){var r=n.value;e.settings[r]!==this.props.settings[r]&&this.modifyHeightValues()}}catch(i){a.e(i)}finally{a.f()}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:Y.a.sidebar},r.a.createElement("div",{className:Y.a.profile},r.a.createElement("div",{className:"topBanner"},"Settings"),Object.entries(Q.a).map((function(t,n){var a=Object(j.a)(t,2),i=a[0],o=a[1];return r.a.createElement(W,{key:i,value:i,header:Object(Z.b)(i),expanded:e.state.sectionExpando===i,setExpanded:function(t,n){return e.setState({sectionExpando:t?n:""})}},Object.entries(o).map(e.renderEntry))})),function(){for(var t=[],n=e.props.settings.totalRounds===1/0||"Infinity"===e.props.settings.totalRounds?Math.max(e.props.rounds.length,1):e.props.settings.totalRounds,a=1;a<=n;a++)t.push(a);return r.a.createElement(W,{key:"rounds",value:"rounds",header:"Rounds",expanded:"rounds"===e.state.sectionExpando,setExpanded:function(t,n){return e.setState({sectionExpando:t?n:""})}},t.map(e.renderRound))}(),r.a.createElement(K,null)),r.a.createElement("div",{className:"bottomBanner"},H([this.props.toggleSettings,r.a.createElement(D.f,null),"close"])))}}]),n}(r.a.Component),ee=n(40),te=n(27),ne=n.n(te),ae=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={sortValue:"score",byRounds:!0},e.handleHeaderClick=function(t){t.startsWith("score.")||"expectedScore"!==t&&("prettyScore"===t&&(t="score"),e.setState({sortValue:t}))},e.calcLength=6,e}return Object(u.a)(n,[{key:"header",value:function(){for(var e=[],t=1;t<=this.totalRounds;t++)e.push(t.toString());return Object(b.a)({id:"",name:"Name",rating:"Rating"},Object.entries(e).reduce((function(e,t){var n=Object(j.a)(t,2),a=n[0],r=n[1];return e["score."+a]=r,e}),{}),{prettyScore:"Score",winPercentage:"TB",performanceRating:"Perf",ratingDifference:"P. +/-",expectedScore:"Expected",expectedDifference:"E. +/-"})}},{key:"classNames",value:function(){for(var e=[],t=1;t<=this.totalRounds;t++)e.push(ne.a.resultsCell);return["",""].concat(e,["","","","","",""])}},{key:"bodyByRounds",value:function(e){var t=this;return this.props.players.map((function(e){for(var n=[],a=1;a<=t.totalRounds;a++){var r=e.histories[a];a&&(r?"number"!==typeof r.match?n.push("*"):.5===r.match?n.push("\xbd"):void 0===r.oppRating?n.push(r.match.toString()+"b"):n.push(r.match.toString()):n.push(""))}var i=e.performanceRating-e.rating,o=e.score-e.expectedScore;return Object(b.a)({id:e.id,name:"individual"===t.props.settings.competitors?[e.firstName,e.lastName].join(" "):e.firstName,rating:e.rating},Object.entries(n).reduce((function(e,t){var n=Object(j.a)(t,2),a=n[0],r=n[1];return e["score."+a]=r,e}),{}),{score:e.score,prettyScore:e.score.toFixed(1)+" / "+e.played,winPercentage:0===e.played?"-":(100*e.score/e.played).toFixed(2),performanceRating:e.performanceRating?e.performanceRating.toFixed():"",ratingDifference:e.performanceRating?i>0?"+"+i.toString():i.toString():"",expectedScore:e.expectedScore.toFixed(2)+" / "+e.played,expectedDifference:o>0?"+"+o.toFixed(2):o.toFixed(2)})})).sort((function(t,n){return e.sortValue in t?("name"!==e.sortValue?(a=Number(t[e.sortValue]),r=Number(n[e.sortValue])):(a=t[e.sortValue],r=n[e.sortValue]),a!==r?r-a:n.rating-t.rating):0;var a,r})).map((function(e,n){var a=[["Ranking",n.toString()]].concat(Object(F.a)(Object.entries(e)));return a.filter((function(e){var t=Object(j.a)(e,1)[0];return"id"!==t&&"score"!==t})).map((function(n,i){var o=Object(j.a)(n,2),s=(o[0],o[1]),l=1===i,c=i>2&&i<a.length-t.calcLength;return r.a.createElement("div",{id:l?e.id:[s,i].join("."),key:[s,i].join("."),className:[ne.a.cell,c?ne.a.resultsCell:"",l?ne.a.playerBox:"",0===i?ne.a.firstColumn:""].join(" "),onClick:l?function(e){return t.props.setDisplayPlayer(e.target.id)}:function(){}},s||"\u200b")}))}))}},{key:"render",value:function(){var e=this.state.byRounds?this.bodyByRounds(this.state):this.bodyByRobin,t="Tournament '".concat(this.props.status.name||this.props.status.id,"' results after ").concat(this.props.status.round," rounds");return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:ne.a.titles},r.a.createElement("div",null,t),r.a.createElement("div",null,""),r.a.createElement("div",{className:["button",ne.a.closeButton].join(" "),onClick:this.props.show},r.a.createElement(C.a,null))),r.a.createElement(ee.a,{header:this.header(),body:e,styles:ne.a,bodyClassNames:this.classNames(),style:{gridColumn:"1 / span "+(2+(this.props.wide?1:0))},handleHeaderClick:this.handleHeaderClick}))}},{key:"bodyByRobin",get:function(){return[[]]}},{key:"totalRounds",get:function(){return this.props.status.round>this.props.settings.totalRounds||"Infinity"===this.props.settings.totalRounds?this.props.status.round:this.props.settings.totalRounds}}]),n}(r.a.Component),re=[30.8,38.4,30.8];function ie(e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),t.eventName=e,document.dispatchEvent(t)}function oe(e){var t=Object(a.useState)(re),n=Object(j.a)(t,2),i=n[0],o=n[1],c=Object(a.useState)(0),u=Object(j.a)(c,2),d=u[0],m=u[1],p=Object(a.useMemo)((function(){return i.reduce((function(e,t){var n;return e.push((null!==(n=e[e.length-1])&&void 0!==n?n:0)+t),e}),[]).slice(0,-1)}),[i]),f=Object(a.useState)(""),g=Object(j.a)(f,2),v=g[0],h=g[1],y=Object(a.useState)(!1),N=Object(j.a)(y,2),w=N[0],S=N[1],k=Object(a.useState)(void 0),C=Object(j.a)(k,2),D=C[0],I=C[1],B=Object(a.useState)(!1),T=Object(j.a)(B,2),R=T[0],F=T[1],M=function(){return S(!w)},A=Object(a.useCallback)((function(e,t){var n=t.set;if(0===i[0]){var a=i.slice(0);return a[0]=re[0],a[1]<re[0]?a=re:a[1]=a[1]-re[0],o(a),!0}return"boolean"===typeof n?n:!e}),[i,o]),q=Object(a.useCallback)((function(e,t){var n=t.set;if(!1!==n&&100===p[p.length-1]){var a=i.slice(0);return a[a.length-1]=re[a.length-1],a[a.length-2]<re[a.length-2]?a=re:a[a.length-2]=a[a.length-2]-re[a.length-1],o(a),!0}return e||h(""),"boolean"===typeof n?n:!e}),[i,h,p]);function V(){return(V=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===t){e.next=3;break}return e.next=3,ke().catch((function(){return F(!1)}));case 3:F(je.filter((function(e){return!1!==e.active})).length>=2);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=Object(a.useReducer)(A,!0),U=Object(j.a)(H,2),z=U[0],K=U[1],W=Object(a.useReducer)(q,!0),X=Object(j.a)(W,2),Y=X[0],Q=X[1],Z=Object(a.useCallback)((function(e){if(0===i[0]){var t=i.slice(0);t[0]=re[0],t[1]<re[0]?t=re:t[1]=t[1]-re[0],o(t)}else e&&Y&&Q({set:!1});h(e)}),[o,h,Q,i,Y]),ee=Object(a.useState)(Math.random().toString(16).slice(2,9)),te=Object(j.a)(ee,2),ne=te[0],oe=te[1],se=Object(a.useCallback)((function(e,t){if(t.id)return e.delete(t.id),t.id===v&&Z(""),e;var n;n=t.players?t.players:[t.player];var a,r=Object(E.a)(n);try{for(r.s();!(a=r.n()).done;){var i=a.value;e.set(i.id,i)}}catch(o){r.e(o)}finally{r.f()}return oe(t.hash||Math.random().toString(16).slice(2,9)),e}),[Z,oe,v]),le=Object(a.useState)({}),ce=Object(j.a)(le,2),ue=ce[0],de=ce[1],me=Object(a.useState)({}),pe=Object(j.a)(me,2),fe=pe[0],ge=pe[1],ve=Object(a.useState)([]),he=Object(j.a)(ve,2),ye=he[0],be=he[1],_e=Object(a.useState)([]),Ee=Object(j.a)(_e,2),je=Ee[0],Oe=Ee[1],Ne=Object(a.useReducer)(se,new Map),we=Object(j.a)(Ne,2),Se=we[0],xe=we[1];!function(e){var t=e.columns,n=e.boundaries,r=e.resize,i=e.setColumns,o=e.setResize,s=e.toggleSidebar,l=e.toggleSettings,c=e.setDisplayPlayerRaw,u=Object(a.useState)(0),d=Object(j.a)(u,2),m=d[0],p=d[1],f=Object(a.useCallback)((function(e){var a=e.x/window.innerWidth*100;if(m){var r=t.slice(0,m-1).reduce((function(e,t){return e+t}),0),u=r+t[m-1]+t[m],d=a-r,p=u-a;d<2?(p+=d,d=0,1===m&&s({set:!1}),ie("mouseup")):p<2&&(d+=p,p=0,m===t.length-1&&(c(""),l({set:!1}),ie("mouseup"))),t[m-1]=d,t[m]=p,i(t.slice(0))}else{var f=n.findIndex((function(e){return Math.abs(e-a)<1}));(0===f&&0===n[0]||f===n.length-1&&100===n[n.length-1])&&(f=-1),o(f+1)}}),[m,t,c,l,o,i,n,s]);Object(a.useEffect)((function(){return document.addEventListener("mousemove",f),function(){return document.removeEventListener("mousemove",f)}}),[m,f]),Object(a.useEffect)((function(){if(r){var e=function(){return p(r)};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[r,p]),Object(a.useEffect)((function(){var e=function(){return p(0)};return document.addEventListener("mouseup",e),function(){return document.removeEventListener("mouseup",e)}}),[r,p])}({columns:i,boundaries:p,resize:d,setColumns:o,setResize:m,toggleSidebar:K,toggleSettings:Q,setDisplayPlayerRaw:h});var ke=Object(a.useCallback)((function(){return Object(O.b)({url:"/tournament/"+e.id+"/fetchPlayers"}).then((function(e){Oe(e),oe(Math.random().toString(16).slice(2,9)),xe({players:e})}))}),[e.id,Oe,oe,xe]),Ce=Object(a.useCallback)((function(){return Object(O.b)({url:"/tournament/"+e.id+"/getStatus"}).then(de)}),[e.id,de]),De=Object(a.useCallback)((function(){return Object(O.b)({url:"/tournament/"+e.id+"/getSettings"}).then(ge)}),[e.id,ge]),Pe=Object(a.useCallback)((function(t,n){return Object(O.c)({url:"tournament/"+e.id+"/updateSetting",data:Object(_.a)({},t,n)}).then(De)}),[e.id,De]),Ie=Object(a.useCallback)((function(){return Object(O.b)({url:"/tournament/"+e.id+"/fetchRounds"}).then(be)}),[e.id,be]);if(Object(a.useEffect)((function(){if(!e.id)return null;Ie(),Ce(),De(),ke()}),[e.id,Ie,Ce,De,ke]),!e.id)return null;if(w)return r.a.createElement("div",{className:x.a.tournament},r.a.createElement(ae,{show:M,setDisplayPlayer:Z,wide:!v&&!Y,status:ue,players:je,settings:fe}),r.a.createElement(J,{id:e.id,playerID:v,setDisplayPlayer:Z,playerDict:Se,modifyPlayerDict:function(e,t){return xe({player:e,hash:t})},settings:fe}));var Be={};return d&&(Be.cursor="ew-resize"),r.a.createElement("div",{className:x.a.tournament,style:Object(b.a)({gridTemplateColumns:i.join("% ")+"%"},Be)},r.a.createElement(G,{playerDict:Se,playerDictKey:ne,updatePlayerDict:ke,modifyPlayerDict:function(e){return xe({player:e})},settings:fe,id:e.id,setDisplayPlayer:Z,checkIfEnoughPlayers:function(e){return V.apply(this,arguments)},wideLeft:!z}),r.a.createElement(P,{status:ue,settings:fe,updateTournamentStatus:Ce,wide:!v&&!Y,wideLeft:!z,round:ue.round,totalRounds:fe.totalRounds,closeTournament:e.closeTournament,toggleCrossTable:M,setLastRound:I,lastRoundOverride:D,triggerError:e.triggerError}),r.a.createElement(L,{status:ue,playerDict:Se,updatePlayerDict:ke,settings:fe,id:e.id,canTriggerNextRound:R,toggleSidebar:function(){return K({})},toggleSettings:function(){return Q({})},setDisplayPlayer:Z,wide:!v&&!Y,wideLeft:!z,updateRound:Ce,setLastRound:I,lastRoundOverride:D,toggleCrossTable:M}),r.a.createElement(J,{id:e.id,playerID:v,setDisplayPlayer:Z,playerDict:Se,modifyPlayerDict:function(e,t){return xe({player:e,hash:t})},settings:fe,playerDictKey:ne}),Y?r.a.createElement($,{updateTournamentSettings:De,updateSetting:Pe,status:ue,settings:fe,toggleSettings:function(){return Q({})},setLastRound:I,triggerError:e.triggerError,players:je,updateRounds:Ie,rounds:ye}):null)}var se=n(56),le=n(31),ce=n.n(le),ue=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this;if(!this.props.message)return null;var t="string"===typeof this.props.message?this.props.message:JSON.stringify(this.props.message,null,4);return t.length<10?null:r.a.createElement("div",{className:ce.a.alertBox},this.props.title?r.a.createElement("div",null,this.props.title):null,r.a.createElement("div",{className:[ce.a.textBox].join(" ")},t),r.a.createElement("div",{className:ce.a.response},this.props.confirm?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:[ce.a.NO,"button"].join(" "),onClick:function(){e.props.reject(),e.props.close()}},"\u2717"),r.a.createElement("div",{className:[ce.a.YES,"button"].join(" "),onClick:function(){e.props.resolve(),e.props.close()}},"\u2714")):r.a.createElement("div",{className:[ce.a.NO,"button"].join(" "),onClick:this.props.close},"OK")))}}]),n}(r.a.Component),de=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={sessionID:"",tournamentID:"",mode:"login",alertBox:{message:"",error:!0,confirm:!1}},e.closeAlertBox=function(){return e.setState({alertBox:{message:""}})},e.triggerConfirm=function(t,n,a){return e.setState({alertBox:{message:t,title:"CONFIRM ACTION",confirm:!0,resolve:n,reject:a}})},e.triggerError=function(t){return e.setState({alertBox:{message:t,title:"ERROR",confirm:!1}})},e.setTournamentID=function(){var t=Object(l.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.d.set("tournamentID",n,{path:"/"});case 2:e.setState({tournamentID:n,mode:n?"tournament":"menu"});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.hasLoggedIn=function(){var t=Object(l.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.d.set("sessionID",n,{path:"/"});case 2:e.setState({sessionID:n,mode:"menu"});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.closeTournament=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.d.set("tournamentID","",{path:"/"});case 2:e.setState({tournamentID:"",mode:"menu"});case 3:case"end":return t.stop()}}),t)}))),e.endSession=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.d.set("sessionID","",{path:"/"});case 3:return t.next=5,Object(O.c)({url:"/endSession"});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:return t.prev=10,e.setState({sessionID:"",mode:"login"}),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])}))),e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(O.f)((function(e){return n.triggerError(e)})),e.next=3,O.d.get("sessionID");case 3:(t=e.sent)&&this.setState({sessionID:t,mode:"menu"});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){Object(O.f)((function(){}))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(y,null),r.a.createElement("div",{className:"stage",style:{backgroundImage:"url(".concat(".","/images/leaves-texture.png)")}},function(){switch(e.state.mode){case"login":return r.a.createElement(p.b,{login:e.hasLoggedIn});case"menu":return r.a.createElement(se.a,{sessionID:e.state.sessionID,endSession:e.endSession,setTournamentID:e.setTournamentID,triggerConfirm:e.triggerConfirm});case"tournament":return r.a.createElement(oe,{id:e.state.tournamentID,closeTournament:e.closeTournament,triggerError:e.triggerError});default:return console.error("invalid mode"),e.setState({mode:"login"}),null}}(),r.a.createElement(ue,Object.assign({},this.state.alertBox,{close:this.closeAlertBox}))))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(i.render)(r.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[59,1,2]]]);
//# sourceMappingURL=main.1800ea88.chunk.js.map