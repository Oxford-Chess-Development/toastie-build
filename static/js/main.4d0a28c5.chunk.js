(this["webpackJsonptoastie-desktop"]=this["webpackJsonptoastie-desktop"]||[]).push([[0],{11:function(e,t,n){e.exports={column:"login_column__14Kgt",initialiseButton:"login_initialiseButton__3CXrs",forgottenContainer:"login_forgottenContainer__2yR4y",forgotten:"login_forgotten__3VFQz",form:"login_form__1ieaR",input:"login_input__3ze1R",submit:"login_submit__2qxJT",loginSection:"login_loginSection__1BBMn",loginBackground:"login_loginBackground__y9UZ2",foreground:"login_foreground__2Cqo8",loginForeground:"login_loginForeground__lnGgY",registerForeground:"login_registerForeground__3D6jX",flip:"login_flip__2KG2q",messageBar:"login_messageBar__6TM4O"}},13:function(e,t,n){e.exports={pairings:"pairings_pairings__2Z6gd",pairingContainer:"pairings_pairingContainer__2snrJ",pairing:"pairings_pairing__jh3eo","fade-in":"pairings_fade-in__3Iydy",topBanner:"pairings_topBanner__duKX4",playerInfo:"pairings_playerInfo__2BGOf",statusBar:"pairings_statusBar__Y2g9v","slide-in-from-bottom":"pairings_slide-in-from-bottom__1tu-V",waitButton:"pairings_waitButton__3CIsd",finishButton:"pairings_finishButton__elOep",nextButton:"pairings_nextButton__1fjha",rotate:"pairings_rotate__rWtYA",inputResult:"pairings_inputResult__8kpK5",bye:"pairings_bye__2Q8Qe",submit:"pairings_submit__258vX",errorMessage:"pairings_errorMessage__1qM9W"}},14:function(e,t,n){e.exports={crossTable:"crosstable_crossTable__3tCtZ",titles:"crosstable_titles__2lOQ_",table:"crosstable_table__FafeF",td:"crosstable_td__1hxGz",th:"crosstable_th__Gp7TR",cell:"crosstable_cell__1NDzK",playerBox:"crosstable_playerBox__ImPf9",resultsCell:"crosstable_resultsCell__3g4mX",headerCell:"crosstable_headerCell__2zS_u",firstColumn:"crosstable_firstColumn__2m7R_",closeButton:"crosstable_closeButton__2pu_0",container:"crosstable_container__3ZuI8",textarea:"crosstable_textarea__3lS39",form:"crosstable_form__2y5OV",submit:"crosstable_submit__3U_pw"}},15:function(e,t,n){e.exports={canvas:"app_canvas__1MLEL",column:"app_column__2WVoo",logo:"app_logo__b6W_t",loadingLine:"app_loadingLine__1xeSs",staticLogo:"app_staticLogo__1-Wsi",loadingGif:"app_loadingGif__2PnUi",crownOutline:"app_crownOutline__2IPSS","fade-in":"app_fade-in__3kaKs","grow-right":"app_grow-right__1NUcX"}},17:function(e,t,n){e.exports={tournament:"tournament_tournament__1ikhA",titleBar:"tournament_titleBar__1Kvez","slide-in-from-top":"tournament_slide-in-from-top__22vmU",row:"tournament_row__3K-Kn",header:"tournament_header__hB1Cf",container:"tournament_container__DVAFe",form:"tournament_form__1Pn88",input:"tournament_input__xb1Th",editableField:"tournament_editableField__1rO3U"}},24:function(e){e.exports=JSON.parse('{"server":"http://localhost:8080/","prodServer":"https://api.oxfordchess.co.uk/","resultsServer":"http://localhost:3001/","prodResultsServer":"https://results.oxfordchess.co.uk/","useProd":false}')},25:function(e,t,n){e.exports={statusBar:"statusbar_statusBar__3f7HO",favicon:"statusbar_favicon__1Unmh",menu:"statusbar_menu__3nFvT",title:"statusbar_title__3ClL5",exec:"statusbar_exec__2fXB2",close:"statusbar_close__3ssky"}},26:function(e,t,n){e.exports={alertBox:"alert_alertBox__-kpK4",error:"alert_error__wKYnQ",textBox:"alert_textBox__ATagI",response:"alert_response__1RX0q",NO:"alert_NO__2Bl9f",YES:"alert_YES__pKi26"}},3:function(e,t,n){e.exports={container:"components_container__1CCB7",editableField:"components_editableField__2fs18",form:"components_form__1RjIP",input:"components_input__I_Vv7",submitHidden:"components_submitHidden__PvrYt",any:"components_any__3pCEP",submit:"components_submit__1SFYQ",increment:"components_increment__19rbD",cancel:"components_cancel__1_2ia",infinity:"components_infinity__1rF3u",resultsBridge:"components_resultsBridge__9qnay",details:"components_details__1FuFV",resolve:"components_resolve__1X_KN",reject:"components_reject__3ymMO",neutral:"components_neutral__392Xn","flash-green":"components_flash-green__2Wczz",setResult:"components_setResult__ToBDd",inputURL:"components_inputURL__3WU4U",centre:"components_centre__2BcEl",tooltip:"components_tooltip__1IKxP",detailsContent:"components_detailsContent__2yLbz",row:"components_row__1jpeO",linkSubmit:"components_linkSubmit__TNip6",sectionContainer:"components_sectionContainer__1tg1I",sectionHeader:"components_sectionHeader__-UWwY",sectionHeaderText:"components_sectionHeaderText__1OTig",sectionListWrapper:"components_sectionListWrapper__a03uW",sectionList:"components_sectionList__117sb",expanded:"components_expanded__3qOxR",sectionToggle:"components_sectionToggle__2z6Il"}},46:function(e,t,n){e.exports=n.p+"static/media/chessCom.228db28e.svg"},47:function(e,t,n){e.exports=n.p+"static/media/lichess.9ff6e305.svg"},5:function(e,t,n){e.exports={profile:"profile_profile__1V8qL","slide-in-from-right":"profile_slide-in-from-right__2jdIT",bottomBanner:"profile_bottomBanner__b2MfX",roundRow:"profile_roundRow__3OA2r",row:"profile_row__aUfgI",resultsRow:"profile_resultsRow__4zleX",editable:"profile_editable__24Eas",editableField:"profile_editableField__2onPe",input:"profile_input__2tu2X",sectionContainer:"profile_sectionContainer__Tm0AF",sectionHeader:"profile_sectionHeader__UZUfT",sectionHeaderText:"profile_sectionHeaderText__XE7UN",sectionListWrapper:"profile_sectionListWrapper__1K1-l",sectionList:"profile_sectionList__3bJ8Z",expanded:"profile_expanded__3QtaO",sectionToggle:"profile_sectionToggle__2qBPk",semiPresent:"profile_semiPresent__1APEU",playerLine:"profile_playerLine__IVVus",cancel:"profile_cancel__AKFEe"}},50:function(e,t,n){e.exports=n(82)},55:function(e,t,n){},57:function(e,t,n){},7:function(e,t,n){e.exports={sidebar:"sidebar_sidebar__3Z89I","slide-in-from-left":"sidebar_slide-in-from-left__3kaGk",playersSection:"sidebar_playersSection__3_kKf",scoreSection:"sidebar_scoreSection__2Qh1c",addPlayerForm:"sidebar_addPlayerForm__1BL-S",input:"sidebar_input__3Y8ld",submit:"sidebar_submit__22Uk4",edit:"sidebar_edit__zaTlg",cancel:"sidebar_cancel__1DhJL",activate:"sidebar_activate__2-tDL",playerInfo:"sidebar_playerInfo__12dBq",playerLine:"sidebar_playerLine__1cnKs",scoreSeparator:"sidebar_scoreSeparator__1zbAQ",sectionHeader:"sidebar_sectionHeader__2UjkE",playerInactive:"sidebar_playerInactive__1Y9Kw",topBanner:"sidebar_topBanner__3fw_E",bottomBanner:"sidebar_bottomBanner__ZFfBX"}},82:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(48),o=(n(55),n(4)),s=n.n(o),l=n(6),c=n(21),u=n(22),m=n(28),d=n(30),f=(n(57),n(12)),p=n.n(f),b=n(18),g=n(34),v=n.n(g),y=n(24),h="function"===typeof window.require,_="function"===typeof window.require&&!window.require("electron-is-dev"),E=h?window.require("electron").remote:null,j=(h&&E.session,h?E.getCurrentWindow():{minimize:function(){},maximize:function(){},restore:function(){},close:function(){},isMaximized:function(){return!0}}),O=h?j.webContents.session.cookies:null;console.log("isDev",!1),console.log("isElectron",h),console.log("isProd",_);var w=new(n(49).a),N=function(){},k=new(function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,[{key:"getAll",value:function(){return h||_?O.get({}).then((function(e){return e.reduce((function(e,t){return e[t.name]=t.value,e}),{})})).catch((function(e){return console.log(e),{}})):Promise.resolve(w.getAll()||{})}},{key:"get",value:function(e){return h||_?O.get({name:e}).then((function(e){return e.map((function(e){return e.value}))})).then((function(e){return e[0]||""})).catch((function(e){return console.log(e),""})):Promise.resolve(w.get(e)||"")}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object.assign({},n);if(h||_){var r=new Date(Date.now());return a=Object.assign(a,{name:e,value:t,url:S,expirationDate:r.setFullYear(r.getFullYear()+1)}),O.set(a).then((function(){return O.get({})})).then((function(e){return e.map((function(e){return{name:e.name,value:e.value}}))})).catch(console.error)}return Promise.resolve(w.set(e,t,n))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h||_?O.remove(S,e):w.get(e)?Promise.resolve(w.remove(e,t)):Promise.reject("Couldn't remove cookie")}}]),e}()),S=y.prodServer,x=y.prodResultsServer;function C(e){return e=Object.assign(e,{method:"GET"}),v()(e).then((function(e){return e.data})).catch((function(e){throw console.error(e),e.response&&N([e.response.status,e.response.statusText,":","/"+e.response.config.url.split("/").pop()].join(" ")),e}))}function D(e){return e=Object.assign(e,{method:"POST",headers:{"Content-Type":"application/json"}}),v()(e).then((function(e){return e.data})).catch((function(e){throw e&&e.response&&e.response.data&&N(e.response.data),e}))}function P(e){e.preventDefault(),e.persist();for(var t=e.target;"HTMLFormElement"!==t.constructor.name&&t.parentElement;)t=t.parentElement;if("HTMLFormElement"!==t.constructor.name)throw new Error("Couldn't find valid form");return D({data:Array.from(t).reduce((function(e,t){return t.name?("submit"===t.name||("number"===t.type?e[t.name]=Number(t.value):e[t.name]=t.value),e):e}),{}),url:t.action})}function I(e){N=e}v.a.defaults.baseURL=S,v.a.interceptors.request.use(function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=b.a,e.t1={},e.t2=t,e.t3=b.a,e.t4={},e.t5=t.headers,e.t6=JSON,e.next=9,k.getAll();case 9:return e.t7=e.sent,e.t8=e.t6.stringify.call(e.t6,e.t7),e.t9={Authorization:e.t8},e.t10=(0,e.t3)(e.t4,e.t5,e.t9),e.t11={headers:e.t10},e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t11));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var B=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/,R=/chess\.com\/(?:live#tm=|club\/matches\/live\/(?:[a-z-]+\/)?)([0-9]+)/,T=n(15),L=n.n(T),F=n(11),M=n.n(F),V=n(10);function H(e){var t;return r.a.createElement("div",{className:[L.a.logo,null===(t=e.classNames)||void 0===t?void 0:t.logo].join(" ")},e.loading?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{className:L.a.staticLogo,src:"./images/dubrovny.png",alt:"swiss-logo.png"}),r.a.createElement("img",{className:L.a.crownOutline,src:"./images/crown-outline.png",alt:"outline-gif"}),r.a.createElement("img",{className:L.a.loadingGif,src:"./images/loading-crown.gif",alt:"loading-gif"})):r.a.createElement("img",{className:L.a.staticLogo,src:"./images/favicon.png",alt:"swiss-logo.png"})," ")}var q=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,register:!1,errorMessage:""},e.handleSubmit=function(t){e.setState({loading:!0}),P(t).then((function(t){return e.props.login(t)})).catch((function(t){t&&t.response&&t.response.data&&e.setState({errorMessage:t.response.data}),console.error(t)})).finally((function(){e.setState({loading:!1})}))},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:L.a.canvas},r.a.createElement("div",{className:L.a.column}),r.a.createElement("div",{className:[L.a.column,M.a.column].join(" ")},r.a.createElement(H,{setLoading:function(t){return e.setState({loading:t})},loading:this.state.loading}),this.loginSection,r.a.createElement("div",{className:M.a.messageBar},this.state.errorMessage||"\u200b")),r.a.createElement("div",{className:L.a.column}))}},{key:"loginForm",get:function(){return r.a.createElement("form",{className:M.a.form,method:"POST",onSubmit:this.handleSubmit,action:p.a.resolve(S,"login")},r.a.createElement("input",{type:"text",name:"username",required:!0,placeholder:"username",className:["input",M.a.input].join(" ")}),r.a.createElement("input",{type:"password",name:"password",required:!0,placeholder:"password",className:["input",M.a.input].join(" ")}),r.a.createElement("div",{className:M.a.forgottenContainer},r.a.createElement("div",{className:["input",M.a.forgotten].join(" ")},"username reminder"),r.a.createElement("div",{className:["input",M.a.forgotten].join(" ")},"password reset")),r.a.createElement("input",{type:"submit",value:"LOGIN",className:["input",M.a.submit].join(" ")}))}},{key:"registerForm",get:function(){return r.a.createElement("form",{className:M.a.form,method:"POST",onSubmit:this.handleSubmit,action:p.a.resolve(S,"register")},r.a.createElement("input",{type:"text",name:"username",required:!0,placeholder:"username",className:["input",M.a.input].join(" ")}),r.a.createElement("input",{type:"password",name:"password",required:!0,placeholder:"password",minLength:8,className:["input",M.a.input].join(" ")}),r.a.createElement("input",{type:"email",name:"email",required:!0,placeholder:"email",className:["input",M.a.input].join(" "),pattern:B.source}),r.a.createElement("input",{type:"submit",value:"REGISTER",className:["input",M.a.submit].join(" ")}))}},{key:"loginSection",get:function(){var e=this;return r.a.createElement("div",{className:[M.a.loginSection,M.a.initialiseButton].join(" ")},r.a.createElement("div",{className:M.a.loginBackground},r.a.createElement("div",{className:[M.a.flip,"button"].join(" "),onClick:function(){e.setState({loading:!0,register:!1,errorMessage:""}),setTimeout((function(){return e.setState({loading:!1})}),500)}},r.a.createElement("div",null,"LOGIN"),r.a.createElement("div",null,r.a.createElement(V.a,null))),r.a.createElement("div",null),r.a.createElement("div",{className:[M.a.flip,"button"].join(" "),onClick:function(){e.setState({loading:!0,register:!0,errorMessage:""}),setTimeout((function(){return e.setState({loading:!1})}),500)}},r.a.createElement("div",null,"REGISTER"),r.a.createElement("div",null,r.a.createElement(V.b,null))),"Background"),r.a.createElement("div",{className:[M.a.foreground,this.state.register?M.a.registerForeground:M.a.loginForeground].join(" ")},this.state.register?this.registerForm:this.loginForm))}}]),n}(r.a.Component),U=n(2),z=n(23),A=n(25),K=n.n(A);function W(){var e=Object(a.useState)("Tournament by Oxford Chess Development"),t=Object(U.a)(e,2),n=t[0],i=(t[1],j.isMaximized()),o=j.minimize(),s=j.close();return r.a.createElement("div",{className:K.a.statusBar},r.a.createElement("div",{className:K.a.title},n),r.a.createElement("div",{className:K.a.menu},r.a.createElement("div",{className:K.a.favicon},r.a.createElement("img",{alt:"favicon",draggable:!1,src:"./logo192.png"}))),r.a.createElement("div",{className:K.a.exec},r.a.createElement("div",{onClick:o},r.a.createElement(z.e,null)),r.a.createElement("div",{onClick:function(){i?j.restore():j.maximize()}},i?r.a.createElement(z.f,null):r.a.createElement(z.d,null)),r.a.createElement("div",{onClick:s,className:K.a.close},r.a.createElement(z.c,null))))}var G=n(20),Y=n(33),X=n(17),J=n.n(X),Q=n(3),Z=n.n(Q),$=n(8);function ee(e){var t,n=Object(a.useState)(e.content),i=Object(U.a)(n,2),o=i[0],s=i[1],l=Object(a.useState)(e.alwaysEnabled||!1),c=Object(U.a)(l,2),u=c[0],m=c[1],d=Object(a.useState)(!1),f=Object(U.a)(d,2),p=f[0],b=f[1],g=Object(a.useRef)(null),v=Object(a.useRef)(null),y=Object(a.useCallback)((function(t){t.preventDefault();var n=t.target;"HTMLButtonElement"===n.constructor.name&&n.parentNode[e.name||"name"].stepDown()}),[e.name]),h=Object(a.useCallback)((function(t){t.preventDefault();var n=t.target;"HTMLButtonElement"===n.constructor.name&&n.parentNode[e.name||"name"].stepUp()}),[e.name]),_=Object(a.useCallback)((function(t){if(t.preventDefault(),e.handleClear)return e.handleClear().then((function(){m(e.alwaysEnabled||!1),s("")}))}),[e.handleClear,m,s,e.alwaysEnabled]),E=Object(a.useCallback)((function(t){return t.preventDefault(),e.handleSubmit(e.name||"name",0).then((function(){m(e.alwaysEnabled||!1),s("0")}))}),[e.handleSubmit,m,s,e.name]),j=Object(a.useCallback)((function(t){return t.preventDefault(),e.handleSubmit(e.name||"name","Infinity").then((function(){m(e.alwaysEnabled||!1),s("\u221e")}))}),[e.handleSubmit,m,s,e.alwaysEnabled,e.name]),O=Object(a.useCallback)((function(t){if(t.preventDefault(),e.useHandleSubmit){var n=t.target;if("HTMLFormElement"!==n.constructor.name)return Promise.resolve(m(e.alwaysEnabled||!1));var a=n[e.name||"name"];return e.handleSubmit(e.name||"name",a.value).then((function(){return m(e.alwaysEnabled||!1),t})).then(e.onSubmitSuccess).then((function(){return s(a.value)}))}return P(t).then((function(){return m(e.alwaysEnabled||!1),t})).then(e.onSubmitSuccess).then((function(e){for(var t=e.target;"HTMLFormElement"!==t.constructor.name&&t.parentElement;)t=t.parentElement;if("HTMLFormElement"!==t.constructor.name)throw new Error("Couldn't find valid form");var n=t.firstChild.value;s(n)}))}),[e.useHandleSubmit,e.handleSubmit,e.name,m,e.onSubmitSuccess,e.alwaysEnabled,m,s]),w=Object(a.useCallback)((function(t){switch(t.keyCode){case 27:return m(e.alwaysEnabled||!1),t;case 13:return O(t),t;default:return t}}),[m,O,e.alwaysEnabled]);Object(a.useEffect)((function(){s(e.content)}),[e.content]),Object(a.useEffect)((function(){if(p){var e=g.current;e&&(e.select?e.select():e.focus&&e.focus())}}),[g,p]),le((function(t){v.current&&v.current.contains(t.target)||m(e.alwaysEnabled||!1)}));var N,k=Math.random().toString(16).slice(2,9),S=o;return S&&"datetime-local"===e.inputType?(N=new Date(o),S=isNaN(N.valueOf())?"":N.toLocaleString("en-GB").slice(0,-3)):(null===(t=e.show)||void 0===t?void 0:t.any)&&"0"===S&&(S="Any"),r.a.createElement("div",{ref:v,className:[Z.a.container,e.additionalStyles.container].join(" "),id:k},u?function(t){var n,a,i,o,s,l,c,u,d,f,p,b=t||e.defaultEditContent;return"datetime-local"===e.inputType?b=function(e){if(isNaN(e.valueOf()))return"";var t=6e4*e.getTimezoneOffset();return new Date(e.valueOf()-t).toISOString().slice(0,16)}(function(e){var t=new Date(e.setUTCHours(e.getUTCHours()+1));return t.getUTCMinutes()<30?new Date(t.setUTCMinutes(30)):new Date(new Date(t.setUTCMinutes(0)).setUTCHours(t.getUTCHours()+1))}(new Date(b))):(null===(n=e.show)||void 0===n?void 0:n.any)&&"0"===b&&(b=""),r.a.createElement("form",{ref:e.formRef,className:Z.a.form,target:"_self",onKeyDown:w,onSubmit:O,method:"POST",action:e.url},r.a.createElement("input",Object.assign({type:e.inputType,className:[Z.a.input,e.additionalStyles.input].join(" "),name:e.name||"name",defaultValue:b||"\u200b",required:!0,ref:g},e.additionalInputProps)),r.a.createElement("button",{className:[!(null===(a=e.show)||void 0===a?void 0:a.submit)||(null===(i=e.show)||void 0===i?void 0:i.infinity)||(null===(o=e.show)||void 0===o?void 0:o.any)||(null===(s=e.show)||void 0===s?void 0:s.clear)?Z.a.submitHidden:"",Z.a.cancel].join(" "),onClick:function(){return m(e.alwaysEnabled||!1)}},r.a.createElement($.c,null)),r.a.createElement("button",{className:[(null===(l=e.show)||void 0===l?void 0:l.clear)?"":Z.a.submitHidden,Z.a.cancel].join(" "),onClick:_},r.a.createElement($.c,null)),r.a.createElement("button",{className:[(null===(c=e.show)||void 0===c?void 0:c.any)?"":Z.a.submitHidden,Z.a.any].join(" "),onClick:E},"Any"),r.a.createElement("button",{className:[(null===(u=e.show)||void 0===u?void 0:u.infinity)?"":Z.a.submitHidden,Z.a.infinity].join(" "),onClick:j},"\u221e"),r.a.createElement("button",{type:"button",value:"\u25bc",className:[(null===(d=e.show)||void 0===d?void 0:d.increment)?"":Z.a.submitHidden,Z.a.increment].join(" "),onClick:y},r.a.createElement($.d,null)),r.a.createElement("button",{className:[(null===(f=e.show)||void 0===f?void 0:f.increment)?"":Z.a.submitHidden,Z.a.increment].join(" "),onClick:h},r.a.createElement($.i,null)),r.a.createElement("button",{type:"submit",className:[(null===(p=e.show)||void 0===p?void 0:p.submit)?"":Z.a.submitHidden,Z.a.submit].join(" ")},r.a.createElement($.b,null)),e.children)}(o):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:[Z.a.editableField,e.additionalStyles.editableField||""].join(" "),onClick:function(){m(!0),b(!0)}},S||e.defaultContent||"\u200b"),e.children))}function te(e){var t=e.header,n=e.body;return r.a.createElement("div",{className:e.styles.crossTable,style:e.style},r.a.createElement("table",{className:e.styles.table},r.a.createElement("thead",null,r.a.createElement("tr",null,Object.entries(t).map((function(t,n){var a=Object(U.a)(t,2),i=a[0],o=a[1];return r.a.createElement("th",{scope:"column",key:["column",n].join("."),className:e.styles.th},o?r.a.createElement("div",{className:[e.styles.cell,e.styles.headerCell].join(" "),onClick:function(){return e.handleHeaderClick(i)}},o):"")})))),r.a.createElement("tbody",null,n.map((function(t,n){var a=t.shift(),i=t;return r.a.createElement("tr",{key:"row."+n,className:e.styles.tr},r.a.createElement("th",{scope:"row"},a),i.map((function(t,a){var i=["cell",n,a].join(".");return r.a.createElement("td",{id:i,key:i,className:e.styles.td},t)})))})))))}var ne=n(46),ae=n.n(ne),re=n(47),ie=n.n(re);function oe(e){var t,n,i=Object(a.useState)(void 0),o=Object(U.a)(i,2),s=o[0],l=o[1],c=Object(a.useState)(""),u=Object(U.a)(c,2),m=u[0],d=u[1],f=function(t){var n=t.target.parentElement,a=e.validate(n);d("string"===typeof a?a:""),l("boolean"===typeof a?a:"string"!==typeof a&&void 0)};return null!==e.result[0]||null!==e.result[1]?r.a.createElement("div",{className:Z.a.resultsBridge},r.a.createElement("div",{className:Z.a.setResult},null!==(t=e.result[0])&&void 0!==t?t:"\u200b"),r.a.createElement("div",{className:Z.a.neutral,onClick:function(){return e.expand(!e.expanded)},style:{transform:e.expanded?"rotate(450deg)":"rotate(0deg)"}},r.a.createElement($.g,null)),r.a.createElement("div",{className:Z.a.setResult},null!==(n=e.result[1])&&void 0!==n?n:"\u200b")):r.a.createElement("form",{className:Z.a.resultsBridge,target:"_self",onSubmit:function(t){if(t.persist(),!e.validate(t.target))return t.preventDefault();P(t).then((function(){return e.handleSubmit(t)}))},method:"POST",action:p.a.resolve(S,["tournament",e.tournamentID,"addResult"].join("/"))},r.a.createElement("input",{type:"number",min:0,step:.5,name:"resultWhite",required:!0,className:e.inputClassName,onChange:f}),r.a.createElement("div",{className:Z.a.centre},m?r.a.createElement("span",{className:Z.a.tooltip},m):null,s?r.a.createElement("button",{tabIndex:-1,className:Z.a.resolve},r.a.createElement($.b,null)):!1===s?r.a.createElement("button",{tabIndex:-1,className:Z.a.reject,onClick:function(e){e.preventDefault(),e.target.parentElement.parentElement.reset(),d(""),l(void 0)}},r.a.createElement($.c,null)):r.a.createElement("div",{className:Z.a.neutral,onClick:function(){return e.expand(!e.expanded)},style:{transform:e.expanded?"rotate(450deg)":"rotate(0deg)"}},r.a.createElement($.g,null))),r.a.createElement("input",{type:"number",min:0,step:.5,name:"resultBlack",required:!0,className:e.inputClassName,onChange:f}),Object.entries(e.hidden).map((function(e,t){var n=Object(U.a)(e,2),a=n[0],i=n[1];return r.a.createElement("input",{key:["hiddenInput",t].join("."),type:"hidden",name:a,value:i,required:!0})})))}function se(e){var t=Object(a.useState)("0px"),n=Object(U.a)(t,2),i=n[0],o=n[1],s=Object(a.useRef)(null),l=Object(a.useRef)(null);Object(a.useEffect)((function(){if(s.current&&e.expanded)return o(s.current.getBoundingClientRect().height+"px"),function(){return o("0px")}}),[s,o,e.expanded]);var c=e.individual?e.gameLinks.lichessLink:e.gameLinks.lichessTeamLink,u=e.individual?e.gameLinks.chessComLink:e.gameLinks.chessComTeamLink,m=Object(a.useCallback)((function(t,n){var a,r=n;if(!e.individual){var i=n.match(R);if(!i)return console.error("Invalid syntax on tournament: "+n),Promise.resolve();r="https://chess.com/club/matches/live/"+i[1]}return D({url:p.a.resolve(S,["tournament",e.tournamentID,"updateResultLink"].join("/")),data:(a={id:e.id},Object(G.a)(a,t,r),Object(G.a)(a,"type",e.individual?"individual":"team"),a)})}),[e.id,e.individual,e.tournamentID]),d=Object(a.useCallback)((function(t){return D({url:p.a.resolve(S,["tournament",e.tournamentID,"clearResultLink"].join("/")),data:{id:e.id,site:t,type:e.individual?"individual":"team"}})}),[e.id,e.individual,e.tournamentID]);return r.a.createElement("div",{className:[e.className,Z.a.details].join(" "),style:{height:i}},r.a.createElement("div",{ref:s,className:[Z.a.detailsContent].join(" ")},r.a.createElement("div",{className:[Z.a.row,"topBanner"].join(" ")},"Board: ",e.board,"\n","For online games, enter ",e.individual?"":"team match ","game links below:"),r.a.createElement("div",{className:Z.a.row},r.a.createElement(ee,{content:u,url:p.a.resolve(S,["tournament",e.tournamentID,"updateResultLink"].join("/")),onSubmitSuccess:function(t){return e.update(),t},handleSubmit:function(e,t){return m("chessCom",t)},name:"link",additionalInputProps:{},additionalStyles:{input:Z.a.inputURL,editableField:Z.a.editableField},formRef:l,useHandleSubmit:!0,handleClear:function(){return d("chessCom")},show:{clear:!0}},r.a.createElement("button",{className:[Z.a.submit,Z.a.linkSubmit].join(" "),onClick:function(e){return l.current?l.current.dispatchEvent(new Event("submit")):null}},r.a.createElement("img",{src:ae.a,alt:"chess.com"})))),r.a.createElement("div",{className:Z.a.row},r.a.createElement(ee,{content:c,url:p.a.resolve(S,["tournament",e.tournamentID,"updateResultLink"].join("/")),onSubmitSuccess:function(t){return e.update(),t},handleSubmit:function(e,t){return m("lichess",t)},name:"link",additionalInputProps:{},additionalStyles:{input:Z.a.inputURL,editableField:Z.a.editableField},formRef:l,useHandleSubmit:!0,handleClear:function(){return d("lichess")},show:{clear:!0}},r.a.createElement("button",{className:[Z.a.increment,Z.a.linkSubmit].join(" "),onClick:function(e){return l.current?l.current.dispatchEvent(new Event("submit")):null}},r.a.createElement("img",{src:ie.a,alt:"lichess"}))))))}var le=function(e){Object(a.useEffect)((function(){return window.addEventListener("mousedown",e),function(){return window.removeEventListener("mousedown",e)}}),[e])},ce=n(19);function ue(e){var t=!1;t="undefined"!==typeof e.lastRoundOverride?e.lastRoundOverride:e.settings.totalRounds===e.status.round;var n=p.a.resolve(S,["tournament",e.status.id,"setName"].join("/"));return r.a.createElement("div",{className:J.a.titleBar,style:{gridColumn:"2 /span 1"}},r.a.createElement("div",{className:J.a.row},r.a.createElement("div",{className:["topBanner",J.a.header].join(" ")},r.a.createElement(ee,{content:e.status.name,url:n,inputType:"text",handleSubmit:function(e,t){return D({url:n,data:Object(G.a)({},e,t)})},additionalStyles:J.a,additionalInputProps:{},onSubmitSuccess:function(t){return e.updateTournamentStatus(),t},defaultContent:"Unnamed Swiss Tournament",show:{submit:!0}}))),r.a.createElement("div",{className:J.a.row},r.a.createElement("div",{className:"topBanner "+J.a.header},"ID: ",e.status.id),r.a.createElement("div",{className:"topBanner "+J.a.header},"Round: ",e.status.round?e.status.round+" / "+("Infinity"===e.totalRounds?"\u221e":e.totalRounds):"Not yet initialised")),r.a.createElement("div",{className:J.a.row},r.a.createElement("div",{className:"button",onClick:e.closeTournament},r.a.createElement("span",{role:"img","aria-label":"back"},r.a.createElement(ce.a,null))),r.a.createElement("div",{className:"button",onClick:function(){e.status.round>=e.settings.totalRounds&&e.triggerError("Increase the number of rounds in Settings to continue!"),e.setLastRound(!t)}},r.a.createElement("span",{role:"img","aria-label":"decommission"},t?r.a.createElement(V.i,null):r.a.createElement(ce.d,null))),r.a.createElement("div",{className:"button",onClick:e.toggleCrossTable},r.a.createElement(V.h,null))))}var me=n(13),de=n.n(me),fe=n(35);function pe(e){var t=Object(a.useMemo)((function(){return e.status.round}),[e.status.round]),n=Object(a.useReducer)((function(){return Math.random().toString(16).slice(2,9)}),""),i=Object(U.a)(n,2),o=i[0],c=i[1],u=Object(a.useCallback)((function(n,a){var r=a.id,i=a.W,o=a.B;return n.set(r,[i?i.histories?i.histories[t][e.settings.displayPoints]:null:0,o?o.histories?o.histories[t][e.settings.displayPoints]:null:0]),c({}),n}),[t,e.settings.displayPoints]),m=Object(a.useState)([]),d=Object(U.a)(m,2),f=d[0],p=d[1],b=Object(a.useReducer)(u,new Map),g=Object(U.a)(b,2),v=g[0],y=g[1],h=Object(a.useState)(!1),_=Object(U.a)(h,2),E=_[0],j=_[1],O=Object(a.useCallback)((function(){if(t&&e.playerDict.size)return C({url:"/tournament/"+e.id+"/getPairings"}).then((function(t){var n,a=Object(Y.a)(t);try{for(a.s();!(n=a.n()).done;){var r=Object(U.a)(n.value,2),i=r[0],o=r[1];y({id:i+"."+o,W:e.playerDict.get(i),B:e.playerDict.get(o)})}}catch(s){a.e(s)}finally{a.f()}p(t)})).catch(console.error)}),[e.id,p,y,t,e.playerDict,e.playerDictKey]);function w(t,n){return"bye"===t?"BYE":n?(a="individual"===e.settings.competitors?[n.firstName,n.lastName].join(" "):n.firstName,"".concat(a," [").concat(n.score,"]")):t;var a}var N=Array.from(v.values()).filter((function(e){return e.every((function(e){return null===e}))})),k=function(){return j(!0),D({url:"/tournament/"+e.id+"/getNextPairings"}).then((function(e){return p(e)})).then((function(){O(),e.updatePlayerDict()})).then(e.updateRound).catch(console.error).finally((function(){return j(!1)}))};function S(t){if(""!==t.resultWhite.value||""!==t.resultBlack.value)return!!Array.from(t).every((function(e){return e.validity.valid}))&&(!e.settings.gamePointTotal||(Number(t.resultWhite.value)+Number(t.resultBlack.value)===("game"===e.settings.displayPoints?e.settings.gamePointTotal:1)||"Setting: sum results to "+e.settings.gamePointTotal))}var x=Object(a.useState)(""),P=Object(U.a)(x,2),I=P[0],B=P[1];Object(a.useEffect)((function(){O()}),[O]);var R=Object(a.useMemo)((function(){var t,n=[],a=e.playerDict,i=1,o=Object(Y.a)(f);try{var u=function(){var o=Object(U.a)(t.value,3),u=o[0],m=o[1],d=o[2],f=[a.get(u),a.get(m)],p=f[1],b=[w(u,f[0]),w(m,p)],g=b[0],y=b[1],h=u+"."+m,_=v.get(h);if(!_)return"continue";n.push(r.a.createElement("div",{id:h,className:de.a.pairing,key:["pairings",u,m].join(".")},r.a.createElement("div",{className:["playerInfo",de.a.playerInfo,"bye"===u?de.a.bye:""].join(" "),id:u,onClick:function(t){return"bye"===u?null:e.setDisplayPlayer(t.target.id)}},g),r.a.createElement(oe,{expand:function(e){return B(e?h:"")},expanded:I===h,result:_,tournamentID:e.id,inputClassName:de.a.inputResult,hidden:{W:u,B:m},validate:S,handleSubmit:function(){var t=Object(l.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.target,v.set(h,[Number(a.resultWhite.value),Number(a.resultBlack.value)]),c({}),e.updatePlayerDict(),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),r.a.createElement("div",{className:["playerInfo",de.a.playerInfo,de.a.playerInfo,"bye"===m?de.a.bye:""].join(" "),id:m,onClick:function(t){return"bye"===m?null:e.setDisplayPlayer(t.target.id)}},y)),r.a.createElement(se,{tournamentID:e.status.id,id:h,board:i,className:de.a.pairing,expanded:I===h,gameLinks:d,individual:"individual"===e.settings.competitors,update:O})),i++};for(o.s();!(t=o.n()).done;)u()}catch(m){o.e(m)}finally{o.f()}return n}),[e.playerDict,f,w,v,o,e.updatePlayerDict,O,e.setDisplayPlayer,y,e.playerDictKey]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:de.a.pairings},r.a.createElement("div",{className:["topBanner",de.a.topBanner].join(" ")},"Pairings"),r.a.createElement("div",{className:de.a.pairingContainer},R)),r.a.createElement("div",{className:["bottomBanner",de.a.statusBar].join(" ")},r.a.createElement("div",{className:["button"].join(" "),onClick:e.toggleSidebar},r.a.createElement(fe.a,null)),function(){var t;return t=e.status.round>=e.settings.totalRounds||"undefined"!==typeof e.lastRoundOverride&&e.lastRoundOverride,E?r.a.createElement("div",{className:[de.a.nextButton,"button"].join(" ")},r.a.createElement($.f,null)):e.canTriggerNextRound?N.length>0?r.a.createElement("div",{className:[de.a.waitButton].join(" ")},"Awaiting ".concat(N.length," result").concat(N.length>1?"s":"")):t?r.a.createElement("div",{className:[de.a.finishButton,"button"].join(" "),onClick:e.toggleCrossTable},"Final Standings"):r.a.createElement("div",{className:[de.a.nextButton,"button"].join(" "),onClick:k},"Next Round"):r.a.createElement("div",{className:[de.a.waitButton].join(" ")},"Tournament must have at least 2 active players")}(),r.a.createElement("div",{className:["button"].join(" "),onClick:e.toggleSettings},r.a.createElement(V.d,null))))}var be=n(29),ge=n(36),ve=n.n(ge),ye=n(7),he=n.n(ye);function _e(){for(var e=[],t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s){var l=Object(U.a)(s,3),c=l[0],u=l[1],m=l[2];e.push(r.a.createElement("div",{key:["button",m].join("."),onClick:c,className:"button"},u))}}return e}function Ee(){return r.a.createElement("div",{className:Z.a.sectionContainer},r.a.createElement("div",{className:[Z.a.sectionHeader,"topBanner"].join(" ")},r.a.createElement("div",{className:Z.a.sectionHeaderText})))}function je(e){var t=Object(a.useState)(e.expanded||!0),n=Object(U.a)(t,2),i=n[0],o=n[1],s=Object(a.useState)(0),l=Object(U.a)(s,2),c=l[0],u=l[1],m=Object(a.useRef)(),d=e.useInternalState?i:e.expanded;return Object(a.useEffect)((function(){m.current&&u(d?m.current.getBoundingClientRect().height:0)}),[d,m,e.children]),r.a.createElement("div",{className:Z.a.sectionContainer,style:e.style},r.a.createElement("div",{className:[Z.a.sectionHeader,"topBanner"].join(" ")},r.a.createElement("div",{className:Z.a.sectionHeaderText,onClick:function(){return e.useInternalState?o(!d):e.setExpanded(!d,e.value)}},e.header),e.children.length?r.a.createElement("div",{className:Z.a.sectionToggle,onClick:function(){return e.useInternalState?o(!d):e.setExpanded(!d,e.value)}},r.a.createElement($.e,{style:{transform:d?"rotate(-90deg)":"rotate(0deg)"}})):null),r.a.createElement("div",{className:[Z.a.sectionListWrapper,d?Z.a.expanded:""].join(" "),style:{height:c}},r.a.createElement("div",{ref:m,className:[Z.a.sectionList].join(" "),id:e.id},e.children)))}function Oe(e){var t=e.requireLastName?[e.player.firstName,e.player.lastName].join(" "):e.player.firstName;return r.a.createElement("div",{id:e.player.id,className:he.a.playerLine},r.a.createElement("div",{className:["playerInfo",he.a.playerInfo,e.player.active?"":he.a.playerInactive].join(" "),style:{gridColumn:e.round&&!e.allowNewPlayers?"1 / span 3":void 0},onClick:function(t){return e.setDisplayPlayer(t.target.parentElement.id)}},t," (",e.player.rating.toString(),") ",e.round&&e.player.played<e.round?"*":""),e.round&&!e.allowNewPlayers?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{name:"edit",className:he.a.edit,onClick:e.editPlayer},r.a.createElement($.a,null)),e.player.active?r.a.createElement("button",{name:"cancel",className:he.a.cancel,onClick:e.clearPlayer},r.a.createElement($.c,null)):r.a.createElement("button",{name:"active",className:he.a.activate,onClick:e.activatePlayer},r.a.createElement($.b,null))))}function we(e){var t,n,i,o,s=Object(a.createRef)(),l=Object(a.useState)(!1),c=Object(U.a)(l,2),u=c[0],m=c[1];return Object(a.useEffect)((function(){(u||e.player)&&s.current&&s.current.focus()}),[s]),r.a.createElement("div",{className:he.a.scoreSection},r.a.createElement("form",{target:"_self",onKeyDown:e.onKeyDown,onSubmit:function(t){return e.onSubmit(t).then((function(){return m(!0)}))},method:"POST",action:e.action},r.a.createElement("input",{type:"text",className:he.a.input,name:"firstName",required:!0,style:{width:e.requireLastName?"25%":"65%"},ref:s,placeholder:e.player?void 0:e.requireLastName?"First name":"Team name",defaultValue:null===(t=e.player)||void 0===t?void 0:t.firstName,onPaste:e.handlePaste}),r.a.createElement("input",{type:"text",className:he.a.input,name:"lastName",required:e.requireLastName,style:{width:"40%",display:e.requireLastName?"block":"none"},placeholder:e.player?void 0:"Last name",defaultValue:null===(n=e.player)||void 0===n?void 0:n.lastName}),r.a.createElement("input",{type:"number",className:he.a.input,min:0,max:3200,name:"rating",required:!0,style:{width:"20%"},placeholder:e.player?void 0:e.requireLastName?"Rating":"Av. Rating",defaultValue:null===(i=e.player)||void 0===i?void 0:i.rating}),r.a.createElement("input",{type:"hidden",name:"id",value:null===(o=e.player)||void 0===o?void 0:o.id,required:!0}),r.a.createElement("button",{tabIndex:-1,className:he.a.submit},r.a.createElement($.b,null))))}function Ne(e){var t=Object(a.useState)(0),n=Object(U.a)(t,2),i=n[0],o=n[1],c=Object(a.useState)({}),u=Object(U.a)(c,2),m=u[0],d=u[1],f=Object(a.useState)({}),b=Object(U.a)(f,2),g=b[0],v=b[1],y=Object(a.useCallback)((function(){return e.id?C({url:"/tournament/"+e.id+"/getState"}).then((function(e){var t=e.round,n=e.players;return v(n),o(t),n})):Promise.resolve({})}),[e.id]),h=Object(a.useCallback)(function(){var t=Object(l.a)(s.a.mark((function t(n){var a,r,i,o,l,c,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===n){t.next=6;break}return t.next=3,y();case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=g;case 7:if(a=t.t0){t.next=10;break}return t.abrupt("return",Promise.resolve());case 10:for(r={},i=0,o=Object.entries(a);i<o.length;i++)l=Object(U.a)(o[i],2),c=l[0],u=l[1],r[c]=u.map((function(t){return e.playerDict.get(t)})).sort((function(e,t){return t.rating-e.rating})).filter((function(e){return e}));d(r),e.checkIfEnoughPlayers(!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[y,e.playerDict,e.checkIfEnoughPlayers,g]),_=Object(a.useCallback)((function(t){return C({url:"/tournament/"+e.id+"/fetchPlayer",params:{id:t}}).then((function(t){return e.setPlayerDict({player:t}),t}))}),[e.id,e.setPlayerDict]),E=Object(a.useCallback)((function(t){var n=t.target;if("HTMLButtonElement"===n.constructor.name){var a=n.parentNode.id;D({url:"/tournament/"+e.id+"/activatePlayer",data:{id:a}}).then((function(){return _(a)})).catch(console.error)}}),[e.id,_]),j=Object(a.useCallback)((function(t){var n=t.target;if("HTMLButtonElement"===n.constructor.name){var a=n.parentNode.id;D({url:"/tournament/"+e.id+"/clearPlayer",data:{id:a}}).then((function(t){"inactive"===t?_(a):e.setPlayerDict({id:a})})).catch(console.error)}}),[_,e.id]),O=Object(a.useCallback)(Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D({url:"/tournament/"+e.id+"/clearPlayers"}).catch(console.error);case 2:e.checkIfEnoughPlayers();case 3:case"end":return t.stop()}}),t)}))),[e.id,e.checkIfEnoughPlayers]),w=Object(a.useMemo)((function(){return"individual"===e.settings.competitors}),[e.settings.competitors]),N=Object(a.useCallback)((function(t){var n=t.clipboardData.getData("text").toString();if(n.trim()&&(n.split("\n").length||!n.split(",").length||!n.split("\t").length)){t.preventDefault();var a=ve.a.parse(n,{delimitersToGuess:[",","\t"],dynamicTyping:!0,fastMode:!0});if(a.data.length>100)return console.error("Can't paste more than 100 players at once!");var r=a.data.map((function(e){var t=Object(U.a)(e,3),a=t[0],r=t[1],i=t[2];if(!w){var o=[].concat(Object(be.a)(e),[""]);a=o[0],i=o[1],r=o[2]}if(!a||!r&&w||null===i||void 0===i)return null;try{if("string"!==typeof a)throw[a,"string"].join(",");if("string"!==typeof r&&w)throw[r,"string"].join(",");if("number"!==typeof i)throw[i,"number"].join(",");return{firstName:a,lastName:r,rating:i}}catch(l){if(!n.split("\n").length)return null;var s=l.split(",");return console.error(new TypeError("Bad input on row "+e.join(",")+"\n"+s[0]+" is not type "+s[1])),null}})).filter((function(e){return e}));D({url:"tournament/"+e.id+"/appendPlayers",data:r}).then((function(){return Promise.all([e.updatePlayerDict(),h()])}))}}),[e.id,w,e.updatePlayerDict,h]),k=Object(a.useMemo)((function(){for(var t=[],n=0;n<Math.max(1,10-Object.values(m).reduce((function(e,t){return e+t.length}),0));n++)t.push(r.a.createElement(we,{key:["newPlayerForm",n].join("."),id:e.id,player:null,requireLastName:w,onSubmit:function(t){return P(t).then((function(){t.target.reset()})).then((function(){return e.updatePlayerDict()}))},handlePaste:n?void 0:N,action:p.a.resolve(S,["tournament",e.id,"appendPlayer"].join("/"))}));return t}),[e.updatePlayerDict,e.id,w,m,N]);function x(t){var n=Object(a.useState)(!1),o=Object(U.a)(n,2),c=o[0],u=o[1],m=Object(a.useState)(t.player),d=Object(U.a)(m,2),f=d[0],b=d[1];return c?r.a.createElement(we,{id:e.id,requireLastName:w,player:f,onKeyDown:function(e){27===e.keyCode&&u(!1)},onSubmit:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",P(t).then(Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(f.id);case 2:t=e.sent,b(t),u(!1);case 5:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),action:p.a.resolve(S,["tournament",e.id,"editPlayer"].join("/"))}):r.a.createElement(Oe,{player:f,round:i,requireLastName:w,editPlayer:function(){return u(!0)},activatePlayer:E,clearPlayer:j,allowNewPlayers:e.settings.allowNewPlayers,setDisplayPlayer:e.setDisplayPlayer})}var I=Object(a.useMemo)((function(){for(var e=[],t=i;t>=0;t-=.5){var n=t.toString();if(m[n]&&m[n].length){var a=r.a.createElement(je,{key:["sidebar","round",n].join("."),header:n+" points",useInternalState:!0,id:["container",n].join(".")},m[n].map((function(e){return r.a.createElement(x,{key:e.id,player:e})})));e.push(a)}}return e}),[i,m,w,e.settings.allowNewPlayers]);return Object(a.useEffect)((function(){e.playerDict.size&&(h(),e.checkIfEnoughPlayers(!1))}),[e.playerDictKey]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:he.a.sidebar},r.a.createElement("div",{className:he.a.topBanner},"Tournament Players"),r.a.createElement("div",{className:he.a.playersSection},I.length?null:r.a.createElement("div",{className:he.a.scoreSection},r.a.createElement("div",{className:he.a.playerLine},r.a.createElement("div",{className:he.a.sectionHeader},I.length?"Player List":"No players added yet"))),I,i&&!e.settings.allowNewPlayers?null:r.a.createElement("div",{className:he.a.scoreSection},k),r.a.createElement(Ee,null))),r.a.createElement("div",{className:["bottomBanner",he.a.bottomBanner].join(" ")},_e([Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.togglePasteInput();case 1:case"end":return t.stop()}}),t)}))),r.a.createElement(ce.b,null),"paste"],[Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.updatePlayerDict(!0);case 1:case"end":return t.stop()}}),t)}))),r.a.createElement(ce.c,null),"refresh"],0===i?[Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===i){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,O();case 4:e.updatePlayerDict(),h();case 6:case"end":return t.stop()}}),t)}))),r.a.createElement(V.g,null),"close"]:null)))}var ke=n(5),Se=n.n(ke);function xe(e){var t=e.requireLastName?[e.player.firstName,e.player.lastName].join(" "):e.player.firstName;return r.a.createElement("div",{id:e.player.id,className:[he.a.playerLine,Se.a.playerLine].join(" ")},r.a.createElement("div",{className:["playerInfo",he.a.playerInfo].join(" "),onClick:function(t){return e.setDisplayPlayer(t.target.parentElement.id)}},t),r.a.createElement("button",{name:"cancel",className:[he.a.cancel,Se.a.cancel].join(" "),onClick:e.clearClash},r.a.createElement($.c,null)))}function Ce(e){var t=Object(a.createRef)(),n=Object(a.useState)(!1),i=Object(U.a)(n,2),o=i[0],s=i[1];Object(a.useEffect)((function(){o&&t.current&&t.current.focus()}),[t,o]);var l=Object(a.useCallback)((function(t){var n=t.target,a=n.value;if(a.trim()){var r=a.length,i=e.players.filter((function(t){return t.id!==e.player.id&&e.getDisplayName(t.id).toLowerCase().startsWith(a.toLowerCase())}))[0];if(i){var o=e.getDisplayName(i.id);n.value=o,n.select(),n.setSelectionRange(r,o.length,"forward")}}}),[e.players]);return r.a.createElement("div",{className:Se.a.scoreSection},r.a.createElement("form",{target:"_self",onSubmit:function(t){return e.onSubmit(t).then((function(){return s(!0)}))},method:"POST",action:e.action},r.a.createElement("input",{type:"text",className:[he.a.input,Se.a.input].join(" "),name:"oppName",required:!0,placeholder:"Opponent name",onInput:l,autoComplete:"off"}),r.a.createElement("button",{tabIndex:-1,className:he.a.submit},r.a.createElement($.b,null))))}function De(e){var t=Object(a.useState)(""),n=Object(U.a)(t,2),i=n[0],o=n[1],c=Object(a.useState)(null),u=Object(U.a)(c,2),m=u[0],d=u[1],f=Object(a.useMemo)((function(){return"individual"===e.settings.competitors}),[e.settings.competitors]),b=Object(a.useCallback)((function(e){return e?f?[e.firstName,e.lastName].join(" "):e.firstName:"\u200b"}),[f]);Object(a.useEffect)((function(){!function(t){if(o(i),e.playerID)return!1!==t?C({url:"/tournament/"+e.id+"/fetchPlayer",params:{id:e.playerID}}).then((function(e){e.histories[0]||(e.histories[0]=null),d(e)})):void d(e.playerDict.get(e.playerID));d(null)}()}),[e.playerID,e.playerDictKey]);var g=Object(a.useCallback)((function(t){if(!t)return"\u200b";if("bye"===t)return"BYE";var n=e.playerDict.get(t);return n?f?[n.firstName,n.lastName].join(" "):n.firstName:t}),[e.playerDict,f]),v=Object(a.useCallback)((function(t,n){var a=Object(U.a)(t,2),i=a[0],o=a[1];return"Playing"===i&&o?r.a.createElement("div",{className:Se.a.row,key:["row",n].join(".")},r.a.createElement("div",{className:"fieldBox"},i+":"),r.a.createElement("div",{className:"playerInfo",id:o,onClick:function(t){return e.setDisplayPlayer(t.target.id)}},g(o))):r.a.createElement("div",{className:Se.a.row,key:["row",n].join(".")},r.a.createElement("div",{className:"fieldBox"},i+":"),r.a.createElement("div",{className:"fieldBox"},null!==o&&""!==o?o:"\u200b"))}),[e.setDisplayPlayer,g]),y=Object(a.useState)([]),h=Object(U.a)(y,2),_=h[0],E=h[1],j=Object(a.useCallback)(Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(m&&m.id){t.next=2;break}return t.abrupt("return");case 2:C({url:"/tournament/"+e.id+"/fetchClashes",params:{id:m.id}}).then(E);case 3:case"end":return t.stop()}}),t)}))),[e.id,E,m]),O=Object(a.useCallback)(function(){var t=Object(l.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",D({url:"/tournament/"+e.id+"/clearClash",data:{playerId:m.id,oppId:n}}).then(j));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.id,m,j]),w=Object(a.useMemo)((function(){if(!e.playerDict.size)return null;for(var t=[],n=function(n){var a=e.playerDict.get(_[n][1]);if(!a)return"continue";t.push(r.a.createElement(xe,{key:["clash",n].join("."),player:a,requireLastName:f,clearClash:function(){return O(a.id)},setDisplayPlayer:e.setDisplayPlayer}))},a=0;a<_.length;a++)n(a);return t}),[e.playerDict,e.playerDictKey,_,O,e.setDisplayPlayer,f]);Object(a.useEffect)((function(){j()}),[j]);var N=Object(a.useMemo)((function(){return Array.from(e.playerDict.values())}),[e.playerDict,e.playerDictKey]);if(!m)return null;var k=b(m),x=m?{"Unique ID":m.id,Status:!1!==m.active?"Active":"Inactive",Rating:m.rating,"Performance rating":m.performanceRating,Playing:m.isPlaying}:{},P=m.histories,I=(Math.max(m.histories.length,1)-1-(m.isPlaying?1:0)).toString(),B=m.histories.reduce((function(e,t){return t?e+=t.played:e}),0),R=m?{Score:m.score.toString()+" / "+I,"Game score":m.gamePoints.toString()+" / "+B.toString(),"Expected score":m.expectedScore.toFixed(2),"Expected game score":m.expectedGameScore.toFixed(2)+" / "+B}:{};return e.settings.displayPoints||(delete R["Game score"],delete R["Expected game score"]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Se.a.profile},r.a.createElement("div",{className:"topBanner"},k),Object.entries(x).map(v),r.a.createElement(je,{header:"Score",useInternalState:!0,style:{gridColumn:"1 / span 2"}},Object.entries(R).map(v)),e.settings.allowClashes?r.a.createElement(je,{header:"Forbidden Pairings",useInternalState:!0,style:{gridColumn:"1 / span 2"}},w,r.a.createElement(Ce,{id:e.id,getDisplayName:g,onSubmit:function(e){e.preventDefault(),e.persist();var t=e.target,n=N.find((function(e){return g(e.id)===t.oppName.value}));return D({data:{playerId:m.id,oppId:n.id},url:t.action}).then((function(){e.target.reset()})).then(j)},player:m,players:N,action:p.a.resolve(S,["tournament",e.id,"createClash"].join("/"))})):null,r.a.createElement(je,{header:"Results",useInternalState:!0,style:{gridColumn:"1 / span 2"}},P.map((function(t,n){if(0===n||!t)return null;var a=t.id,i=t.colour,o=t[e.settings.displayPoints];return r.a.createElement("div",{className:Se.a.resultsRow,key:["row","history",n].join(".")},r.a.createElement("div",{className:"fieldBox"},n),r.a.createElement("div",{className:"playerInfo",id:a,onClick:function(t){return e.setDisplayPlayer(t.target.id)}},g(a)),r.a.createElement("div",{className:"fieldBox"},i||"\u200b"),r.a.createElement("div",{className:"fieldBox"},"undefined"!==typeof o&&null!==o?o:"\u200b"))}))),r.a.createElement(Ee,null)),r.a.createElement("div",{className:["bottomBanner",Se.a.bottomBanner].join(" ")},_e([function(){return e.setDisplayPlayer("")},r.a.createElement(V.g,null),"close"])))}function Pe(e){return e?e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase():e}function Ie(e,t){var n=Object(a.useState)(e),r=Object(U.a)(n,2),i=r[0],o=r[1];return Object(a.useDebugValue)("".concat(t,": ").concat(i)),[i,o]}var Be={general:{tournamentId:{name:"Unique ID",type:"string",locked:!0,primaryKey:!0},status:{name:"Status",enum:["uninitialised","active","finished"],convert:Pe,defaultValue:"uninitialised",value:function(e){return e.round?!1===e.active?"finished":"active":"uninitialised"}},pairingSystem:{name:"Pairing system",enum:["swiss"],convert:Pe,lockOnInit:!0,defaultValue:"swiss"},competitors:{name:"Tournament type",enum:["individual","team"],convert:Pe,lockOnInit:!0,defaultValue:"individual"},totalRounds:{name:"Total rounds",convert:function(e){return"Infinity"===e?"\u221e":e.toString()},type:"number",defaultValue:1/0,nb:{min:1,max:100},allow:{infinity:!0}},ratingSystem:{name:"Rating system",enum:["ECF","FIDE","USCF"],lockOnInit:!0,defaultValue:"FIDE"},displayPoints:{name:"Show",convert:function(e){return Pe(e)+" Points"},enum:["match","game"],defaultValue:"match"},gamePointTotal:{name:"Sum results to",type:"number",defaultValue:1,show:{displayPoints:"game"},lockOnInit:!0,nb:{step:1,min:1},allow:{any:!0}}},permissions:{public:{name:"Public",convert:function(e){return Pe(e.toString())},lockOnInit:!1,type:"boolean",defaultValue:!1},url:{name:"URL",type:"link",defaultValue:"",show:{public:!0},value:function(e){return"".concat(x,"tournament/").concat(e.id)}},allowNewPlayers:{name:"Mid-way joining?",convert:function(e){return Pe(e.toString())},lockOnInit:!1,type:"boolean",defaultValue:!0},allowSelfSubmissions:{name:"User submissions?",convert:function(e){return Pe(e.toString())},lockOnInit:!1,type:"boolean",defaultValue:!0},allowClashes:{name:"Forbid certain pairings?",convert:function(e){return Pe(e.toString())},lockOnInit:!1,type:"boolean",defaultValue:!0},roundTimes:{name:"Round times?",convert:function(e){return Pe(e.toString())},type:"boolean",defaultValue:!1,locked:!1}},stats:{nbPlayers:{name:"Number of players",type:"number",defaultValue:0,value:function(e,t){return t.length},convert:function(e){return e.toString()}},activePlayers:{name:"Active players",type:"number",defaultValue:0,value:function(e,t){return t.filter((function(e){return e.active})).length},convert:function(e){return e.toString()}},matchesPlayed:{name:"Matches played",type:"number",defaultValue:0,value:function(e,t){return t.reduce((function(e,t){return e+t.played}),0)/2},convert:function(e){return e.toString()}},gamesPlayed:{name:"Games played",type:"number",defaultValue:0,value:function(e,t){return t.reduce((function(e,t){return e+t.histories.reduce((function(e,t){return t?e+=t.played:e}),0)}),0)/2},convert:function(e){return e.toString()}},averageRating:{name:"Average rating",type:"number",defaultValue:1200,value:function(e,t){var n=t.reduce((function(e,t){return e+t.rating}),0);return Math.round(n/t.length)},convert:function(e){return e.toString()}},createdAt:{name:"Created at",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0},updatedAt:{name:"Last updated",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0}},points:{lossReward:{name:"Points on loss",lockOnInit:!0,type:"number",defaultValue:0,nb:{step:.1}},drawReward:{name:"Points on draw",lockOnInit:!0,type:"number",defaultValue:.5,nb:{step:.1}},winReward:{name:"Points on win",lockOnInit:!0,type:"number",defaultValue:1,nb:{step:.1}},byeReward:{name:"Bye reward",enum:["win","draw","loss"],lockOnInit:!0,defaultValue:"win"},performanceSystem:{name:"Performance rating",enum:["ELO","FIDE"],lockOnInit:!1,defaultValue:"ELO"}}},Re={username:{name:"Username",type:"string",locked:!0,primaryKey:!0},location:{name:"Location",type:"string",locked:!0,defaultValue:"Oxford, UK"},language:{name:"Language",type:"string",defaultValue:"English (UK)",locked:!0},licensed:{name:"License",type:"number",defaultValue:0,locked:!0,convert:function(e){return 1===e?"Trial":2===e?"Full":3===e?"Admin":"Free"}},createdAt:{name:"Account created",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0,defaultValue:Date.now()},updatedAt:{name:"Last active",convert:function(e){return new Date(e).toString().slice(0,24)},locked:!0,defaultValue:Date.now()}},Te=Object.values(Be).reduce((function(e,t){for(var n=0,a=Object.values(t);n<a.length;n++){var r=a[n];r.show&&e.push.apply(e,Object(be.a)(Object.keys(r.show)))}return e}),[]);function Le(e){var t=Object(a.useState)("general"),n=Object(U.a)(t,2),i=n[0],o=n[1],s=Object(a.useCallback)((function(t,n,a){try{var r;if(a.enum){var i=a.enum.indexOf(n);-1===i&&console.error("Invalid setting value "+t+": "+n);var o=(i+1)%a.enum.length;r=a.enum[o]}else if("boolean"===a.type)r=!n;else if("number"===a.type){if("Infinity"===n||"\u221e"===n?r=1/0:n=Number(n),"totalRounds"===t){if(n<=e.status.round)throw new Error("Can't make total number of rounds less than current round number");if(n!==1/0&&n>=100)throw new Error("Can't make total number of rounds more than 100")}return n}e.updateSetting(t,r)}catch(s){s&&s.message&&e.triggerError(s.message)}}),[e.status.round,e.updateSetting,e.triggerError]),l=Object(a.useCallback)((function(t){return D({url:"/tournament/"+e.status.id+"/clearRound",data:{round:t}})}),[e.status.id]),c=Object(a.useMemo)((function(){return Object.entries(e.settings).filter((function(e){var t=Object(U.a)(e,1)[0];return Te.includes(t)}))}),[e.settings]);Object(a.useEffect)((function(){!function(){for(var e=0,t=Array.from(document.querySelectorAll("."+[Se.a.sectionListWrapper].join(".")));e<t.length;e++){var n=t[e],a=n.firstElementChild;n.style.height=n.className.includes(Se.a.expanded)?a.getBoundingClientRect().height+"px":"0px"}}()}),[JSON.stringify(c)]);for(var u=Object(a.useCallback)((function(t){return r.a.createElement("div",{className:[Se.a.row,Se.a.roundRow].join(" "),key:["row",t].join(".")},r.a.createElement("div",{className:"fieldBox"},"Round ".concat(t,":")),r.a.createElement(ee,{handleSubmit:e.updateSetting,handleClear:function(){return l(t)},content:e.rounds[t]?e.rounds[t].toString():"",defaultEditContent:new Date(Date.now()).toISOString(),url:p.a.resolve(S,["tournament",e.status.id,"updateRound"].join("/")),inputType:"datetime-local",onSubmitSuccess:function(t){return e.updateRounds(),t},additionalStyles:{editableField:Se.a.editableField,input:Se.a.input},additionalInputProps:{},name:t.toString(),show:{submit:!0,increment:!1,clear:!0}}))}),[e.updateSetting,e.rounds,e.status.id,e.updateRounds]),m=Object(a.useCallback)((function(t,n){var a,i=Object(U.a)(t,2),o=i[0],l=i[1],c=!1;if(l.show)for(var u=0,m=Object.entries(l.show);u<m.length;u++){var d=Object(U.a)(m[u],2),f=d[0],g=d[1];e.settings[f]!==g&&(c=!0)}if(c)return null;var v=!1;(l.locked||l.lockOnInit&&e.status.round)&&(v=!0);var y=null!==(a=e.settings[o])&&void 0!==a?a:l.defaultValue,h=l.convert&&!l.value?l.convert(y):y,_="undefined"!==typeof h?h.toString():"\u200b";return r.a.createElement("div",{className:Se.a.row,key:["row",n].join(".")},r.a.createElement("div",{className:["fieldBox",l.show?Se.a.semiPresent:""].join(" ")},l.name,l.name.endsWith("?")?"":":"),v||l.value?(l.value&&(_=l.value(e.status,e.players)),l.convert&&(_=l.convert(_)),r.a.createElement("div",{style:{cursor:"link"===l.type?"copy":"default"},className:["fieldBox",Se.a.locked].join(" "),onClick:"link"!==l.type?null:function(){return navigator.clipboard.writeText(_)}},_)):"number"===l.type?r.a.createElement(ee,{handleSubmit:e.updateSetting,content:_,url:p.a.resolve(S,["tournament",e.status.id,"updateSetting"].join("/")),inputType:"number",onSubmitSuccess:function(t){return e.updateTournamentSettings(),t},additionalStyles:{editableField:Se.a.editableField,input:Se.a.input},name:o,additionalInputProps:l.nb,show:Object(b.a)({submit:!0,increment:!0},l.allow)}):r.a.createElement("div",{className:["fieldBox",Se.a.editable].join(" "),onClick:function(){return s(o,y,l)}},_))}),[e.settings,e.status,e.players,e.updateSetting,e.status.id,e.updateTournamentSettings]),d=[],f=e.settings.totalRounds===1/0||"Infinity"===e.settings.totalRounds?Math.max(e.rounds.length,1):e.settings.totalRounds,g=1;g<=f;g++)d.push(g);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Se.a.profile},r.a.createElement("div",{className:"topBanner"},"Settings"),Object.entries(Be).map((function(e){var t=Object(U.a)(e,2),n=t[0],a=t[1];return r.a.createElement(je,{key:n,value:n,header:Pe(n),expanded:i===n,setExpanded:function(e,t){return o(e?t:"")}},Object.entries(a).map(m))})),e.settings.roundTimes?r.a.createElement(je,{key:"rounds",value:"rounds",header:"Rounds",expanded:"rounds"===i,setExpanded:function(e,t){return o(e?t:"")}},d.map(u)):null,r.a.createElement(Ee,null)),r.a.createElement("div",{className:["bottomBanner",Se.a.bottomBanner].join(" ")},_e([e.toggleSettings,r.a.createElement(V.g,null),"close"])))}var Fe=n(14),Me=n.n(Fe),Ve=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={sortValue:"score",byRounds:!0},e.handleHeaderClick=function(t){t.startsWith("score.")||"expectedScore"!==t&&("prettyScore"===t&&(t="score"),e.setState({sortValue:t}))},e.calcLength=9,e}return Object(u.a)(n,[{key:"header",value:function(){for(var e=[],t=1;t<=this.totalRounds;t++)e.push(t.toString());return Object(b.a)({id:"",name:"Name",rating:"Rating"},Object.entries(e).reduce((function(e,t){var n=Object(U.a)(t,2),a=n[0],r=n[1];return e["score."+a]=r,e}),{}),{prettyScore:"Score",winPercentage:"Win %",gamePoints:"GP",performanceRating:"Perf",ratingDifference:"P. +/-",expectedScore:"Expected",expectedDifference:"E. +/-"})}},{key:"classNames",value:function(){for(var e=[],t=1;t<=this.totalRounds;t++)e.push(Me.a.resultsCell);return["",""].concat(e,["","","","","","",""])}},{key:"bodyByRounds",value:function(e){var t=this;return this.props.players.map((function(e){for(var n=[],a=1;a<=t.totalRounds;a++){var r=e.histories[a];a&&(r?"number"!==typeof r.match?n.push("*"):.5===r.match?n.push("\xbd"):void 0===r.oppRating?n.push(r.match.toString()+"b"):n.push(r.match.toString()):n.push(""))}var i=e.performanceRating-e.rating,o=e.score-e.expectedScore;return Object(b.a)({id:e.id,name:"individual"===t.props.settings.competitors?[e.firstName,e.lastName].join(" "):e.firstName,rating:e.rating},Object.entries(n).reduce((function(e,t){var n=Object(U.a)(t,2),a=n[0],r=n[1];return e["score."+a]=r,e}),{}),{score:e.score,prettyScore:parseFloat(e.score.toString()).toFixed(1)+" / "+e.played,winPercentage:0===e.played?"-":(100*e.score/e.played).toFixed(2),gamePoints:(e.gamePoints&&e.gamePoints.toFixed?e.gamePoints.toFixed(1):"0.0")+" / "+e.played,performanceRating:e.performanceRating?e.performanceRating.toFixed():"",ratingDifference:e.performanceRating?i>0?"+"+i.toString():i.toString():"",expectedScore:e.expectedScore.toFixed(2)+" / "+e.played,expectedDifference:o>0?"+"+o.toFixed(2):o.toFixed(2)})})).sort((function(t,n){return e.sortValue in t?("name"!==e.sortValue?(a=Number(t[e.sortValue]),r=Number(n[e.sortValue])):(a=t[e.sortValue],r=n[e.sortValue]),a!==r?r-a:n.rating-t.rating):0;var a,r})).map((function(e,n){var a=[["Ranking",n.toString()]].concat(Object(be.a)(Object.entries(e)));return a.filter((function(e){var t=Object(U.a)(e,1)[0];return"id"!==t&&"score"!==t})).map((function(n,i){var o=Object(U.a)(n,2),s=(o[0],o[1]),l=1===i,c=i>2&&i<a.length-t.calcLength;return r.a.createElement("div",{id:l?e.id:[s,i].join("."),key:[s,i].join("."),className:[Me.a.cell,c?Me.a.resultsCell:"",l?Me.a.playerBox:"",0===i?Me.a.firstColumn:""].join(" "),onClick:l?function(e){return t.props.setDisplayPlayer(e.target.id)}:function(){}},s||"\u200b")}))}))}},{key:"render",value:function(){var e=this.state.byRounds?this.bodyByRounds(this.state):this.bodyByRobin,t="Tournament '".concat(this.props.status.name||this.props.status.id,"' results after ").concat(this.props.status.round," rounds");return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Me.a.titles},r.a.createElement("div",null,t),r.a.createElement("div",null,""),r.a.createElement("div",{className:["button",Me.a.closeButton].join(" "),onClick:this.props.show},r.a.createElement(ce.a,null))),r.a.createElement(te,{header:this.header(),body:e,styles:Me.a,bodyClassNames:this.classNames(),style:{gridColumn:"1 / span 2"},handleHeaderClick:this.handleHeaderClick}))}},{key:"bodyByRobin",get:function(){return[[]]}},{key:"totalRounds",get:function(){return this.props.status.round>this.props.settings.totalRounds||"Infinity"===this.props.settings.totalRounds?this.props.status.round:this.props.settings.totalRounds}}]),n}(r.a.Component);function He(e){var t=Object(a.useCallback)((function(t){t.preventDefault();var n=t.target.textArea.value;if(n.trim()&&(n.split("\n").length||!n.split(",").length||!n.split("\t").length)){var a=ve.a.parse(n,{delimitersToGuess:[",","\t"],dynamicTyping:!0,fastMode:!0});if(a.data.length>150)return console.error("Can't paste more than 150 players at once!");var r=a.data.map((function(e){var t=Object(U.a)(e,2),a=t[0],r=t[1];try{if("string"!==typeof a)throw[a,"string"].join(",");if("number"!==typeof r)throw[r,"number"].join(",");return{firstName:a,rating:r}}catch(o){if(!n.split("\n").length)return null;var i=o.split(",");return console.error(new TypeError("Bad input on row "+e.join(",")+"\n"+i[0]+" is not type "+i[1])),null}})).filter((function(e){return e}));D({url:"tournament/"+e.id+"/appendPlayers",data:r})}}),[e.id,!1,e.updatePlayerDict]),n="CSV player data entry for tournament '".concat(e.status.name||e.status.id,"'");return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Me.a.titles},r.a.createElement("div",null,n),r.a.createElement("div",{className:["button",Me.a.closeButton].join(" "),onClick:e.closePasteInput},r.a.createElement(ce.a,null))),r.a.createElement("div",{className:Me.a.subheader},"Please paste your input in csv (comma-separated values) format"),r.a.createElement("div",{className:Me.a.container},r.a.createElement("form",{className:Me.a.form,target:"_self",onSubmit:t,method:"POST"},r.a.createElement("textarea",{className:Me.a.textarea,name:"textArea"}),r.a.createElement("button",{type:"submit",className:Me.a.submit},"SUBMIT"))))}var qe=[30.8,38.4,30.8];function Ue(e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),t.eventName=e,document.dispatchEvent(t)}function ze(e){var t=Object(a.useState)(qe),n=Object(U.a)(t,2),i=n[0],o=n[1],c=Object(a.useState)(0),u=Object(U.a)(c,2),m=u[0],d=u[1],f=Object(a.useMemo)((function(){return i.reduce((function(e,t){var n;return e.push((null!==(n=e[e.length-1])&&void 0!==n?n:0)+t),e}),[]).slice(0,-1)}),[i]),p=Object(a.useState)(""),g=Object(U.a)(p,2),v=g[0],y=g[1],h=Object(a.useState)(!1),_=Object(U.a)(h,2),E=_[0],j=_[1],O=Object(a.useState)(!1),w=Object(U.a)(O,2),N=w[0],k=w[1],S=Object(a.useState)(void 0),x=Object(U.a)(S,2),P=x[0],I=x[1],B=Object(a.useState)(!1),R=Object(U.a)(B,2),T=R[0],L=R[1],F=function(){return j(!E)},M=Object(a.useCallback)((function(e,t){var n=t.set;if(0===i[0]){var a=i.slice(0);return a[0]=qe[0],a[1]<qe[0]?a=qe:a[1]=a[1]-qe[0],o(a),!0}return"boolean"===typeof n?n:!e}),[i,o]),V=Object(a.useCallback)((function(e,t){var n=t.set;if(!1!==n&&100===f[f.length-1]){var a=i.slice(0);return a[a.length-1]=qe[a.length-1],a[a.length-2]<qe[a.length-2]?a=qe:a[a.length-2]=a[a.length-2]-qe[a.length-1],o(a),!0}return e||y(""),"boolean"===typeof n?n:!e}),[i,y,f]),H=Object(a.useReducer)(M,!0),q=Object(U.a)(H,2),z=q[0],A=q[1],K=Object(a.useReducer)(V,!0),W=Object(U.a)(K,2),X=W[0],Q=W[1],Z=Object(a.useCallback)((function(e){if(0===i[0]){var t=i.slice(0);t[0]=qe[0],t[1]<qe[0]?t=qe:t[1]=t[1]-qe[0],o(t)}else e&&X&&Q({set:!1});y(e)}),[o,y,Q,i,X]),$=Object(a.useState)(Math.random().toString(16).slice(2,9)),ee=Object(U.a)($,2),te=ee[0],ne=ee[1],ae=Object(a.useState)({}),re=Object(U.a)(ae,2),ie=re[0],oe=re[1],se=Object(a.useState)({}),le=Object(U.a)(se,2),ce=le[0],me=le[1],de=Object(a.useState)([]),fe=Object(U.a)(de,2),be=fe[0],ge=fe[1],ve=Object(a.useState)([]),ye=Object(U.a)(ve,2),he=ye[0],_e=ye[1];!function(e){var t=e.columns,n=e.boundaries,r=e.resize,i=e.setColumns,o=e.setResize,s=e.toggleSidebar,l=e.toggleSettings,c=e.setDisplayPlayerRaw,u=Object(a.useState)(0),m=Object(U.a)(u,2),d=m[0],f=m[1],p=Object(a.useCallback)((function(e){var a=e.x/window.innerWidth*100;if(d){var r=t.slice(0,d-1).reduce((function(e,t){return e+t}),0),u=r+t[d-1]+t[d],m=a-r,f=u-a;m<2?(f+=m,m=0,1===d&&s({set:!1}),Ue("mouseup")):f<2&&(m+=f,f=0,d===t.length-1&&(c(""),l({set:!1}),Ue("mouseup"))),t[d-1]=m,t[d]=f,i(t.slice(0))}else{var p=n.findIndex((function(e){return Math.abs(e-a)<1}));(0===p&&0===n[0]||p===n.length-1&&100===n[n.length-1])&&(p=-1),o(p+1)}}),[d,t,c,l,o,i,n,s]);Object(a.useEffect)((function(){return document.addEventListener("mousemove",p),function(){return document.removeEventListener("mousemove",p)}}),[d,p]),Object(a.useEffect)((function(){if(r){var e=function(){return f(r)};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[r,f]),Object(a.useEffect)((function(){var e=function(){return f(0)};return document.addEventListener("mouseup",e),function(){return document.removeEventListener("mouseup",e)}}),[r,f])}({columns:i,boundaries:f,resize:m,setColumns:o,setResize:d,toggleSidebar:A,toggleSettings:Q,setDisplayPlayerRaw:y});var Ee=Object(a.useState)(!1),je=Object(U.a)(Ee,2),Oe=je[0],we=je[1],ke=Object(a.useState)(Date.now()),Se=Object(U.a)(ke,2),xe=Se[0],Ce=Se[1],Pe=Object(a.useCallback)((function(e,t){if(t.id)return e.delete(t.id),t.id===v&&Z(""),e;var n;n=t.players?t.players:[t.player];var a,r=Object(Y.a)(n);try{for(r.s();!(a=r.n()).done;){var i=a.value;e.set(i.id,i)}}catch(o){r.e(o)}finally{r.f()}return ne(t.hash||Math.random().toString(16).slice(2,9)),e}),[Z,ne,v,xe]),Ie=Object(a.useReducer)(Pe,new Map),Be=Object(U.a)(Ie,2),Re=Be[0],Te=Be[1],Fe=Object(a.useCallback)((function(t){return!t&&Date.now()-xe<3e3?(Ce(Date.now()),we(!0),Promise.resolve()):C({url:"/tournament/"+e.id+"/fetchPlayers"}).then((function(e){Ce(Date.now()),we(!1),_e(e),Te({players:e})}))}),[e.id,_e,ne,Te,xe]);Object(a.useEffect)((function(){if(Oe){var e=setTimeout(Fe,5e3);return function(){return clearTimeout(e)}}}),[Oe,Fe]);var Me=Object(a.useCallback)((function(){return C({url:"/tournament/"+e.id+"/getStatus"}).then(oe)}),[e.id,oe]),ze=Object(a.useCallback)((function(){return C({url:"/tournament/"+e.id+"/getSettings"}).then(me)}),[e.id,me]),Ae=Object(a.useCallback)((function(t,n){return D({url:"tournament/"+e.id+"/updateSetting",data:Object(G.a)({},t,n)}).then(ze)}),[e.id,ze]),Ke=Object(a.useCallback)((function(){return C({url:"/tournament/"+e.id+"/fetchRounds"}).then(ge)}),[e.id,ge]),We=Object(a.useCallback)(Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:L(he.filter((function(e){return!1!==e.active})).length>=2);case 1:case"end":return e.stop()}}),e)}))),[he,L,Fe]);if(Object(a.useEffect)((function(){if(!e.id)return null;Ke(),Me(),ze(),Fe(!0)}),[e.id,Ke,Me,ze]),!e.id)return null;if(E)return r.a.createElement("div",{className:J.a.tournament},r.a.createElement(Ve,{show:F,setDisplayPlayer:Z,status:ie,players:he,settings:ce}),r.a.createElement(De,{id:e.id,playerID:v,setDisplayPlayer:Z,playerDict:Re,modifyPlayerDict:function(e,t){return Te({player:e,hash:t})},settings:ce}));if(N)return r.a.createElement("div",{className:J.a.tournament},r.a.createElement(He,{closePasteInput:function(){return k(!1)},status:ie,settings:ce,id:e.id,updatePlayerDict:Fe}));var Ge={};return m&&(Ge.cursor="ew-resize"),r.a.createElement("div",{className:J.a.tournament,style:Object(b.a)({gridTemplateColumns:i.join("% ")+"%"},Ge)},z?r.a.createElement(Ne,{playerDict:Re,playerDictKey:te,updatePlayerDict:Fe,setPlayerDict:Te,settings:ce,id:e.id,setDisplayPlayer:Z,checkIfEnoughPlayers:We,togglePasteInput:function(){return k(!0)}}):null,r.a.createElement(ue,{status:ie,settings:ce,updateTournamentStatus:Me,round:ie.round,totalRounds:ce.totalRounds,closeTournament:e.closeTournament,toggleCrossTable:F,setLastRound:I,lastRoundOverride:P,triggerError:e.triggerError}),r.a.createElement(pe,{status:ie,playerDict:Re,updatePlayerDict:Fe,settings:ce,id:e.id,canTriggerNextRound:T,toggleSidebar:function(){return A({})},toggleSettings:function(){return Q({})},setDisplayPlayer:Z,updateRound:Me,setLastRound:I,lastRoundOverride:P,toggleCrossTable:F,playerDictKey:te}),r.a.createElement(De,{id:e.id,playerID:v,setDisplayPlayer:Z,playerDict:Re,modifyPlayerDict:function(e,t){return Te({player:e,hash:t})},settings:ce,playerDictKey:te}),X?r.a.createElement(Le,{updateTournamentSettings:ze,updateSetting:Ae,status:ie,settings:ce,toggleSettings:function(){return Q({})},setLastRound:I,triggerError:e.triggerError,players:he,updateRounds:Ke,rounds:be}):null)}var Ae=n(9),Ke=n.n(Ae);function We(e){return r.a.createElement("span",{id:e.id,className:e.className,style:Object(b.a)({height:e.radius,width:e.radius,lineHeight:e.radius,borderRadius:"50%",display:"inline-block",cursor:"default"},e.style),onClick:e.onClick,onMouseEnter:e.onMouseEnter},e.content)}function Ge(e){var t=e.getBoundingClientRect();return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2-30}}function Ye(e,t,n,a){var i,o,s=Math.abs(n.x-t.x),l=Math.abs(n.y-t.y),c=(i=n.x-t.x,o=n.y-t.y,Math.sqrt(Math.pow(i,2)+Math.pow(o,2))),u=Math.sign((n.x-t.x)*(n.y-t.y)),m=180*Math.atan(l/s)/Math.PI;return r.a.createElement("div",{key:["line",n.x,n.y].join("."),className:Ke.a.line,style:{width:c+"px",height:a+"px",backgroundColor:"white",position:"absolute",left:e?(t.x+n.x)/2-s/2:t.x-s/2,top:e?(t.y+n.y)/2:t.y,transform:"rotate(".concat(m*u,"deg) scaleX(").concat(e?1:0,") scaleY(1)"),opacity:e?1:0,transition:"transform 3s, left 3s, top 3s, opacity 3s"}})}function Xe(e){var t=Ie({},"tournamentDict"),n=Object(U.a)(t,2),i=n[0],o=n[1],c=Ie(!0,"loading"),u=Object(U.a)(c,2),m=u[0],d=u[1],f=Ie(!1,"loadingOverride"),p=Object(U.a)(f,2),b=p[0],g=p[1],v=Ie(!1,"linesMounted"),y=Object(U.a)(v,2),h=y[0],_=y[1],E=Ie(!1,"adjustedLines"),j=Object(U.a)(E,2),O=j[0],w=j[1],N=Ie("","selected"),S=Object(U.a)(N,2),x=S[0],P=S[1],I=Object(a.useCallback)((function(){return C({url:"/tournaments"}).then((function(e){return o(e),e})).catch((function(t){return console.error(t),e.endSession(),{}}))}),[o,e.endSession]),B=Object(a.useCallback)((function(e){return e?Object.values(i).length?e in i?Promise.resolve():Promise.reject():I().then((function(t){if(void 0===t[e])throw new Error})):Promise.reject()}),[i,I]),R=Object(a.useCallback)((function(t){return B(t).then((function(){k.set("tournamentID",t,{path:"/"}).catch(console.error),e.setTournamentID(t)})).catch((function(){k.remove("tournamentID").catch(console.error),e.setTournamentID("")}))}),[B,e.setTournamentID]),T=Object(a.useCallback)(Object(l.a)(s.a.mark((function t(){var n,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D({url:"/initialise"});case 3:if(n=t.sent){t.next=6;break}throw new Error;case 6:return e.setTournamentID(n),t.next=9,I();case 9:t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),(a=t.t0).response&&401!==a.response.status||e.endSession();case 15:case"end":return t.stop()}}),t,null,[[0,11]])}))),[e.setTournamentID,I,e.endSession]),F=Object(a.useCallback)(function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=6;break}return e.next=3,D({url:"/closeAuthorization/all"});case 3:o({}),e.next=11;break;case 6:return delete(n=Object.assign({},i))[t],e.next=10,D({url:"/closeAuthorization/"+t});case 10:o(n);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i,o]),M=Object(a.useState)([]),q=Object(U.a)(M,2),A=q[0],K=q[1],W=Object(a.useRef)(),G=Object(a.useCallback)((function(){if(W.current){for(var e=Ge(W.current),t=[],n=0,a=Array.from(document.getElementsByClassName(Ke.a.dot));n<a.length;n++){var r=a[n];"0"!==r.style.opacity&&t.push(Ye(h,e,Ge(r),2))}K(t)}}),[W,Ye,h]);Object(a.useEffect)((function(){G(),_(!0);var e=setTimeout((function(){return w(!0)}),3e3);return function(){return clearTimeout(e)}}),[G,w,_,x]);var Y=Object(a.useMemo)((function(){return{create:{onClick:T,content:r.a.createElement($.h,null),description:"Create new Swiss tournament"},roundRobin:{onClick:function(){},content:r.a.createElement(z.a,null),description:"Create new Round-Robin tournament"},settings:{onClick:function(){},content:r.a.createElement(V.d,null),description:"User settings"},load:{onClick:I,content:r.a.createElement(fe.a,null),description:"Load previous tournaments"},back:{onClick:e.endSession,content:r.a.createElement(V.e,null),description:"Exit to login"},close:{onClick:function(){return e.triggerConfirm("Delete all saved tournaments?",F,(function(){}))},noSet:!0,content:r.a.createElement(V.g,null),description:"Close all tournaments",style:{border:"8px solid darkred"}},refresh:{onClick:I,noSet:!0,content:r.a.createElement(ce.c,null),description:"Refresh tournament list",style:{border:"8px solid darkblue"}}}}),[T,I,e.endSession,e.triggerConfirm,F,P]),X=Object(a.useCallback)((function(e,t){var n=e.reduce((function(e,t){return t in Y?(e[t]=Y[t],e):e}),{});return Object.entries(n).reduce((function(e,n,a){var i=Object(U.a)(n,2),o=i[0],c=i[1],u=[r.a.createElement("div",{className:[Ke.a.dotDescription,x===o?Ke.a.descriptionSelected:""].join(" "),key:["navData",t,"description",a].join(".")},c.description),r.a.createElement(We,{key:["navData",t,"dot",a].join("."),radius:"50px",className:[Ke.a.dot,O?"":Ke.a.dotUnloaded].join(" "),id:o,content:c.content,onClick:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x!==o){e.next=4;break}P(""),e.next=7;break;case 4:return e.next=6,c.onClick(t);case 6:c.noSet||P(o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),style:c.style})];return"right"===t&&(u=u.reverse()),e.push(r.a.createElement("div",{className:[Ke.a.dotContainer,O?Ke.a.dotContainerLoaded:""].join(" "),key:["NavData",t,"div",a].join("i")},u)),e}),[])}),[Y,O,x,P]),J=Object(a.useCallback)(Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get("tournamentID");case 2:(t=e.sent)&&R(t);case 4:case"end":return e.stop()}}),e)}))),[R]);Object(a.useEffect)((function(){J()}),[J]),Object(a.useEffect)((function(){window.addEventListener("resize",G);var e=setTimeout((function(){return d(!1)}),3e3);return function(){window.removeEventListener("resize",G),clearTimeout(e)}}),[G,d]);var Q=Object(a.useMemo)((function(){switch(x){case"load":return X(["refresh","close","load"],"left");case"settings":default:return X(["create","settings","load"],"left")}}),[x,X]),Z=Object(a.useMemo)((function(){switch(x){case"load":return r.a.createElement(Je,{setTournamentID:R,createNewTournament:T,removeID:F,updateTournamentSettings:I,tournamentDict:i,closeListing:function(){return P("")},triggerConfirm:e.triggerConfirm});case"settings":return r.a.createElement(Qe,{updateTournamentSettings:function(){return Promise.resolve()},updateSetting:function(){return Promise.resolve()},closeListing:function(){return P("")}});default:return X(["back"],"right")}}),[P,x,R,T,F,I,i,e.triggerConfirm,X]);return r.a.createElement("div",{className:L.a.canvas},A,r.a.createElement("div",{className:[L.a.column,Ke.a.leftColumn].join(" ")},Q),r.a.createElement("div",{ref:W,className:[L.a.column,Ke.a.column].join(" ")},r.a.createElement(H,{setLoading:function(e){return g(e)},loading:m||b,classNames:{logo:Ke.a.logo}})),r.a.createElement("div",{className:[L.a.column,Ke.a.rightColumn].join(" ")},Z))}function Je(e){var t=Object(a.useState)(0),n=Object(U.a)(t,2),i=n[0],o=n[1],s=Object(a.useCallback)((function(t){var n=Object.keys(t).reduce((function(t,n){var a=e.tournamentDict[n];return a?(t[a]||(t[a]=0),t[a]++,t):t}),{});return Object.entries(t).map((function(t,a){var i=Object(U.a)(t,2),o=i[0],s=i[1],l=void 0===n[s]?o:1===n[s]?s:s+"\n"+o;return r.a.createElement("div",{className:[Se.a.row,Ke.a.row].join(" "),key:["row",a].join(".")},r.a.createElement("div",{className:[Ke.a.clickButton,"fieldBox"].join(" "),onClick:function(){return e.setTournamentID(o)}},l),r.a.createElement("div",{className:[Ke.a.clickButton,Ke.a.close,"fieldBox"].join(" "),onClick:function(){e.triggerConfirm("Delete tournament '"+l+"'?\nPlease note this action cannot be undone.",(function(){return e.removeID(o)}),(function(){}))}},r.a.createElement(V.c,null)))})).filter((function(e){return e}))}),[e.tournamentDict,e.setTournamentID,e.triggerConfirm,e.removeID]),l=r.a.useRef();return Object(a.useEffect)((function(){var e=setTimeout((function(){l.current&&o(l.current.getBoundingClientRect().height)}),1e3);return function(){return clearTimeout(e)}}),[l,e.tournamentDict,s,o]),r.a.createElement("div",{className:Ke.a.sidebar},r.a.createElement("div",{className:[Se.a.profile,Ke.a.profile].join(" ")},r.a.createElement("div",{className:"topBanner"},"Load Tournament"),r.a.createElement("div",{className:Ke.a.listWrapper,style:{height:i}},r.a.createElement("div",{ref:l,className:Ke.a.listing},s(e.tournamentDict)))),r.a.createElement("div",{className:["bottomBanner",Ke.a.bottomBanner].join(" ")},r.a.createElement("div",{onClick:e.createNewTournament,className:"button"},r.a.createElement(z.b,null)),r.a.createElement("div",{onClick:e.closeListing,className:"button"},r.a.createElement(V.e,null))))}function Qe(e){var t=Ie({},"user"),n=Object(U.a)(t,2),i=n[0],o=n[1],s=Object(a.useCallback)((function(){return C({url:"/profile"}).then(o)}),[o]);Object(a.useEffect)((function(){s()}),[s]);var l=Object(a.useMemo)((function(){return Object.entries(Re).map((function(e,t){var n=Object(U.a)(e,2),a=n[0],o=n[1],s=i[a]||o.defaultValue;"number"===o.type&&(s=Number(s)),o.convert&&(s=o.convert(s));var l="undefined"!==typeof s?s.toString():"\u200b";return console.log(a,s,l),r.a.createElement("div",{className:Se.a.row,key:["row",t].join(".")},r.a.createElement("div",{className:["fieldBox"].join(" ")},o.name+":"),r.a.createElement("div",{style:{cursor:"link"===o.type?"copy":"default"},className:["fieldBox"].join(" "),onClick:"link"!==o.type?null:function(){return navigator.clipboard.writeText(l)}},l))}))}),[i]);return r.a.createElement("div",{className:Ke.a.sidebar},r.a.createElement("div",{className:[Se.a.profile,Ke.a.profile].join(" ")},r.a.createElement("div",{className:"topBanner"},"Settings"),l,r.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",{style:{transform:"rotate(-30deg)"}},"This feature is in beta"))),r.a.createElement("div",{className:["bottomBanner",Ke.a.bottomBanner].join(" ")},r.a.createElement("div",{onClick:e.closeListing,className:"button"},r.a.createElement(V.e,null))))}var Ze=n(26),$e=n.n(Ze);function et(e){var t="string"===typeof e.message?e.message:JSON.stringify(e.message,null,4),n=Object(a.useRef)(null);return Object(a.useEffect)((function(){n.current.focus()}),[n]),r.a.createElement("div",{className:$e.a.alertBox},e.title?r.a.createElement("div",null,e.title):null,r.a.createElement("div",{className:[$e.a.textBox].join(" ")},t),r.a.createElement("div",{className:$e.a.response},e.confirm?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:[$e.a.NO,"button"].join(" "),ref:n,onClick:function(){e.reject(),e.close()}},r.a.createElement(V.g,null)),r.a.createElement("button",{className:[$e.a.YES,"button"].join(" "),onClick:function(){e.resolve(),e.close()}},r.a.createElement(V.f,null))):r.a.createElement("button",{className:[$e.a.NO,"button"].join(" "),onClick:e.close,ref:n},"OK")))}var tt=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={sessionID:"",tournamentID:"",mode:"login",alertBox:{message:"",error:!0,confirm:!1}},e.closeAlertBox=function(){return e.setState({alertBox:{message:""}})},e.triggerConfirm=function(t,n,a){return e.setState({alertBox:{message:t,title:"CONFIRM ACTION",confirm:!0,resolve:n,reject:a}})},e.triggerError=function(t){return e.setState({alertBox:{message:t,title:"ERROR",confirm:!1}})},e.setTournamentID=function(){var t=Object(l.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({tournamentID:n,mode:n?"tournament":"menu"});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.hasLoggedIn=function(){var t=Object(l.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.set("sessionID",n,{path:"/"});case 2:e.setState({sessionID:n,mode:"menu"});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.closeTournament=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.set("tournamentID","",{path:"/"});case 2:e.setState({tournamentID:"",mode:"menu"});case 3:case"end":return t.stop()}}),t)}))),e.endSession=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k.set("sessionID","",{path:"/"});case 3:return t.next=5,D({url:"/endSession"});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:return t.prev=10,e.setState({sessionID:"",mode:"login"}),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])}))),e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I((function(e){return n.triggerError(e)})),e.next=3,k.get("sessionID");case 3:(t=e.sent)&&this.setState({sessionID:t,mode:"menu"});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){I((function(){}))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(W,null),r.a.createElement("div",{className:"stage",style:{backgroundImage:"url(".concat(".","/images/leaves-texture.png)")}},function(){switch(e.state.mode){case"login":return r.a.createElement(q,{login:e.hasLoggedIn});case"menu":return r.a.createElement(Xe,{sessionID:e.state.sessionID,endSession:e.endSession,setTournamentID:e.setTournamentID,triggerConfirm:e.triggerConfirm});case"tournament":return r.a.createElement(ze,{id:e.state.tournamentID,closeTournament:e.closeTournament,triggerError:e.triggerError});default:return console.error("invalid mode"),e.setState({mode:"login"}),null}}(),this.state.alertBox.message&&this.state.alertBox.message.length>10?r.a.createElement(et,Object.assign({},this.state.alertBox,{close:this.closeAlertBox})):null))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(i.render)(r.a.createElement(tt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},9:function(e,t,n){e.exports={leftColumn:"menu_leftColumn__13Ey0",rightColumn:"menu_rightColumn__2D55A",line:"menu_line__2oByf",row:"menu_row__q-PZk",listWrapper:"menu_listWrapper__1_77c",clickButton:"menu_clickButton__1F_HI",dotContainer:"menu_dotContainer__ze3l6",dotDescription:"menu_dotDescription__19QYi",dot:"menu_dot__3Dq9b",dotContainerLoaded:"menu_dotContainerLoaded__3YmWC",descriptionSelected:"menu_descriptionSelected__2aKX-",close:"menu_close__3eKoV",sidebar:"menu_sidebar__l1_lg",profile:"menu_profile__3-O4-",bottomBanner:"menu_bottomBanner__3Od_g","slide-in-from-right":"menu_slide-in-from-right__2syBl",logo:"menu_logo__3MwZ9","float-down":"menu_float-down__1GhiB",dotUnloaded:"menu_dotUnloaded__2DT-h",expand:"menu_expand__1E6M-","briefly-expand":"menu_briefly-expand__ex-pm"}}},[[50,1,2]]]);
//# sourceMappingURL=main.4d0a28c5.chunk.js.map